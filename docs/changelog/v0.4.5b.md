# v0.4.5b Changelog - Streaming Diff Preview

**Released**: 2026-01-16

## Summary

Real-time diff computation during LLM token streaming with debouncing and prioritization.

## Features

### Core Models (`src/AIntern.Core/Models`)
- **`DiffComputationStatus`** - Enum: Pending, Computing, Completed, Failed, Cancelled
- **`DiffComputationState`** - Tracks streaming diff computation state per code block

### Core Events (`src/AIntern.Core/Events`)
- **`DiffComputedEventArgs`** - Event args for diff computation completion (intermediate or final)

### Core Interfaces (`src/AIntern.Core/Interfaces`)
- **`IStreamingDiffCoordinator`** - Contract for streaming diff coordination
  - `OnCodeBlockDetectedAsync` - Initial detection
  - `OnCodeBlockUpdatedAsync` - Content updates (debounced)
  - `FinalizeBlockDiffAsync` - Final computation (bypass debounce)
  - `DiffComputed` event

### Services (`src/AIntern.Services/Streaming`)
- **`DiffComputationQueue`** - Priority queue with 250ms debounce
  - `DiffComputationPriority` enum (Detect, Update, Finalize)
  - `DiffComputationRequest` record
- **`StreamingDiffCoordinator`** - Full implementation with:
  - Content hashing for change detection
  - Concurrent state management
  - Settings-aware (respects `ShowDiffPreviewDuringStreaming`)

### Desktop ViewModels (`src/AIntern.Desktop/ViewModels`)
- **`StreamingDiffViewModel`** - Bindable ViewModel for UI with:
  - `IsComputing`, `IsCompleted`, `IsFailed` states
  - `StatsDisplay` ("+5 -3 ~2")
  - `HasChanges`, `AddedLines`, `RemovedLines`, `ModifiedLines`

## Tests

- 6 new tests for `StreamingDiffCoordinator`
