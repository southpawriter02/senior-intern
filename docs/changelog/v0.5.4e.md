# v0.5.4e - Command Block ViewModel

**Released**: 2026-01-18

---

## Overview

MVVM ViewModel for command blocks with Copy, Send to Terminal, and Execute commands plus dangerous command confirmation workflow.

---

## Added

### ViewModel (`AIntern.Desktop/ViewModels/`)

- **CommandBlockViewModel** - Presentation layer for command blocks
  - Observable properties: Command, Status, IsExecuting, StatusMessage, ShowDangerWarning, DangerConfirmed, IsExpanded
  - Computed properties: CommandText, CommandPreview, Description, LanguageBadge, IsMultiLine, LineCount, AdditionalLinesText, IsDangerous, DangerWarning, ConfidenceText, ShowConfidence, StatusText, ShowStatus, StatusClass, StatusIcon, HasActiveTerminal, CanExecute
  - Commands: CopyAsync, SendToTerminalAsync, ExecuteAsync, ConfirmDanger, CancelDanger, ToggleExpanded
  - Event subscriptions: StatusChanged, SessionStateChanged
  - Dangerous command confirmation workflow with warning overlay
  - Auto-clearing status messages (2 second delay)

- **CommandBlockViewModelFactory** - Factory with DI injection
  - `Create(CommandBlock)` - Single ViewModel creation
  - `CreateRange(IEnumerable<CommandBlock>)` - Batch creation
  - `CreateFromResult(CommandExtractionResult)` - From extraction result
  - `CreateList(IReadOnlyList<CommandBlock>)` - List creation

---

## Modified

| File | Changes |
|------|---------|
| `ServiceCollectionExtensions.cs` | Registered `CommandBlockViewModelFactory` as singleton |

---

## Unit Tests

40 tests in `CommandBlockViewModelTests.cs`:

| Category | Tests |
|----------|-------|
| Command Text Properties | 7 |
| Status Properties | 8 |
| Danger Properties | 1 |
| Terminal State | 2 |
| CanExecute | 3 |
| Copy Command | 2 |
| Danger Flow | 6 |
| Toggle Expanded | 1 |
| Event Subscription | 2 |
| Factory | 2 |
| Theory Tests | 6 |

---

## Files Changed

| File | Status |
|------|--------|
| `AIntern.Desktop/ViewModels/CommandBlockViewModel.cs` | Added |
| `AIntern.Desktop/ViewModels/CommandBlockViewModelFactory.cs` | Added |
| `AIntern.Desktop/Extensions/ServiceCollectionExtensions.cs` | Modified |
| `AIntern.Desktop.Tests/ViewModels/CommandBlockViewModelTests.cs` | Added |

---

## Next Steps

- v0.5.5: Terminal Polish (settings, themes, keyboard shortcuts)
