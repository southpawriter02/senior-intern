# v0.5.4h - Chat Integration

**Released**: 2026-01-18

---

## Overview

Integration of command extraction and terminal context into the chat UI flow with bulk operations and keyboard shortcuts.

---

## Changed

### ChatMessageViewModel (`AIntern.Desktop/ViewModels/`)

Extended with:
- `CommandBlocks` collection (auto-extracted from assistant messages)
- `HasCommands`, `CommandCount`, `DangerousCommandCount` computed properties
- `HasDangerousCommands`, `CommandSummary`, `DangerWarning` display properties
- `ShowCommandActions` for toolbar visibility
- `ExecuteAllCommandsAsync` command (sequential execution, stops on failure)
- `CopyAllCommandsAsync` command (script clipboard)
- `SetCommandBlocks()` for external command injection
- `DisposeCommands()` for cleanup

---

## Added

### Icons (`AIntern.Desktop/Resources/Icons.axaml`)

- `CommandIcon` - For "Last Command" menu item
- `SelectionIcon` - For "Attach Selection" menu item
- `ChevronDownIcon` - For dropdown indicators

---

## Unit Tests

18 tests in `ChatMessageCommandTests.cs`:

| Category | Tests |
|----------|-------|
| HasCommands | 2 |
| CommandCount | 1 |
| DangerousCommandCount | 3 |
| CommandSummary | 3 |
| DangerWarning | 3 |
| ShowCommandActions | 4 |
| SetCommandBlocks | 1 |
| DisposeCommands | 1 |

---

## Files Changed

| File | Status |
|------|--------|
| `ViewModels/ChatMessageViewModel.cs` | Modified (+command blocks) |
| `Resources/Icons.axaml` | Modified (+3 icons) |
| `AIntern.Desktop.Tests/ViewModels/ChatMessageCommandTests.cs` | Added |

---

## Keyboard Shortcuts (Design)

| Shortcut | Action |
|----------|--------|
| `Ctrl+Shift+T` | Attach terminal output |
| `Ctrl+Shift+Enter` | Execute focused command |
| `Ctrl+Shift+C` | Copy focused command |
| `Ctrl+`` ` | Toggle terminal panel |

---

## Next Steps

- v0.5.5: Terminal Polish (settings, themes, keyboard shortcuts)
