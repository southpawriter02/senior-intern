# v0.3.4c: File Context ViewModel

**Released:** 2026-01-15

## Summary

Implemented `FileContextViewModel` - the presentation layer ViewModel for attached
file contexts with observable properties, computed display properties, and factory methods.

## New Files

| File | Description |
|------|-------------|
| `ContextAttachmentType.cs` | Enum: File, Selection, Clipboard |
| `FileContextViewModel.cs` | Full ViewModel implementation |
| `FileContextViewModelTests.cs` | 33 unit tests |

---

## Observable Properties

| Property | Description |
|----------|-------------|
| `Id` | Unique identifier |
| `FilePath`, `FileName` | File location |
| `Language` | Detected language |
| `Content` | Full content |
| `EstimatedTokens`, `LineCount` | Metrics |
| `StartLine`, `EndLine` | Selection range |
| `AttachmentType` | File/Selection/Clipboard |
| `IsExpanded`, `IsHovered` | UI state |

## Computed Properties

| Property | Example |
|----------|---------|
| `DisplayLabel` | "Service.cs" or "Service.cs:10-25" |
| `ShortLabel` | Truncated to 20 chars |
| `PreviewContent` | First 15 lines, 500 chars |
| `Badge` | "C#", "JS", "SEL", "CLIP" |
| `IconKey` | "CSharpIcon", "ClipboardIcon" |
| `Tooltip` | "file.cs • csharp • 50 lines • ~200 tokens" |

---

## Factory Methods

```csharp
// From file
var vm = FileContextViewModel.FromFile("/path/file.cs", content, tokens);

// From selection
var vm = FileContextViewModel.FromSelection("/path/file.cs", content, 10, 25, tokens);

// From clipboard
var vm = FileContextViewModel.FromClipboard(content, "python", tokens);
```

## Conversion

```csharp
// To core model
FileContext context = vm.ToFileContext();

// From core model
var vm = FileContextViewModel.FromFileContext(context);
```

---

## Test Results

- **Tests:** 33 passed
- **Build:** 0 errors (1 pre-existing warning)

## Related Versions

- v0.3.4a: Token Estimation Service
- v0.3.4b: Context Formatter
- v0.3.4d: Context Attachment Panel (next)
