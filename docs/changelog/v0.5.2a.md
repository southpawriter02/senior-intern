# v0.5.2a – Theme & Styles

**Date**: 2026-01-17
**Parent Version**: v0.5.2 Terminal UI
**Focus**: Terminal theme model, color palette, AXAML styles, and terminal icons

## Overview

This release establishes the visual foundation for the terminal UI subsystem by creating the terminal theme model with 256-color palette support, cursor style definitions, terminal-specific AXAML styles, and icon definitions.

## Features

### TerminalTheme Model

A comprehensive theme model supporting the full xterm 256-color palette:

- **ANSI Colors (0-15)**: Customizable 16-color palette stored per theme
- **Color Cube (16-231)**: 6×6×6 calculated color cube (216 colors)
- **Grayscale (232-255)**: 24-step grayscale ramp

Key capabilities:
- `GetPaletteColor(int index)` - Resolve any 256-color palette index
- `ResolveColor(TerminalColor, bool)` - Resolve default/palette/RGB colors
- `GetSemanticColor(TerminalThemeColor)` - Access theme colors by semantic name

### Theme Presets

Three built-in themes:

| Theme | Background | Foreground | Selection |
|-------|------------|------------|-----------|
| Dark | #1E1E1E | #CCCCCC | #4477AA |
| Light | #FFFFFF | #000000 | #ADD6FF |
| Solarized Dark | #002B36 | #839496 | #073642 |

### CursorStyle Enum

Defines cursor appearance options:

- **Block**: Solid block filling the character cell
- **Underline**: Line at the bottom of the cell
- **Bar**: Vertical bar at the left edge

### Terminal UI Styles

Color brushes and control themes for terminal panel:

- `TerminalBackground`, `TerminalForeground` - Core colors
- `TerminalTabBarBackground`, `TerminalTabBorder` - Tab bar styling
- `TerminalScrollBarThumb/Hover` - Scrollbar appearance

Control themes:
- `TerminalTab` - Tab button with hover/active states
- `TerminalTabCloseButton` - Hidden until hover
- `TerminalNewTabButton` - Plus icon button
- `TerminalIconButton` - General icon buttons
- `TerminalScrollBar` - Styled scrollbar

### Terminal Icons

StreamGeometry icons in `IconPaths.axaml`:

- `TerminalIcon` - Command prompt symbol
- `PlusIcon` - New tab action
- `CloseIcon` - Close/dismiss
- `MaximizeIcon`, `MinimizeIcon` - Panel controls
- `ChevronDownIcon`, `ChevronUpIcon` - Dropdowns
- `SplitHorizontalIcon`, `SplitVerticalIcon` - Split actions
- `KillIcon`, `TrashIcon` - Session management

## Files Created

| File | Purpose |
|------|---------|
| `src/AIntern.Core/Models/Terminal/CursorStyle.cs` | Cursor style enum |
| `src/AIntern.Core/Models/Terminal/TerminalThemeColor.cs` | Semantic color enum |
| `src/AIntern.Core/Models/Terminal/TerminalTheme.cs` | Theme model with 256-color palette |
| `src/AIntern.Desktop/Resources/IconPaths.axaml` | Terminal icon definitions |
| `tests/AIntern.Core.Tests/Models/Terminal/TerminalThemeTests.cs` | Unit tests (47) |

## Files Modified

| File | Changes |
|------|---------|
| `src/AIntern.Desktop/Themes/Dark.axaml` | Terminal colors and control themes |
| `src/AIntern.Desktop/App.axaml` | IconPaths include, terminal tab styles |

## Test Coverage

47 new unit tests covering:

- ANSI palette lookup (4 tests)
- Color cube calculation (7 tests)
- Grayscale ramp calculation (5 tests)
- Edge case handling (2 tests)
- Color resolution (4 tests)
- Semantic color lookup (6 tests)
- Theme preset validation (9 tests)
- Default values verification (5 tests)
- Theory-based palette tests (5 theories)

## Usage

### Resolving Terminal Colors

```csharp
var theme = TerminalTheme.Dark;

// Resolve a palette color
var red = theme.GetPaletteColor(1);  // ANSI red

// Resolve cell colors for rendering
var fg = theme.ResolveColor(cell.Foreground, isForeground: true);
var bg = theme.ResolveColor(cell.Background, isForeground: false);
```

### Using Theme Presets

```csharp
// Select a theme
var theme = TerminalTheme.SolarizedDark;

// Access theme properties
var backgroundColor = theme.Background;  // #002B36
var cursorStyle = theme.CursorStyle;     // Block
var blinkInterval = theme.CursorBlinkIntervalMs;  // 530
```

### Using Icons in XAML

```xml
<PathIcon Data="{StaticResource TerminalIcon}" 
          Width="16" Height="16" />

<Button Theme="{StaticResource TerminalTab}">
    <StackPanel Orientation="Horizontal">
        <PathIcon Data="{StaticResource TerminalIcon}" />
        <TextBlock Text="Terminal" />
    </StackPanel>
</Button>
```

## Verification

- **Build**: ✅ Success (0 errors)
- **Tests**: ✅ 3,397 passing (+47 new)
  - AIntern.Core.Tests: 882
  - AIntern.Data.Tests: 172
  - AIntern.Desktop.Tests: 1,508
  - AIntern.Services.Tests: 835

## Next Steps

- **v0.5.2b**: Terminal Renderer - SkiaSharp-based cell rendering using TerminalTheme
- **v0.5.2c**: Terminal Panel - Avalonia UserControl with tab bar and session management
