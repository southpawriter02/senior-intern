# v0.3.3g: Dialogs & Integration

**Released:** 2026-01-14

## Summary

This version implements the dialog service infrastructure including `IDialogService`,
`DialogService`, `GoToLineDialog`, and `MessageDialog`. These provide a unified API
for showing platform dialogs, file pickers, and custom dialogs.

## New Files

| File | Description |
|------|-------------|
| `IDialogService.cs` | Dialog service interface |
| `DialogService.cs` | Avalonia implementation |
| `GoToLineDialog.axaml` | Go-to-line dialog view |
| `GoToLineDialog.axaml.cs` | Go-to-line dialog code-behind |
| `MessageDialog.axaml` | Message dialog view |
| `MessageDialog.axaml.cs` | Message dialog code-behind |
| `DialogServiceTests.cs` | Unit tests for DialogService |
| `MessageDialogIconTests.cs` | Unit tests for icon enum |

## Modified Files

| File | Changes |
|------|---------|
| `Icons.axaml` | Added InfoIcon, WarningIcon, ErrorIcon, QuestionIcon |
| `Dark.axaml` | Added DangerBrush, WarningBrush, SuccessBrush |

---

## IDialogService Interface

```csharp
public interface IDialogService
{
    // Message dialogs
    Task ShowErrorAsync(string title, string message);
    Task ShowInfoAsync(string title, string message);
    Task<string?> ShowConfirmDialogAsync(string title, string message, IEnumerable<string> options);

    // File dialogs
    Task<string?> ShowSaveDialogAsync(string title, string defaultFileName, 
        IReadOnlyList<(string Name, string[] Extensions)> filters);
    Task<string?> ShowOpenFileDialogAsync(string title, 
        IReadOnlyList<(string Name, string[] Extensions)> filters, bool allowMultiple = false);
    Task<string?> ShowFolderPickerAsync(string title);

    // Custom dialogs
    Task<int?> ShowGoToLineDialogAsync(int maxLine, int currentLine);
}
```

## MessageDialogIcon Enum

| Value | Icon | Usage |
|-------|------|-------|
| None | — | No icon |
| Information | ℹ️ | Info messages |
| Warning | ⚠️ | Caution dialogs |
| Error | ❌ | Error alerts |
| Question | ❓ | Confirmation prompts |

---

## GoToLineDialog

Features:
- Validates line number range (1 to MaxLine)
- Pre-fills current line number
- Enter key submits
- Auto-focus and select on open

```csharp
var dialog = new GoToLineDialog
{
    MaxLine = document.LineCount,
    CurrentLine = caret.Line
};
var lineNumber = await dialog.ShowDialog<int?>(parentWindow);
```

## MessageDialog

Features:
- Configurable button labels
- Icon support (via MessageDialogIcon enum)
- Returns clicked button text

```csharp
var dialog = new MessageDialog
{
    Title = "Confirm",
    Message = "Save changes?",
    Icon = MessageDialogIcon.Question,
    Buttons = new[] { "Save", "Don't Save", "Cancel" }
};
var result = await dialog.ShowDialog<string?>(parentWindow);
```

---

## Icons Added

| Icon Key | Description |
|----------|-------------|
| InfoIcon | Circle with "i" |
| WarningIcon | Triangle with "!" |
| ErrorIcon | Circle with alert |
| QuestionIcon | Circle with "?" |

## Color Brushes Added

| Brush Key | Color | Usage |
|-----------|-------|-------|
| DangerBrush | #F48771 | Error icon color |
| WarningBrush | #F0C674 | Warning icon color |
| SuccessBrush | #89D185 | Info icon color |

---

## Unit Tests

### DialogServiceTests.cs

10 tests covering:
- Constructor (2 tests)
- ShowErrorAsync (1 test)
- ShowInfoAsync (1 test)
- ShowConfirmDialogAsync (1 test)
- ShowSaveDialogAsync (1 test)
- ShowOpenFileDialogAsync (2 tests)
- ShowFolderPickerAsync (1 test)
- ShowGoToLineDialogAsync (1 test)

### MessageDialogIconTests.cs

2 tests covering:
- Enum values verification
- Enum count verification

---

## Build Results

- **Errors:** 0
- **Warnings:** 1 (pre-existing)
- **New Tests:** 12

---

## Related Versions

- v0.3.3f: Find/Replace (EditorSearchManager)
- v0.3.3e: EditorPanel UI (base view)
- v0.3.3d: EditorConfiguration (settings)
- v0.3.3c: SyntaxHighlightingService (highlighting)
- v0.3.3b: EditorPanelViewModel (tab management)
