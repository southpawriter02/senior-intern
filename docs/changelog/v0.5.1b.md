# v0.5.1b: Terminal Models

**Date**: 2026-01-17

Implements the core model classes for the integrated terminal subsystem.

## Added

### Value Types (Structs)
- **`TerminalSize`** - `readonly record struct` for terminal dimensions (Columns, Rows)
  - Factory properties: `Default` (80x24), `Wide` (120x30), `Compact` (80x12)
  - Computed properties: `IsValid`, `TotalCells`
- **`TerminalColor`** - `readonly struct` supporting three color modes
  - Default, palette (0-255), and 24-bit RGB
  - Standard and bright ANSI color presets
- **`TerminalAttributes`** - `readonly struct` for text styling (SGR codes)
  - Bold, dim, italic, underline, blink, inverse, hidden, strikethrough
  - Foreground and background colors
  - Fluent `With()` method for immutable updates
- **`TerminalCell`** - Mutable struct for buffer cells
  - Uses `System.Text.Rune` for full Unicode support (including emoji)
  - Wide character support via `Width` and `IsContinuation` properties

### Reference Types (Classes/Records)
- **`TerminalLine`** - Sealed class for a row of cells
  - Dirty tracking for optimized rendering
  - `Span<TerminalCell>` accessor for efficient buffer operations
  - Text extraction, resize, and copy operations
- **`TerminalSelection`** - Sealed record for text selection
  - Line and block (rectangular) selection modes
  - Normalization, contains checking, and union operations
- **`TerminalSession`** - Sealed class implementing `IAsyncDisposable`
  - Session metadata: Id, Name, Shell, WorkingDirectory, Environment
  - Lifecycle: State, CreatedAt, ClosedAt, ExitCode
  - Workspace integration via `WorkspaceId`
- **`TerminalBuffer`** - Sealed class for screen buffer management
  - Scrollback history support (configurable limit)
  - VT100 cursor operations and scroll regions
  - Thread-safe via internal locking
  - ED/EL clearing operations

### Enums
- **`TerminalSessionState`** - Session lifecycle states
  - `Starting`, `Running`, `Exited`, `Error`, `Closing`

## Testing
- Added 44 unit tests across 8 test files in `tests/AIntern.Core.Tests/Models/Terminal/`
- All 109 Core tests pass

## Files Changed
| File | Status |
|------|--------|
| `src/AIntern.Core/Models/Terminal/TerminalSize.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalColor.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalAttributes.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalCell.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalLine.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalSelection.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalSession.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalBuffer.cs` | Added |
| `src/AIntern.Core/Models/Terminal/TerminalSessionState.cs` | Added |
| `src/AIntern.Core/Models/Terminal/README.md` | Deleted |

## Dependencies
- Builds on v0.5.1a (Pty.Net, System.IO.Pipelines packages)
- No new external dependencies

## Next Steps
- **v0.5.1c**: Implement `AnsiParser` for VT100/ANSI escape sequence processing
