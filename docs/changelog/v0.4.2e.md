# v0.4.2e: Side-by-Side Diff View

**Release Date:** January 16, 2026  
**Type:** Feature (Diff Engine UI)  
**Parent:** v0.4.2 Diff Engine

---

## Overview

v0.4.2e implements the DiffViewerPanel UserControl, providing a side-by-side diff viewing experience with synchronized scrolling. This panel combines the ViewModels from v0.4.2d with Avalonia UI controls.

---

## New Files

| File | Purpose |
|------|---------|
| `Views/DiffViewerPanel.axaml` | Main XAML layout with header, side-by-side panels, footer, overlays |
| `Views/DiffViewerPanel.axaml.cs` | Code-behind with synchronized scrolling and navigation |
| `Converters/IncrementConverter.cs` | 0-based to 1-based index converter |

---

## Key Features

### Panel Layout

```
┌────────────────────────────────────────────────────────────────┐
│ Header: [icon] FileName [lang] [NEW FILE] | +5 -3 2 hunks | ◄►│
├───────────────────────────┬─┬──────────────────────────────────┤
│ Original                  │█│ Proposed                         │
│ [lines with line numbers] │ │ [lines with line numbers]       │
├───────────────────────────┴─┴──────────────────────────────────┤
│ [Open in Editor]                        [Reject] [Apply]       │
└────────────────────────────────────────────────────────────────┘
```

### Synchronized Scrolling

Uses guard pattern to prevent infinite loops:

```csharp
private bool _isSyncingScroll;

private void OnOriginalScrollChanged(...)
{
    if (_isSyncingScroll) return;
    _isSyncingScroll = true;
    try { ProposedScrollViewer.Offset = OriginalScrollViewer.Offset; }
    finally { _isSyncingScroll = false; }
}
```

### Header Components

- File icon and name
- Language badge (conditional)
- NEW FILE badge (conditional)
- Stats: +N (green), -N (red), M hunks
- Navigation: position display, Prev/Next buttons
- Toolbar: inline changes, word wrap, sync scroll toggles

### Footer Actions

- Open in Editor button
- Reject button
- Apply Changes button (primary)

### Overlay States

- Loading: indeterminate progress + "Computing diff..."
- Error: error icon + message

---

## Resources Added

### Icons (`Icons.axaml`)

| Icon | Purpose |
|------|---------|
| ChevronUpIcon | Previous hunk |
| ChevronDownIcon | Next hunk |
| HighlightIcon | Inline changes toggle |
| WrapTextIcon | Word wrap toggle |
| LinkIcon | Sync scroll toggle |
| FileCodeIcon | File indicator |

### Colors (`Dark.axaml`)

| Resource | Color | Usage |
|----------|-------|-------|
| DiffHeaderBackground | #252526 | Header bar |
| DiffPanelBackground | #1E1E1E | Panel areas |
| DiffAddedForeground | #89D185 | Added text |
| DiffRemovedForeground | #F48771 | Removed text |
| DiffSplitterBackground | #3E3E3E | Panel divider |
| NewFileBadgeBackground | #2D5D2D | NEW FILE badge |

---

## Dependencies

| Version | Component |
|---------|-----------|
| v0.4.2d | DiffViewerViewModel, DiffHunkViewModel |
| v0.4.2f | DiffHunkControl (placeholder in current impl) |

---

## Verification

- ✅ Build succeeds
- ✅ 63 ViewModel tests pass
- ✅ Synchronized scrolling implemented
- ✅ Hunk navigation integrated

---

## Next Steps

**v0.4.2f: DiffHunkControl** - Individual hunk rendering with line-level styling
