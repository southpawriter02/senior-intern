# Design Specification: AIntern v0.5.5f "Terminal Settings Panel"

## Overview

**Version**: v0.5.5f
**Parent**: v0.5.5 Polish & Integration
**Focus**: Settings panel UI for terminal customization with live preview

### Purpose

This sub-version creates the terminal settings panel:
1. Create `TerminalSettingsViewModel` with observable properties
2. Create `TerminalSettingsPanel` XAML with appearance/behavior sections
3. Implement shell profile list with add/edit/delete
4. Support live preview of appearance changes
5. Track unsaved changes with warning banner
6. Add reset to defaults functionality
7. Integrate with main settings view

### Dependencies

**From v0.5.5e (Terminal Settings Models)**:
- `TerminalSettings`, `TerminalTheme`
- `TerminalCursorStyle`, `TerminalBellStyle`
- `IFontService`

**From v0.5.3c (Shell Profile Models)**:
- `ShellProfile`

**From v0.5.3a (Shell Detection)**:
- `IShellDetectionService`

---

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  v0.5.5f Terminal Settings Panel Architecture                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     ViewModel Layer                                      â”‚ â”‚
â”‚  â”‚  src/AIntern.Desktop/ViewModels/                                        â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  TerminalSettingsViewModel : ViewModelBase                               â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Dependencies:                                                      â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ ISettingsService                                               â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ IFontService                                                   â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ IShellDetectionService                                         â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Observable Properties:                                             â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Settings: TerminalSettings                                     â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ AvailableFonts: ObservableCollection<string>                   â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ AvailableThemes: ObservableCollection<TerminalTheme>           â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ ShellProfiles: ObservableCollection<ShellProfile>              â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ SelectedFontFamily, SelectedFontSize                           â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ SelectedTheme, SelectedCursorStyle                             â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ CursorBlink, ScrollbackLines, BellEnabled                      â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ SyncWithWorkspace, ConfirmOnClose                              â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ DefaultProfile, SelectedProfile                                â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ HasUnsavedChanges: bool                                        â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Commands:                                                          â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ SaveSettingsCommand                                            â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ ResetToDefaultsCommand                                         â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ DiscardChangesCommand                                          â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ AddProfileCommand                                              â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ EditProfileCommand                                             â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ DeleteProfileCommand                                           â”‚ â”‚
â”‚  â”‚  â”‚                                                                       â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Events:                                                            â”‚ â”‚
â”‚  â”‚      â”œâ”€â”€ PreviewSettingsChanged: EventHandler<TerminalSettings>         â”‚ â”‚
â”‚  â”‚      â”œâ”€â”€ SettingsSaved: EventHandler                                    â”‚ â”‚
â”‚  â”‚      â””â”€â”€ ProfileEditRequested: EventHandler<ShellProfile>               â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                       View Layer                                         â”‚ â”‚
â”‚  â”‚  src/AIntern.Desktop/Views/                                             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  TerminalSettingsPanel.axaml                                             â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Header with Reset/Save buttons                                     â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Appearance Section:                                                â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Font Family (ComboBox)                                         â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Font Size (Slider)                                             â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Theme (ComboBox)                                               â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Cursor Style (ComboBox)                                        â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ Cursor Blink (CheckBox)                                        â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Behavior Section:                                                  â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Scrollback Lines (Slider)                                      â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Bell Enabled (CheckBox)                                        â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ Sync with Workspace (CheckBox)                                 â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€ Shell Profiles Section:                                            â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Add Profile button                                             â”‚ â”‚
â”‚  â”‚  â”‚   â”œâ”€â”€ Profile ListBox                                                â”‚ â”‚
â”‚  â”‚  â”‚   â””â”€â”€ Default Profile selector                                       â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Unsaved Changes Warning Banner                                     â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  ShellTypeToIconConverter                                                â”‚ â”‚
â”‚  â”‚  â””â”€â”€ Converts ShellType â†’ PathIcon geometry                             â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Settings Panel Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Terminal Settings Panel Layout                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Terminal Settings                                   [Reset]  [Save]   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Appearance                                                             â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Font Family     [â–¼ Cascadia Code                               ]      â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Font Size       [â•â•â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•] 14pt                        â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Theme           [â–¼ Default Dark                                ]      â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Cursor Style    [â–¼ Block                                       ]      â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â˜‘ Blinking cursor                                                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Behavior                                                               â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Scrollback Lines [â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•] 10,000                       â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â˜ Enable bell sound                                                   â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â˜‘ Sync terminal directory with workspace                              â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  â˜‘ Confirm before closing terminal with running process                â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Shell Profiles                                       [Add Profile]    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ ğŸš zsh                                              [âœ] [Ã—]     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    /bin/zsh                                                       â”‚  â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚  â”‚  â”‚ ğŸš bash                                             [âœ] [Ã—]     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    /bin/bash                                                      â”‚  â”‚ â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ â”‚
â”‚  â”‚  â”‚ âš¡ PowerShell                                        [âœ]         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚    /usr/local/bin/pwsh                                            â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                         â”‚ â”‚
â”‚  â”‚  Default Profile  [â–¼ zsh                                        ]      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ âš  You have unsaved changes                    [Discard]  [Save]       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Specifications

### 1. TerminalSettingsViewModel.cs

**Location**: `src/AIntern.Desktop/ViewModels/TerminalSettingsViewModel.cs`

```csharp
namespace AIntern.Desktop.ViewModels;

using System.Collections.ObjectModel;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using Microsoft.Extensions.Logging;
using AIntern.Core.Interfaces;
using AIntern.Core.Models;
using AIntern.Core.Models.Terminal;

/// <summary>
/// ViewModel for the terminal settings panel.
/// Provides two-way binding for all terminal settings with live preview support.
/// </summary>
public partial class TerminalSettingsViewModel : ViewModelBase
{
    private readonly ILogger<TerminalSettingsViewModel> _logger;
    private readonly ISettingsService _settingsService;
    private readonly IFontService _fontService;
    private readonly IShellDetectionService _shellDetectionService;
    private readonly IShellProfileService _profileService;

    private TerminalSettings _originalSettings;

    // ========== Observable Properties ==========

    [ObservableProperty]
    private TerminalSettings _settings;

    [ObservableProperty]
    private ObservableCollection<string> _availableFonts = new();

    [ObservableProperty]
    private ObservableCollection<TerminalTheme> _availableThemes = new();

    [ObservableProperty]
    private ObservableCollection<ShellProfile> _shellProfiles = new();

    [ObservableProperty]
    private ShellProfile? _selectedProfile;

    [ObservableProperty]
    private ShellProfile? _defaultProfile;

    // Appearance
    [ObservableProperty]
    private string _selectedFontFamily = string.Empty;

    [ObservableProperty]
    private double _selectedFontSize = 14;

    [ObservableProperty]
    private double _lineHeight = 1.2;

    [ObservableProperty]
    private TerminalTheme? _selectedTheme;

    [ObservableProperty]
    private TerminalCursorStyle _selectedCursorStyle = TerminalCursorStyle.Block;

    [ObservableProperty]
    private bool _cursorBlink = true;

    [ObservableProperty]
    private int _cursorBlinkRate = 530;

    [ObservableProperty]
    private bool _boldIsBright = true;

    [ObservableProperty]
    private bool _enableLigatures = true;

    // Behavior
    [ObservableProperty]
    private int _scrollbackLines = 10000;

    [ObservableProperty]
    private bool _bellEnabled;

    [ObservableProperty]
    private TerminalBellStyle _bellStyle = TerminalBellStyle.Visual;

    [ObservableProperty]
    private bool _copyOnSelect;

    [ObservableProperty]
    private bool _scrollOnInput = true;

    [ObservableProperty]
    private bool _scrollOnOutput;

    [ObservableProperty]
    private bool _syncWithWorkspace = true;

    [ObservableProperty]
    private bool _confirmOnClose = true;

    // State
    [ObservableProperty]
    private bool _hasUnsavedChanges;

    [ObservableProperty]
    private string? _validationError;

    // ========== Static Lists ==========

    public IReadOnlyList<TerminalCursorStyle> CursorStyles { get; } =
        Enum.GetValues<TerminalCursorStyle>();

    public IReadOnlyList<TerminalBellStyle> BellStyles { get; } =
        Enum.GetValues<TerminalBellStyle>();

    // ========== Constructor ==========

    public TerminalSettingsViewModel(
        ILogger<TerminalSettingsViewModel> logger,
        ISettingsService settingsService,
        IFontService fontService,
        IShellDetectionService shellDetectionService,
        IShellProfileService profileService)
    {
        _logger = logger;
        _settingsService = settingsService;
        _fontService = fontService;
        _shellDetectionService = shellDetectionService;
        _profileService = profileService;

        _settings = _settingsService.CurrentSettings.Terminal;
        _originalSettings = _settings.Clone();

        LoadSettings();
    }

    // ========== Initialization ==========

    private void LoadSettings()
    {
        _logger.LogDebug("Loading terminal settings");

        // Load available fonts
        AvailableFonts = new ObservableCollection<string>(_fontService.GetMonospaceFonts());

        // Load available themes
        var themes = new List<TerminalTheme>(TerminalTheme.BuiltInThemes);
        if (_settingsService.CurrentSettings.CustomThemes != null)
        {
            themes.AddRange(_settingsService.CurrentSettings.CustomThemes);
        }
        AvailableThemes = new ObservableCollection<TerminalTheme>(themes);

        // Load shell profiles
        LoadShellProfilesAsync();

        // Set current values from settings
        SelectedFontFamily = _fontService.GetBestAvailableFont(Settings.FontFamily);
        SelectedFontSize = Settings.FontSize;
        LineHeight = Settings.LineHeight;
        SelectedTheme = AvailableThemes.FirstOrDefault(t => t.Name == Settings.ThemeName) 
                        ?? TerminalTheme.DefaultDark;
        SelectedCursorStyle = Settings.CursorStyle;
        CursorBlink = Settings.CursorBlink;
        CursorBlinkRate = Settings.CursorBlinkRate;
        BoldIsBright = Settings.BoldIsBright;
        EnableLigatures = Settings.EnableLigatures;
        ScrollbackLines = Settings.ScrollbackLines;
        BellEnabled = Settings.BellEnabled;
        BellStyle = Settings.BellStyle;
        CopyOnSelect = Settings.CopyOnSelect;
        ScrollOnInput = Settings.ScrollOnInput;
        ScrollOnOutput = Settings.ScrollOnOutput;
        SyncWithWorkspace = Settings.SyncWithWorkspace;
        ConfirmOnClose = Settings.ConfirmOnClose;

        HasUnsavedChanges = false;
        ValidationError = null;
    }

    private async void LoadShellProfilesAsync()
    {
        try
        {
            // Get detected shells
            var detectedShells = await _shellDetectionService.GetAvailableShellsAsync();
            
            // Create built-in profiles from detected shells
            var profiles = detectedShells
                .Select(s => new ShellProfile
                {
                    Id = $"builtin-{s.Type}",
                    Name = s.Name,
                    ShellPath = s.Path,
                    ShellType = s.Type,
                    IsBuiltIn = true
                })
                .ToList();

            // Add custom profiles
            profiles.AddRange(Settings.CustomProfiles);

            ShellProfiles = new ObservableCollection<ShellProfile>(profiles);

            // Set default profile
            DefaultProfile = ShellProfiles.FirstOrDefault(p => p.Id == Settings.DefaultProfileId)
                             ?? ShellProfiles.FirstOrDefault();
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to load shell profiles");
        }
    }

    // ========== Property Change Handlers ==========

    partial void OnSelectedFontFamilyChanged(string value) => MarkDirtyAndPreview();
    partial void OnSelectedFontSizeChanged(double value) => MarkDirtyAndPreview();
    partial void OnLineHeightChanged(double value) => MarkDirtyAndPreview();
    partial void OnSelectedThemeChanged(TerminalTheme? value) => MarkDirtyAndPreview();
    partial void OnSelectedCursorStyleChanged(TerminalCursorStyle value) => MarkDirtyAndPreview();
    partial void OnCursorBlinkChanged(bool value) => MarkDirtyAndPreview();
    partial void OnCursorBlinkRateChanged(int value) => MarkDirtyAndPreview();
    partial void OnBoldIsBrightChanged(bool value) => MarkDirtyAndPreview();
    partial void OnEnableLigaturesChanged(bool value) => MarkDirtyAndPreview();
    partial void OnScrollbackLinesChanged(int value) => MarkDirty();
    partial void OnBellEnabledChanged(bool value) => MarkDirty();
    partial void OnBellStyleChanged(TerminalBellStyle value) => MarkDirty();
    partial void OnCopyOnSelectChanged(bool value) => MarkDirty();
    partial void OnScrollOnInputChanged(bool value) => MarkDirty();
    partial void OnScrollOnOutputChanged(bool value) => MarkDirty();
    partial void OnSyncWithWorkspaceChanged(bool value) => MarkDirty();
    partial void OnConfirmOnCloseChanged(bool value) => MarkDirty();
    partial void OnDefaultProfileChanged(ShellProfile? value) => MarkDirty();

    private void MarkDirty()
    {
        HasUnsavedChanges = true;
        Validate();
    }

    private void MarkDirtyAndPreview()
    {
        MarkDirty();
        PreviewSettingsChanged?.Invoke(this, BuildPreviewSettings());
    }

    private TerminalSettings BuildPreviewSettings()
    {
        return new TerminalSettings
        {
            FontFamily = SelectedFontFamily,
            FontSize = SelectedFontSize,
            LineHeight = LineHeight,
            ThemeName = SelectedTheme?.Name ?? "Default Dark",
            CursorStyle = SelectedCursorStyle,
            CursorBlink = CursorBlink,
            CursorBlinkRate = CursorBlinkRate,
            BoldIsBright = BoldIsBright,
            EnableLigatures = EnableLigatures,
            ScrollbackLines = ScrollbackLines,
            BellEnabled = BellEnabled,
            BellStyle = BellStyle,
            CopyOnSelect = CopyOnSelect,
            ScrollOnInput = ScrollOnInput,
            ScrollOnOutput = ScrollOnOutput,
            SyncWithWorkspace = SyncWithWorkspace,
            ConfirmOnClose = ConfirmOnClose,
            DefaultProfileId = DefaultProfile?.Id,
            CustomProfiles = Settings.CustomProfiles
        };
    }

    private void Validate()
    {
        var previewSettings = BuildPreviewSettings();
        var errors = previewSettings.Validate();
        ValidationError = errors.Count > 0 ? string.Join("; ", errors) : null;
    }

    // ========== Commands ==========

    [RelayCommand]
    private void SaveSettings()
    {
        if (ValidationError != null)
        {
            _logger.LogWarning("Cannot save invalid settings: {Error}", ValidationError);
            return;
        }

        _logger.LogInformation("Saving terminal settings");

        // Apply all settings
        Settings.FontFamily = SelectedFontFamily;
        Settings.FontSize = SelectedFontSize;
        Settings.LineHeight = LineHeight;
        Settings.ThemeName = SelectedTheme?.Name ?? "Default Dark";
        Settings.CursorStyle = SelectedCursorStyle;
        Settings.CursorBlink = CursorBlink;
        Settings.CursorBlinkRate = CursorBlinkRate;
        Settings.BoldIsBright = BoldIsBright;
        Settings.EnableLigatures = EnableLigatures;
        Settings.ScrollbackLines = ScrollbackLines;
        Settings.BellEnabled = BellEnabled;
        Settings.BellStyle = BellStyle;
        Settings.CopyOnSelect = CopyOnSelect;
        Settings.ScrollOnInput = ScrollOnInput;
        Settings.ScrollOnOutput = ScrollOnOutput;
        Settings.SyncWithWorkspace = SyncWithWorkspace;
        Settings.ConfirmOnClose = ConfirmOnClose;
        Settings.DefaultProfileId = DefaultProfile?.Id;

        // Save custom profiles (excluding built-in)
        Settings.CustomProfiles = ShellProfiles
            .Where(p => !p.IsBuiltIn)
            .ToList();

        _settingsService.SaveSettings();
        _originalSettings = Settings.Clone();
        HasUnsavedChanges = false;

        SettingsSaved?.Invoke(this, EventArgs.Empty);
    }

    [RelayCommand]
    private void ResetToDefaults()
    {
        _logger.LogInformation("Resetting terminal settings to defaults");

        Settings = new TerminalSettings();
        LoadSettings();
        MarkDirtyAndPreview();
    }

    [RelayCommand]
    private void DiscardChanges()
    {
        _logger.LogDebug("Discarding terminal settings changes");

        Settings = _originalSettings.Clone();
        LoadSettings();
        PreviewSettingsChanged?.Invoke(this, Settings);
    }

    [RelayCommand]
    private async Task AddProfileAsync()
    {
        var defaultShell = await _shellDetectionService.GetDefaultShellAsync();
        
        var profile = new ShellProfile
        {
            Id = Guid.NewGuid().ToString(),
            Name = "New Profile",
            ShellPath = defaultShell?.Path ?? "/bin/bash",
            ShellType = defaultShell?.Type ?? ShellType.Unknown,
            IsBuiltIn = false
        };

        ShellProfiles.Add(profile);
        Settings.CustomProfiles.Add(profile);
        SelectedProfile = profile;
        MarkDirty();

        ProfileEditRequested?.Invoke(this, profile);
    }

    [RelayCommand]
    private void EditProfile(ShellProfile profile)
    {
        SelectedProfile = profile;
        ProfileEditRequested?.Invoke(this, profile);
    }

    [RelayCommand]
    private void DeleteProfile(ShellProfile profile)
    {
        if (profile.IsBuiltIn)
        {
            _logger.LogWarning("Cannot delete built-in profile: {Name}", profile.Name);
            return;
        }

        _logger.LogInformation("Deleting profile: {Name}", profile.Name);

        ShellProfiles.Remove(profile);
        Settings.CustomProfiles.Remove(profile);

        if (DefaultProfile == profile)
        {
            DefaultProfile = ShellProfiles.FirstOrDefault();
        }

        MarkDirty();
    }

    [RelayCommand]
    private void SetDefaultProfile(ShellProfile profile)
    {
        DefaultProfile = profile;
    }

    /// <summary>
    /// Updates a profile after editing.
    /// </summary>
    public void UpdateProfile(ShellProfile updatedProfile)
    {
        var existing = ShellProfiles.FirstOrDefault(p => p.Id == updatedProfile.Id);
        if (existing != null)
        {
            var index = ShellProfiles.IndexOf(existing);
            ShellProfiles[index] = updatedProfile;

            // Update in custom profiles
            var customIndex = Settings.CustomProfiles.FindIndex(p => p.Id == updatedProfile.Id);
            if (customIndex >= 0)
            {
                Settings.CustomProfiles[customIndex] = updatedProfile;
            }

            MarkDirty();
        }
    }

    // ========== Events ==========

    /// <summary>
    /// Raised when appearance settings change for live preview.
    /// </summary>
    public event EventHandler<TerminalSettings>? PreviewSettingsChanged;

    /// <summary>
    /// Raised when settings are saved.
    /// </summary>
    public event EventHandler? SettingsSaved;

    /// <summary>
    /// Raised when profile editing is requested.
    /// </summary>
    public event EventHandler<ShellProfile>? ProfileEditRequested;
}
```

### 2. TerminalSettingsPanel.axaml

**Location**: `src/AIntern.Desktop/Views/TerminalSettingsPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AIntern.Desktop.ViewModels"
             xmlns:converters="using:AIntern.Desktop.Converters"
             x:Class="AIntern.Desktop.Views.TerminalSettingsPanel"
             x:DataType="vm:TerminalSettingsViewModel">

    <UserControl.Resources>
        <converters:ShellTypeToIconConverter x:Key="ShellTypeToIconConverter" />
    </UserControl.Resources>

    <UserControl.Styles>
        <!-- Section Header -->
        <Style Selector="TextBlock.section-header">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}" />
            <Setter Property="Margin" Value="0,0,0,12" />
        </Style>

        <!-- Section Container -->
        <Style Selector="Border.section">
            <Setter Property="Background" Value="{DynamicResource SurfaceBrush}" />
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="CornerRadius" Value="8" />
            <Setter Property="Padding" Value="20" />
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <!-- Setting Row -->
        <Style Selector="Grid.setting-row">
            <Setter Property="Margin" Value="0,0,0,16" />
        </Style>

        <!-- Setting Label -->
        <Style Selector="TextBlock.setting-label">
            <Setter Property="VerticalAlignment" Value="Center" />
            <Setter Property="Foreground" Value="{DynamicResource TextSecondary}" />
        </Style>

        <!-- Checkbox Label -->
        <Style Selector="CheckBox.setting-checkbox">
            <Setter Property="Margin" Value="0,4,0,0" />
        </Style>

        <!-- Profile ListBox -->
        <Style Selector="ListBox.profile-list">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="BorderThickness" Value="0" />
        </Style>

        <Style Selector="ListBox.profile-list ListBoxItem">
            <Setter Property="Padding" Value="8" />
            <Setter Property="CornerRadius" Value="4" />
        </Style>
    </UserControl.Styles>

    <ScrollViewer HorizontalScrollBarVisibility="Disabled"
                  VerticalScrollBarVisibility="Auto">
        <StackPanel Padding="24" MaxWidth="640">

            <!-- Header -->
            <Grid ColumnDefinitions="*, Auto" Margin="0,0,0,24">
                <StackPanel>
                    <TextBlock Text="Terminal Settings" 
                               FontSize="24" 
                               FontWeight="SemiBold" />
                    <TextBlock Text="Configure terminal appearance and behavior"
                               FontSize="13"
                               Foreground="{DynamicResource TextMuted}"
                               Margin="0,4,0,0" />
                </StackPanel>
                <StackPanel Grid.Column="1" 
                            Orientation="Horizontal" 
                            Spacing="8"
                            VerticalAlignment="Center">
                    <Button Content="Reset to Defaults"
                            Command="{Binding ResetToDefaultsCommand}"
                            Classes="secondary" />
                    <Button Content="Save Changes"
                            Command="{Binding SaveSettingsCommand}"
                            IsEnabled="{Binding HasUnsavedChanges}"
                            Classes="primary" />
                </StackPanel>
            </Grid>

            <!-- Validation Error -->
            <Border Background="{DynamicResource ErrorBackgroundBrush}"
                    BorderBrush="{DynamicResource ErrorBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="12"
                    Margin="0,0,0,16"
                    IsVisible="{Binding ValidationError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <PathIcon Data="{StaticResource ErrorIcon}"
                              Width="16" Height="16"
                              Foreground="{DynamicResource ErrorBrush}" />
                    <TextBlock Text="{Binding ValidationError}"
                               Foreground="{DynamicResource ErrorBrush}" />
                </StackPanel>
            </Border>

            <!-- ==================== APPEARANCE SECTION ==================== -->
            <Border Classes="section">
                <StackPanel>
                    <TextBlock Classes="section-header" Text="Appearance" />

                    <!-- Font Family -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *">
                        <TextBlock Classes="setting-label" Text="Font Family" />
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding AvailableFonts}"
                                  SelectedItem="{Binding SelectedFontFamily}"
                                  HorizontalAlignment="Stretch">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding}" FontFamily="{Binding}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </Grid>

                    <!-- Font Size -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *, 60">
                        <TextBlock Classes="setting-label" Text="Font Size" />
                        <Slider Grid.Column="1"
                                Minimum="8" Maximum="32"
                                Value="{Binding SelectedFontSize}"
                                TickFrequency="1"
                                IsSnapToTickEnabled="True" />
                        <TextBlock Grid.Column="2"
                                   Text="{Binding SelectedFontSize, StringFormat={}{0:F0}pt}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right"
                                   FontFamily="{Binding SelectedFontFamily}" />
                    </Grid>

                    <!-- Line Height -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *, 60">
                        <TextBlock Classes="setting-label" Text="Line Height" />
                        <Slider Grid.Column="1"
                                Minimum="1.0" Maximum="2.0"
                                Value="{Binding LineHeight}"
                                TickFrequency="0.1"
                                IsSnapToTickEnabled="True" />
                        <TextBlock Grid.Column="2"
                                   Text="{Binding LineHeight, StringFormat={}{0:F1}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right" />
                    </Grid>

                    <!-- Theme -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *">
                        <TextBlock Classes="setting-label" Text="Color Theme" />
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding AvailableThemes}"
                                  SelectedItem="{Binding SelectedTheme}"
                                  HorizontalAlignment="Stretch">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <!-- Color Preview Swatches -->
                                        <Border Width="16" Height="16" CornerRadius="2"
                                                Background="{Binding Background}" 
                                                BorderBrush="{DynamicResource BorderBrush}"
                                                BorderThickness="1" />
                                        <TextBlock Text="{Binding Name}" />
                                    </StackPanel>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </Grid>

                    <!-- Cursor Style -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *">
                        <TextBlock Classes="setting-label" Text="Cursor Style" />
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding CursorStyles}"
                                  SelectedItem="{Binding SelectedCursorStyle}"
                                  HorizontalAlignment="Stretch" />
                    </Grid>

                    <!-- Cursor Options -->
                    <CheckBox Classes="setting-checkbox"
                              Content="Blinking cursor"
                              IsChecked="{Binding CursorBlink}" />

                    <CheckBox Classes="setting-checkbox"
                              Content="Render bold text as bright colors"
                              IsChecked="{Binding BoldIsBright}" />

                    <CheckBox Classes="setting-checkbox"
                              Content="Enable font ligatures"
                              IsChecked="{Binding EnableLigatures}" />
                </StackPanel>
            </Border>

            <!-- ==================== BEHAVIOR SECTION ==================== -->
            <Border Classes="section">
                <StackPanel>
                    <TextBlock Classes="section-header" Text="Behavior" />

                    <!-- Scrollback Lines -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *, 80">
                        <TextBlock Classes="setting-label" Text="Scrollback Lines" />
                        <Slider Grid.Column="1"
                                Minimum="1000" Maximum="100000"
                                Value="{Binding ScrollbackLines}"
                                TickFrequency="1000" />
                        <TextBlock Grid.Column="2"
                                   Text="{Binding ScrollbackLines, StringFormat={}{0:N0}}"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Right" />
                    </Grid>

                    <!-- Bell Settings -->
                    <CheckBox Classes="setting-checkbox"
                              Content="Enable terminal bell"
                              IsChecked="{Binding BellEnabled}" />

                    <Grid Classes="setting-row" 
                          ColumnDefinitions="160, *" 
                          Margin="24,8,0,0"
                          IsVisible="{Binding BellEnabled}">
                        <TextBlock Classes="setting-label" Text="Bell Style" />
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding BellStyles}"
                                  SelectedItem="{Binding BellStyle}"
                                  HorizontalAlignment="Stretch" />
                    </Grid>

                    <!-- Clipboard -->
                    <CheckBox Classes="setting-checkbox"
                              Content="Copy text on selection"
                              IsChecked="{Binding CopyOnSelect}" />

                    <!-- Scrolling -->
                    <CheckBox Classes="setting-checkbox"
                              Content="Scroll to bottom on keyboard input"
                              IsChecked="{Binding ScrollOnInput}" />

                    <CheckBox Classes="setting-checkbox"
                              Content="Scroll to bottom on new output"
                              IsChecked="{Binding ScrollOnOutput}" />

                    <!-- Integration -->
                    <CheckBox Classes="setting-checkbox"
                              Content="Sync terminal directory with workspace"
                              IsChecked="{Binding SyncWithWorkspace}" />

                    <CheckBox Classes="setting-checkbox"
                              Content="Confirm before closing terminal with running process"
                              IsChecked="{Binding ConfirmOnClose}" />
                </StackPanel>
            </Border>

            <!-- ==================== SHELL PROFILES SECTION ==================== -->
            <Border Classes="section">
                <StackPanel>
                    <!-- Section Header with Add Button -->
                    <Grid ColumnDefinitions="*, Auto" Margin="0,0,0,12">
                        <TextBlock Classes="section-header" Text="Shell Profiles" Margin="0" />
                        <Button Grid.Column="1"
                                Content="Add Profile"
                                Command="{Binding AddProfileCommand}"
                                Classes="secondary">
                            <Button.Content>
                                <StackPanel Orientation="Horizontal" Spacing="6">
                                    <PathIcon Data="{StaticResource AddIcon}" 
                                              Width="12" Height="12" />
                                    <TextBlock Text="Add Profile" />
                                </StackPanel>
                            </Button.Content>
                        </Button>
                    </Grid>

                    <!-- Profile List -->
                    <Border BorderBrush="{DynamicResource BorderBrush}"
                            BorderThickness="1"
                            CornerRadius="4"
                            MinHeight="120"
                            MaxHeight="240">
                        <ListBox Classes="profile-list"
                                 ItemsSource="{Binding ShellProfiles}"
                                 SelectedItem="{Binding SelectedProfile}">
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid ColumnDefinitions="Auto, *, Auto, Auto" Margin="4">
                                        <!-- Shell Icon -->
                                        <PathIcon Data="{Binding ShellType, Converter={StaticResource ShellTypeToIconConverter}}"
                                                  Width="20" Height="20"
                                                  Margin="0,0,12,0"
                                                  Foreground="{DynamicResource TextSecondary}" />

                                        <!-- Name and Path -->
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <TextBlock Text="{Binding Name}" 
                                                           FontWeight="Medium" />
                                                <Border Background="{DynamicResource AccentBrush}"
                                                        CornerRadius="2"
                                                        Padding="4,1"
                                                        IsVisible="{Binding IsBuiltIn}">
                                                    <TextBlock Text="Built-in" 
                                                               FontSize="10"
                                                               Foreground="{DynamicResource AccentForeground}" />
                                                </Border>
                                            </StackPanel>
                                            <TextBlock Text="{Binding ShellPath}"
                                                       FontSize="11"
                                                       Foreground="{DynamicResource TextMuted}"
                                                       TextTrimming="CharacterEllipsis" />
                                        </StackPanel>

                                        <!-- Edit Button -->
                                        <Button Grid.Column="2"
                                                Classes="icon-button"
                                                Command="{Binding $parent[UserControl].((vm:TerminalSettingsViewModel)DataContext).EditProfileCommand}"
                                                CommandParameter="{Binding}"
                                                ToolTip.Tip="Edit Profile"
                                                Margin="4,0">
                                            <PathIcon Data="{StaticResource EditIcon}" 
                                                      Width="14" Height="14" />
                                        </Button>

                                        <!-- Delete Button (only for custom profiles) -->
                                        <Button Grid.Column="3"
                                                Classes="icon-button"
                                                Command="{Binding $parent[UserControl].((vm:TerminalSettingsViewModel)DataContext).DeleteProfileCommand}"
                                                CommandParameter="{Binding}"
                                                IsVisible="{Binding !IsBuiltIn}"
                                                ToolTip.Tip="Delete Profile">
                                            <PathIcon Data="{StaticResource DeleteIcon}" 
                                                      Width="14" Height="14" />
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>

                    <!-- Default Profile Selector -->
                    <Grid Classes="setting-row" ColumnDefinitions="160, *" Margin="0,16,0,0">
                        <TextBlock Classes="setting-label" Text="Default Profile" />
                        <ComboBox Grid.Column="1"
                                  ItemsSource="{Binding ShellProfiles}"
                                  SelectedItem="{Binding DefaultProfile}"
                                  HorizontalAlignment="Stretch">
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}" />
                                </DataTemplate>
                            </ComboBox.ItemTemplate>
                        </ComboBox>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- ==================== UNSAVED CHANGES BANNER ==================== -->
            <Border Background="{DynamicResource WarningBackgroundBrush}"
                    BorderBrush="{DynamicResource WarningBorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16"
                    IsVisible="{Binding HasUnsavedChanges}">
                <Grid ColumnDefinitions="Auto, *, Auto">
                    <PathIcon Data="{StaticResource WarningIcon}"
                              Width="20" Height="20"
                              Foreground="{DynamicResource WarningBrush}" />
                    <TextBlock Grid.Column="1"
                               Text="You have unsaved changes"
                               VerticalAlignment="Center"
                               Margin="12,0" />
                    <StackPanel Grid.Column="2" 
                                Orientation="Horizontal" 
                                Spacing="8">
                        <Button Content="Discard"
                                Command="{Binding DiscardChangesCommand}"
                                Classes="secondary" />
                        <Button Content="Save"
                                Command="{Binding SaveSettingsCommand}"
                                Classes="primary" />
                    </StackPanel>
                </Grid>
            </Border>

        </StackPanel>
    </ScrollViewer>
</UserControl>
```

### 3. TerminalSettingsPanel.axaml.cs

**Location**: `src/AIntern.Desktop/Views/TerminalSettingsPanel.axaml.cs`

```csharp
namespace AIntern.Desktop.Views;

using Avalonia.Controls;

/// <summary>
/// Code-behind for the terminal settings panel.
/// </summary>
public partial class TerminalSettingsPanel : UserControl
{
    public TerminalSettingsPanel()
    {
        InitializeComponent();
    }
}
```

### 4. ShellTypeToIconConverter.cs

**Location**: `src/AIntern.Desktop/Converters/ShellTypeToIconConverter.cs`

```csharp
namespace AIntern.Desktop.Converters;

using System.Globalization;
using Avalonia;
using Avalonia.Data.Converters;
using Avalonia.Media;
using AIntern.Core.Models.Terminal;

/// <summary>
/// Converts ShellType to a PathGeometry for icon display.
/// </summary>
public class ShellTypeToIconConverter : IValueConverter
{
    // Shell icons as geometry paths
    private static readonly Geometry BashIcon = Geometry.Parse(
        "M4 2h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm4 4v8l3-3 3 3V6H8z");
    
    private static readonly Geometry ZshIcon = Geometry.Parse(
        "M4 2h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm3 5h10v2H7V7zm3 4h7v2h-7v-2zm-3 4h10v2H7v-2z");
    
    private static readonly Geometry PowerShellIcon = Geometry.Parse(
        "M21.9 10.6L13.8 2.5C13.4 2.1 12.7 2.1 12.3 2.5L9.7 5.1C9.3 5.5 9.3 6.2 9.7 6.6L15.1 12L9.7 17.4C9.3 17.8 9.3 18.5 9.7 18.9L12.3 21.5C12.7 21.9 13.4 21.9 13.8 21.5L21.9 13.4C22.3 13 22.3 12.3 21.9 11.9V10.6zM4 19H2V5H4V19z");
    
    private static readonly Geometry CmdIcon = Geometry.Parse(
        "M2 4h20v16H2V4zm2 2v12h16V6H4zm2 2h12v2H6V8zm0 4h8v2H6v-2z");
    
    private static readonly Geometry FishIcon = Geometry.Parse(
        "M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm-2-9c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm4 0c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1zm-2 5c-2.33 0-4.31-1.46-5.11-3.5h10.22c-.8 2.04-2.78 3.5-5.11 3.5z");
    
    private static readonly Geometry DefaultShellIcon = Geometry.Parse(
        "M4 4h16v16H4V4zm2 2v12h12V6H6zm2 2h8v2H8V8zm0 4l3 2-3 2v-4z");

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is ShellType shellType)
        {
            return shellType switch
            {
                ShellType.Bash => BashIcon,
                ShellType.Zsh => ZshIcon,
                ShellType.PowerShell => PowerShellIcon,
                ShellType.Cmd => CmdIcon,
                ShellType.Fish => FishIcon,
                _ => DefaultShellIcon
            };
        }

        return DefaultShellIcon;
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
}
```

---

## File Summary

### Files to Create

| File | Location | Purpose |
|------|----------|---------|
| `TerminalSettingsViewModel.cs` | `ViewModels/` | Settings ViewModel |
| `TerminalSettingsPanel.axaml` | `Views/` | Settings panel UI |
| `TerminalSettingsPanel.axaml.cs` | `Views/` | Code-behind |
| `ShellTypeToIconConverter.cs` | `Converters/` | Shell type to icon |

### Files to Modify

| File | Changes |
|------|---------|
| `SettingsView.axaml` | Add terminal settings tab |
| `SettingsViewModel.cs` | Include terminal settings VM |
| `App.axaml` | Register converter |

---

## Unit Test Plan

| Test | Description |
|------|-------------|
| `ViewModel_LoadSettings_PopulatesFonts` | Font list loaded |
| `ViewModel_LoadSettings_PopulatesThemes` | Theme list loaded |
| `ViewModel_LoadSettings_PopulatesProfiles` | Profile list loaded |
| `ViewModel_PropertyChange_SetsUnsavedChanges` | Dirty flag set |
| `ViewModel_PropertyChange_RaisesPreviewEvent` | Preview event fired |
| `ViewModel_SaveSettings_PersistsToService` | Settings saved |
| `ViewModel_SaveSettings_ClearsUnsavedChanges` | Dirty flag cleared |
| `ViewModel_ResetToDefaults_CreatesNewSettings` | Defaults applied |
| `ViewModel_DiscardChanges_ReloadsOriginal` | Changes discarded |
| `ViewModel_AddProfile_CreatesNew` | Profile created |
| `ViewModel_DeleteProfile_RemovesFromList` | Profile removed |
| `ViewModel_DeleteProfile_RejectsBuiltIn` | Built-in protected |
| `ViewModel_UpdateProfile_ReplacesExisting` | Profile updated |
| `ViewModel_Validate_DetectsErrors` | Validation works |
| `Converter_ShellType_ReturnsCorrectIcon` | Icon mapping |

**Total Tests**: 15

---

## Verification

```bash
# Build the desktop project
dotnet build src/AIntern.Desktop

# Run unit tests
dotnet test --filter "TerminalSettings"

# Run application and test visually
dotnet run --project src/AIntern.Desktop
# 1. Open Settings
# 2. Navigate to Terminal tab
# 3. Change font, theme, cursor style
# 4. Verify live preview
# 5. Add/Edit/Delete profiles
# 6. Save and verify persistence
```

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | Font dropdown shows available monospace fonts |
| AC-2 | Font size slider updates preview in real-time |
| AC-3 | Theme dropdown shows built-in themes with color swatches |
| AC-4 | Cursor style selection works |
| AC-5 | All behavior checkboxes function |
| AC-6 | Shell profiles list shows detected shells |
| AC-7 | Add Profile creates new custom profile |
| AC-8 | Edit Profile opens profile editor |
| AC-9 | Delete Profile removes (only custom) |
| AC-10 | Default Profile selector works |
| AC-11 | Unsaved changes banner appears on any change |
| AC-12 | Save persists all settings |
| AC-13 | Discard reverts to saved values |
| AC-14 | Reset to defaults creates fresh settings |
| AC-15 | Validation errors display correctly |

---

## Changelog Entry

```markdown
## v0.5.5f - Terminal Settings Panel

### Added
- `TerminalSettingsViewModel` with:
  - Observable properties for all settings
  - Live preview via PreviewSettingsChanged event
  - HasUnsavedChanges tracking
  - Validation with error display
  - Save, Reset, Discard commands
  - Profile management (Add, Edit, Delete)

- `TerminalSettingsPanel` UI with:
  - Appearance section: Font, Theme, Cursor
  - Behavior section: Scrollback, Bell, Clipboard, Scroll
  - Shell Profiles section: List, Add, Edit, Delete
  - Unsaved changes warning banner
  - Validation error display

- `ShellTypeToIconConverter` for profile list icons

### Integration
- Added Terminal tab to main Settings view
```

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.5.5f | 1 day |
