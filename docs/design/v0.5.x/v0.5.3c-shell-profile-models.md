# Design Specification: AIntern v0.5.3c "Shell Profile Models"

## Overview

**Version**: v0.5.3c
**Parent**: v0.5.3 Shell Integration
**Focus**: User profile definitions, appearance customization, persistence models

### Purpose

This sub-version defines the data models for user-configurable shell profiles that enable:
1. Customization of shell behavior (startup commands, environment variables)
2. Appearance overrides (fonts, themes, cursor styles)
3. Tab behavior configuration (close-on-exit, tab title formatting)
4. Application settings extension for terminal-wide defaults
5. Profile cloning for easy profile creation from templates

### Dependencies

**From v0.5.3a (Shell Detection)**:
- `ShellType` enumeration - Identifies shell variants

**From v0.5.3b (Shell Configuration)**:
- `ShellConfiguration` - Shell-specific command syntax and capabilities

**From Existing Codebase**:
- `AppSettings` model - Extended with terminal settings properties

---

## Architecture

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                   v0.5.3c Shell Profile Models Architecture                   │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Model Layer                                       │ │
│  │  src/AIntern.Core/Models/Terminal/                                      │ │
│  ├─────────────────────────────────────────────────────────────────────────┤ │
│  │                                                                          │ │
│  │  ShellProfile (class)                                                    │ │
│  │  ├── Identity:                                                          │ │
│  │  │   ├── Id: Guid                                                       │ │
│  │  │   ├── Name: string                                                   │ │
│  │  │   ├── IconPath: string?                                              │ │
│  │  │   └── AccentColor: string?                                           │ │
│  │  │                                                                       │ │
│  │  ├── Shell Configuration:                                               │ │
│  │  │   ├── ShellPath: string                                              │ │
│  │  │   ├── ShellType: ShellType                                           │ │
│  │  │   ├── Arguments: string?                                             │ │
│  │  │   ├── StartingDirectory: string?                                     │ │
│  │  │   ├── StartupCommand: string?                                        │ │
│  │  │   └── Environment: Dictionary<string, string>                        │ │
│  │  │                                                                       │ │
│  │  ├── Appearance Overrides (nullable = use global):                      │ │
│  │  │   ├── FontFamily: string?                                            │ │
│  │  │   ├── FontSize: double?                                              │ │
│  │  │   ├── ThemeName: string?                                             │ │
│  │  │   ├── CursorStyle: TerminalCursorStyle?                              │ │
│  │  │   ├── CursorBlink: bool?                                             │ │
│  │  │   └── ScrollbackLines: int?                                          │ │
│  │  │                                                                       │ │
│  │  ├── Behavior:                                                          │ │
│  │  │   ├── CloseOnExit: ProfileCloseOnExit                                │ │
│  │  │   ├── BellStyle: TerminalBellStyle                                   │ │
│  │  │   └── TabTitleFormat: string?                                        │ │
│  │  │                                                                       │ │
│  │  ├── Profile Metadata:                                                  │ │
│  │  │   ├── IsDefault: bool                                                │ │
│  │  │   ├── IsHidden: bool                                                 │ │
│  │  │   ├── IsBuiltIn: bool                                                │ │
│  │  │   ├── SortOrder: int                                                 │ │
│  │  │   ├── CreatedAt: DateTime                                            │ │
│  │  │   └── ModifiedAt: DateTime                                           │ │
│  │  │                                                                       │ │
│  │  └── Methods:                                                           │ │
│  │      └── Clone() → ShellProfile                                         │ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Enumeration Layer                                 │ │
│  │  src/AIntern.Core/Models/Terminal/                                      │ │
│  ├─────────────────────────────────────────────────────────────────────────┤ │
│  │                                                                          │ │
│  │  TerminalCursorStyle       ProfileCloseOnExit      TerminalBellStyle    │ │
│  │  ├── Block                 ├── Always              ├── Audible          │ │
│  │  ├── Underline             ├── OnCleanExit         ├── Visual           │ │
│  │  └── Bar                   └── Never               ├── Both             │ │
│  │                                                     └── None             │ │
│  │                                                                          │ │
│  │  DirectorySyncMode                                                       │ │
│  │  ├── ActiveTerminalOnly                                                 │ │
│  │  ├── AllLinkedTerminals                                                 │ │
│  │  └── Manual                                                              │ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Defaults Layer                                    │ │
│  │  src/AIntern.Core/Models/Terminal/                                      │ │
│  ├─────────────────────────────────────────────────────────────────────────┤ │
│  │                                                                          │ │
│  │  ShellProfileDefaults (class)                                           │ │
│  │  ├── FontFamily: string = "Cascadia Mono, Consolas, monospace"          │ │
│  │  ├── FontSize: double = 14                                              │ │
│  │  ├── ThemeName: string = "Dark"                                         │ │
│  │  ├── CursorStyle: TerminalCursorStyle = Block                           │ │
│  │  ├── CursorBlink: bool = true                                           │ │
│  │  ├── ScrollbackLines: int = 10000                                       │ │
│  │  ├── BellStyle: TerminalBellStyle = Audible                             │ │
│  │  └── CloseOnExit: ProfileCloseOnExit = OnCleanExit                      │ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────────┐ │
│  │                        Settings Extension                                │ │
│  │  src/AIntern.Core/Models/                                               │ │
│  ├─────────────────────────────────────────────────────────────────────────┤ │
│  │                                                                          │ │
│  │  AppSettings (extended)                                                  │ │
│  │  ├── TerminalFontFamily: string                                         │ │
│  │  ├── TerminalFontSize: double                                           │ │
│  │  ├── TerminalScrollbackLines: int                                       │ │
│  │  ├── TerminalBellStyle: TerminalBellStyle                               │ │
│  │  ├── TerminalCursorStyle: TerminalCursorStyle                           │ │
│  │  ├── TerminalCursorBlink: bool                                          │ │
│  │  ├── TerminalTheme: string                                              │ │
│  │  ├── TerminalPanelHeight: double                                        │ │
│  │  ├── TerminalWordSeparators: string                                     │ │
│  │  ├── TerminalCopyOnSelect: bool                                         │ │
│  │  ├── TerminalToggleShortcut: string                                     │ │
│  │  ├── TerminalNewShortcut: string                                        │ │
│  │  ├── SyncTerminalWithWorkspace: bool                                    │ │
│  │  ├── TerminalSyncMode: DirectorySyncMode                                │ │
│  │  ├── DefaultShellProfileId: Guid?                                       │ │
│  │  ├── ShowTerminalOnStartup: bool                                        │ │
│  │  └── RestoreTerminalSessions: bool                                      │ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Model Relationships

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                         Model Relationship Diagram                            │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ┌────────────────────┐        ┌─────────────────────┐                       │
│  │    AppSettings     │        │   ShellProfile      │                       │
│  ├────────────────────┤        ├─────────────────────┤                       │
│  │ DefaultShellProfile├───────▶│ Id: Guid            │                       │
│  │ Id: Guid?          │        │ Name: string        │                       │
│  │                    │        │ ShellPath: string   │                       │
│  │ TerminalFontFamily │        │ ShellType: ShellType│◀────┐                 │
│  │ TerminalFontSize   │        │                     │     │                 │
│  │ TerminalCursorStyle│−−−−−−▶│ CursorStyle?        │     │                 │
│  │ TerminalCursorBlink│        │ CursorBlink?        │     │                 │
│  │ TerminalBellStyle  │        │ BellStyle           │     │                 │
│  │ TerminalTheme      │        │ ThemeName?          │     │                 │
│  │ ...                │        │ ...                 │     │                 │
│  └────────────────────┘        └─────────────────────┘     │                 │
│         │                               │                   │                 │
│         │ (provides defaults)           │ (references)      │                 │
│         ▼                               ▼                   │                 │
│  ┌────────────────────┐        ┌─────────────────────┐     │                 │
│  │ShellProfileDefaults│        │     ShellType       │─────┘                 │
│  ├────────────────────┤        ├─────────────────────┤                       │
│  │ FontFamily         │        │ Unknown             │                       │
│  │ FontSize           │        │ Bash                │                       │
│  │ ThemeName          │        │ Zsh                 │                       │
│  │ CursorStyle        │        │ Fish                │                       │
│  │ CursorBlink        │        │ PowerShell          │                       │
│  │ ScrollbackLines    │        │ Cmd                 │                       │
│  │ BellStyle          │        │ ...                 │                       │
│  │ CloseOnExit        │        └─────────────────────┘                       │
│  └────────────────────┘                                                      │
│                                                                              │
│  Nullable Override Pattern:                                                  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  When profile.FontFamily is null → use AppSettings.TerminalFontFamily │  │
│  │  When profile.FontFamily is set  → use profile.FontFamily (override)  │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Tab Title Format Placeholders

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                        Tab Title Format Placeholders                          │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ShellProfile.TabTitleFormat supports the following placeholders:            │
│                                                                              │
│  ┌───────────────┬───────────────────────────────────────────────────────┐  │
│  │ Placeholder   │ Description                                           │  │
│  ├───────────────┼───────────────────────────────────────────────────────┤  │
│  │ {name}        │ Profile name (e.g., "PowerShell", "Git Bash")         │  │
│  │ {cwd}         │ Current working directory basename                    │  │
│  │ {cwdFull}     │ Current working directory full path                   │  │
│  │ {process}     │ Running process name                                  │  │
│  │ {shell}       │ Shell executable name                                 │  │
│  │ {user}        │ Current username                                      │  │
│  │ {host}        │ Machine hostname                                      │  │
│  └───────────────┴───────────────────────────────────────────────────────┘  │
│                                                                              │
│  Examples:                                                                   │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │ Format: "{name}: {cwd}"                                               │  │
│  │ Result: "PowerShell: projects"                                        │  │
│  │                                                                        │  │
│  │ Format: "{user}@{host} - {cwdFull}"                                   │  │
│  │ Result: "ryan@macbook - /Users/ryan/projects/aintern"                 │  │
│  │                                                                        │  │
│  │ Format: null (default behavior)                                       │  │
│  │ Result: Profile name or detected process name                         │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Profile Clone Behavior

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                          Profile Clone Semantics                              │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ShellProfile.Clone() creates a new profile with:                            │
│                                                                              │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  Copied Properties:                                                    │  │
│  │  ├── ShellPath, ShellType, StartingDirectory, Arguments              │  │
│  │  ├── Environment (deep copy)                                          │  │
│  │  ├── All appearance settings (FontFamily, FontSize, etc.)            │  │
│  │  ├── Behavior settings (CloseOnExit, BellStyle, TabTitleFormat)      │  │
│  │  └── ScrollbackLines, StartupCommand, IconPath, AccentColor          │  │
│  │                                                                        │  │
│  │  Modified Properties:                                                  │  │
│  │  ├── Id: new Guid (auto-generated)                                    │  │
│  │  ├── Name: "{OriginalName} (Copy)"                                    │  │
│  │  ├── IsDefault: false (copies are never default)                      │  │
│  │  ├── IsBuiltIn: false (copies are user profiles)                      │  │
│  │  ├── IsHidden: preserved from original                                │  │
│  │  ├── SortOrder: original + 1                                          │  │
│  │  ├── CreatedAt: DateTime.UtcNow                                       │  │
│  │  └── ModifiedAt: DateTime.UtcNow                                      │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
│  Use Cases:                                                                  │
│  ┌───────────────────────────────────────────────────────────────────────┐  │
│  │  1. User wants variations of built-in profiles                        │  │
│  │     → Clone "PowerShell", customize font/theme                        │  │
│  │                                                                        │  │
│  │  2. Project-specific profiles                                          │  │
│  │     → Clone "Zsh", set StartingDirectory to project path              │  │
│  │                                                                        │  │
│  │  3. Theme experimentation                                              │  │
│  │     → Clone existing profile, try new color scheme                    │  │
│  └───────────────────────────────────────────────────────────────────────┘  │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## File Specifications

### 1. TerminalCursorStyle.cs

**Location**: `src/AIntern.Core/Models/Terminal/TerminalCursorStyle.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

/// <summary>
/// Terminal cursor display styles.
/// </summary>
public enum TerminalCursorStyle
{
    /// <summary>
    /// Solid block cursor (classic terminal style).
    /// </summary>
    Block,

    /// <summary>
    /// Horizontal underline cursor.
    /// </summary>
    Underline,

    /// <summary>
    /// Vertical bar cursor (I-beam style).
    /// </summary>
    Bar
}
```

### 2. ProfileCloseOnExit.cs

**Location**: `src/AIntern.Core/Models/Terminal/ProfileCloseOnExit.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

/// <summary>
/// Defines behavior when a shell process exits.
/// </summary>
public enum ProfileCloseOnExit
{
    /// <summary>
    /// Always close the terminal tab when the shell exits.
    /// </summary>
    Always,

    /// <summary>
    /// Close only if the shell exits with code 0 (success).
    /// Non-zero exit codes keep the tab open to show error state.
    /// </summary>
    OnCleanExit,

    /// <summary>
    /// Never auto-close the tab. Show "[Process exited]" message
    /// and require manual close.
    /// </summary>
    Never
}
```

### 3. TerminalBellStyle.cs

**Location**: `src/AIntern.Core/Models/Terminal/TerminalBellStyle.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

/// <summary>
/// Terminal bell notification styles.
/// </summary>
public enum TerminalBellStyle
{
    /// <summary>
    /// Play system audible bell sound.
    /// </summary>
    Audible,

    /// <summary>
    /// Flash the terminal window or tab (visual bell).
    /// </summary>
    Visual,

    /// <summary>
    /// Both audible and visual notification.
    /// </summary>
    Both,

    /// <summary>
    /// Bell is disabled, no notification.
    /// </summary>
    None
}
```

### 4. DirectorySyncMode.cs

**Location**: `src/AIntern.Core/Models/Terminal/DirectorySyncMode.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

/// <summary>
/// Defines how terminal working directory syncs with the file explorer.
/// </summary>
public enum DirectorySyncMode
{
    /// <summary>
    /// Only sync the currently active/focused terminal tab.
    /// Other terminal tabs maintain their own directories.
    /// </summary>
    ActiveTerminalOnly,

    /// <summary>
    /// Sync all terminal tabs that are linked to the current workspace.
    /// </summary>
    AllLinkedTerminals,

    /// <summary>
    /// Never auto-sync. Directory changes are manual only.
    /// </summary>
    Manual
}
```

### 5. ShellProfileDefaults.cs

**Location**: `src/AIntern.Core/Models/Terminal/ShellProfileDefaults.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

/// <summary>
/// Default/effective values for shell profile settings.
/// Used when a profile's nullable setting is unset.
/// </summary>
public sealed class ShellProfileDefaults
{
    /// <summary>
    /// Default terminal font family.
    /// </summary>
    public string FontFamily { get; set; } = "Cascadia Mono, Consolas, monospace";

    /// <summary>
    /// Default terminal font size in points.
    /// </summary>
    public double FontSize { get; set; } = 14;

    /// <summary>
    /// Default terminal color theme name.
    /// </summary>
    public string ThemeName { get; set; } = "Dark";

    /// <summary>
    /// Default cursor style.
    /// </summary>
    public TerminalCursorStyle CursorStyle { get; set; } = TerminalCursorStyle.Block;

    /// <summary>
    /// Default cursor blink setting.
    /// </summary>
    public bool CursorBlink { get; set; } = true;

    /// <summary>
    /// Default number of scrollback lines to retain.
    /// </summary>
    public int ScrollbackLines { get; set; } = 10000;

    /// <summary>
    /// Default bell notification style.
    /// </summary>
    public TerminalBellStyle BellStyle { get; set; } = TerminalBellStyle.Audible;

    /// <summary>
    /// Default close-on-exit behavior.
    /// </summary>
    public ProfileCloseOnExit CloseOnExit { get; set; } = ProfileCloseOnExit.OnCleanExit;
}
```

### 6. ShellProfile.cs

**Location**: `src/AIntern.Core/Models/Terminal/ShellProfile.cs`

```csharp
namespace AIntern.Core.Models.Terminal;

using System.Text.Json.Serialization;

/// <summary>
/// User-configurable shell profile for terminal sessions.
/// Profiles can override application-wide terminal settings.
/// </summary>
public sealed class ShellProfile
{
    // === Identity ===

    /// <summary>
    /// Unique identifier for this profile.
    /// </summary>
    public Guid Id { get; init; } = Guid.NewGuid();

    /// <summary>
    /// Display name for this profile (shown in tabs and menus).
    /// </summary>
    public string Name { get; set; } = "Default";

    /// <summary>
    /// Optional path to an icon file for this profile.
    /// </summary>
    public string? IconPath { get; set; }

    /// <summary>
    /// Optional accent color for this profile's tab (hex format, e.g., "#FF5733").
    /// </summary>
    public string? AccentColor { get; set; }

    // === Shell Configuration ===

    /// <summary>
    /// Full path to the shell executable.
    /// </summary>
    public string ShellPath { get; set; } = string.Empty;

    /// <summary>
    /// Type of shell. Auto-detected if not explicitly specified.
    /// </summary>
    public ShellType ShellType { get; set; } = ShellType.Unknown;

    /// <summary>
    /// Command-line arguments passed to the shell on startup.
    /// </summary>
    public string? Arguments { get; set; }

    /// <summary>
    /// Starting directory for new sessions.
    /// When null, inherits from the current workspace.
    /// </summary>
    public string? StartingDirectory { get; set; }

    /// <summary>
    /// Command to run after shell initialization (e.g., "cd ~/projects && clear").
    /// </summary>
    public string? StartupCommand { get; set; }

    /// <summary>
    /// Custom environment variables for this profile.
    /// Merged with shell-specific defaults.
    /// </summary>
    public Dictionary<string, string> Environment { get; set; } = new();

    // === Appearance Overrides ===
    // Null values indicate "use application default"

    /// <summary>
    /// Font family override for this profile.
    /// </summary>
    public string? FontFamily { get; set; }

    /// <summary>
    /// Font size override for this profile.
    /// </summary>
    public double? FontSize { get; set; }

    /// <summary>
    /// Theme name override for this profile.
    /// </summary>
    public string? ThemeName { get; set; }

    /// <summary>
    /// Cursor style override for this profile.
    /// </summary>
    public TerminalCursorStyle? CursorStyle { get; set; }

    /// <summary>
    /// Cursor blink override for this profile.
    /// </summary>
    public bool? CursorBlink { get; set; }

    /// <summary>
    /// Scrollback lines override for this profile.
    /// </summary>
    public int? ScrollbackLines { get; set; }

    // === Behavior ===

    /// <summary>
    /// Tab close behavior when shell process exits.
    /// </summary>
    public ProfileCloseOnExit CloseOnExit { get; set; } = ProfileCloseOnExit.OnCleanExit;

    /// <summary>
    /// Bell notification style for this profile.
    /// </summary>
    public TerminalBellStyle BellStyle { get; set; } = TerminalBellStyle.Audible;

    /// <summary>
    /// Custom tab title format.
    /// Supports placeholders: {name}, {cwd}, {cwdFull}, {process}, {shell}, {user}, {host}
    /// </summary>
    public string? TabTitleFormat { get; set; }

    // === Profile Metadata ===

    /// <summary>
    /// Whether this is the default profile for new terminals.
    /// </summary>
    public bool IsDefault { get; set; }

    /// <summary>
    /// Whether this profile is hidden from the shell selector dropdown.
    /// </summary>
    public bool IsHidden { get; set; }

    /// <summary>
    /// Whether this is a built-in system profile (read-only, cannot be deleted).
    /// </summary>
    public bool IsBuiltIn { get; init; }

    /// <summary>
    /// Sort order in the shell selector (lower = higher priority).
    /// </summary>
    public int SortOrder { get; set; }

    /// <summary>
    /// Timestamp when this profile was created.
    /// </summary>
    public DateTime CreatedAt { get; init; } = DateTime.UtcNow;

    /// <summary>
    /// Timestamp when this profile was last modified.
    /// </summary>
    public DateTime ModifiedAt { get; set; } = DateTime.UtcNow;

    // === Methods ===

    /// <summary>
    /// Creates a deep copy of this profile with a new ID.
    /// The copy is marked as a user profile (not built-in) and not default.
    /// </summary>
    /// <returns>A new ShellProfile instance with copied settings.</returns>
    public ShellProfile Clone()
    {
        return new ShellProfile
        {
            // New identity
            Name = $"{Name} (Copy)",
            IconPath = IconPath,
            AccentColor = AccentColor,

            // Shell configuration (copied)
            ShellPath = ShellPath,
            ShellType = ShellType,
            Arguments = Arguments,
            StartingDirectory = StartingDirectory,
            StartupCommand = StartupCommand,
            Environment = new Dictionary<string, string>(Environment),

            // Appearance (copied)
            FontFamily = FontFamily,
            FontSize = FontSize,
            ThemeName = ThemeName,
            CursorStyle = CursorStyle,
            CursorBlink = CursorBlink,
            ScrollbackLines = ScrollbackLines,

            // Behavior (copied)
            CloseOnExit = CloseOnExit,
            BellStyle = BellStyle,
            TabTitleFormat = TabTitleFormat,

            // Metadata (modified for copy)
            IsDefault = false,           // Copies are never default
            IsHidden = IsHidden,          // Preserve hidden state
            IsBuiltIn = false,            // Copies are user profiles
            SortOrder = SortOrder + 1     // Place after original
        };
    }

    /// <summary>
    /// Validates that the profile has the minimum required configuration.
    /// </summary>
    /// <returns>True if the profile is valid.</returns>
    [JsonIgnore]
    public bool IsValid => !string.IsNullOrWhiteSpace(ShellPath) &&
                           !string.IsNullOrWhiteSpace(Name);
}
```

### 7. AppSettings Extension

**File to Modify**: `src/AIntern.Core/Models/AppSettings.cs`

Add the following properties to the existing `AppSettings` class:

```csharp
// === Terminal Settings (v0.5.3) ===

/// <summary>
/// Default terminal font family.
/// </summary>
public string TerminalFontFamily { get; set; } = "Cascadia Mono, Consolas, monospace";

/// <summary>
/// Default terminal font size in points.
/// </summary>
public double TerminalFontSize { get; set; } = 14;

/// <summary>
/// Number of scrollback lines to retain.
/// </summary>
public int TerminalScrollbackLines { get; set; } = 10000;

/// <summary>
/// Terminal bell notification style.
/// </summary>
public TerminalBellStyle TerminalBellStyle { get; set; } = TerminalBellStyle.Audible;

/// <summary>
/// Terminal cursor style.
/// </summary>
public TerminalCursorStyle TerminalCursorStyle { get; set; } = TerminalCursorStyle.Block;

/// <summary>
/// Whether the terminal cursor blinks.
/// </summary>
public bool TerminalCursorBlink { get; set; } = true;

/// <summary>
/// Terminal color theme name.
/// </summary>
public string TerminalTheme { get; set; } = "Dark";

/// <summary>
/// Height of the terminal panel when docked (in pixels).
/// </summary>
public double TerminalPanelHeight { get; set; } = 300;

/// <summary>
/// Characters that separate words for double-click selection.
/// </summary>
public string TerminalWordSeparators { get; set; } = " ()[]{}|;:'\",.<>/?!@#$%^&*-=+~`";

/// <summary>
/// Whether to copy selected text immediately on selection.
/// </summary>
public bool TerminalCopyOnSelect { get; set; } = false;

/// <summary>
/// Keyboard shortcut to toggle the terminal panel.
/// </summary>
public string TerminalToggleShortcut { get; set; } = "Ctrl+`";

/// <summary>
/// Keyboard shortcut to create a new terminal tab.
/// </summary>
public string TerminalNewShortcut { get; set; } = "Ctrl+Shift+`";

/// <summary>
/// Whether to sync terminal working directory with the active workspace.
/// </summary>
public bool SyncTerminalWithWorkspace { get; set; } = true;

/// <summary>
/// Mode for terminal/workspace directory synchronization.
/// </summary>
public DirectorySyncMode TerminalSyncMode { get; set; } = DirectorySyncMode.ActiveTerminalOnly;

/// <summary>
/// ID of the default shell profile.
/// </summary>
public Guid? DefaultShellProfileId { get; set; }

/// <summary>
/// Whether to show the terminal panel on application startup.
/// </summary>
public bool ShowTerminalOnStartup { get; set; } = false;

/// <summary>
/// Whether to restore terminal sessions from the previous session.
/// </summary>
public bool RestoreTerminalSessions { get; set; } = false;
```

---

## JSON Serialization

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                        ShellProfile JSON Format                               │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Example serialized profile:                                                 │
│                                                                              │
│  {                                                                           │
│    "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",                            │
│    "name": "My PowerShell",                                                  │
│    "shellPath": "C:\\Program Files\\PowerShell\\7\\pwsh.exe",                │
│    "shellType": "PowerShell",                                                │
│    "arguments": "-NoLogo",                                                   │
│    "startingDirectory": "C:\\Users\\ryan\\projects",                         │
│    "startupCommand": null,                                                   │
│    "environment": {                                                          │
│      "MYVAR": "value"                                                        │
│    },                                                                        │
│    "fontFamily": "JetBrains Mono",                                          │
│    "fontSize": 12,                                                           │
│    "themeName": "One Dark",                                                  │
│    "cursorStyle": "Bar",                                                     │
│    "cursorBlink": true,                                                      │
│    "scrollbackLines": 5000,                                                  │
│    "closeOnExit": "OnCleanExit",                                            │
│    "bellStyle": "Visual",                                                    │
│    "tabTitleFormat": "{name}: {cwd}",                                       │
│    "iconPath": null,                                                         │
│    "accentColor": "#0078D4",                                                │
│    "isDefault": true,                                                        │
│    "isHidden": false,                                                        │
│    "isBuiltIn": false,                                                       │
│    "sortOrder": 0,                                                           │
│    "createdAt": "2026-01-15T10:30:00Z",                                     │
│    "modifiedAt": "2026-01-17T08:45:00Z"                                     │
│  }                                                                           │
│                                                                              │
│  Notes:                                                                      │
│  - Enums serialize as strings (e.g., "PowerShell", "Bar", "OnCleanExit")    │
│  - Null values are explicitly serialized to distinguish "use default"       │
│  - DateTime in UTC ISO 8601 format                                           │
│  - Environment is a flat string-to-string dictionary                        │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## File Summary

| File | Location | Purpose |
|------|----------|---------|
| `TerminalCursorStyle.cs` | `src/AIntern.Core/Models/Terminal/` | Cursor style enumeration |
| `ProfileCloseOnExit.cs` | `src/AIntern.Core/Models/Terminal/` | Close behavior enumeration |
| `TerminalBellStyle.cs` | `src/AIntern.Core/Models/Terminal/` | Bell style enumeration |
| `DirectorySyncMode.cs` | `src/AIntern.Core/Models/Terminal/` | Directory sync mode enumeration |
| `ShellProfileDefaults.cs` | `src/AIntern.Core/Models/Terminal/` | Default profile values |
| `ShellProfile.cs` | `src/AIntern.Core/Models/Terminal/` | Main profile model |

### Files to Modify

| File | Changes |
|------|---------|
| `src/AIntern.Core/Models/AppSettings.cs` | Add terminal settings properties |

---

## Unit Test Plan

| Test | Description |
|------|-------------|
| `ShellProfile_DefaultValues_AreCorrect` | Verify defaults match specification |
| `ShellProfile_Clone_CreatesNewId` | Clone generates new GUID |
| `ShellProfile_Clone_CopiesSettings` | All relevant settings preserved |
| `ShellProfile_Clone_DeepCopiesEnvironment` | Environment dict is independent |
| `ShellProfile_Clone_SetsNotDefault` | IsDefault is false on clone |
| `ShellProfile_Clone_SetsNotBuiltIn` | IsBuiltIn is false on clone |
| `ShellProfile_Clone_IncrementsName` | Name includes "(Copy)" suffix |
| `ShellProfile_IsValid_RequiresShellPath` | Empty ShellPath = invalid |
| `ShellProfile_IsValid_RequiresName` | Empty Name = invalid |
| `ShellProfile_Serialize_RoundTrip` | JSON serialize/deserialize |
| `ShellProfile_Serialize_PreservesNulls` | Null overrides preserved |
| `ShellProfileDefaults_HasCorrectValues` | Verify default values |
| `TerminalCursorStyle_AllValuesExist` | Block, Underline, Bar |
| `ProfileCloseOnExit_AllValuesExist` | Always, OnCleanExit, Never |
| `TerminalBellStyle_AllValuesExist` | Audible, Visual, Both, None |
| `DirectorySyncMode_AllValuesExist` | ActiveTerminalOnly, AllLinkedTerminals, Manual |

**Total Tests**: 16

---

## Verification

```bash
# Verify models compile
dotnet build src/AIntern.Core

# Run unit tests
dotnet test --filter "ShellProfile"

# Verify JSON serialization works
dotnet test --filter "Serialize"
```

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | `ShellProfile` can be serialized and deserialized to/from JSON |
| AC-2 | `ShellProfile.Clone()` creates a proper deep copy with new ID |
| AC-3 | All enumeration values are defined correctly |
| AC-4 | `AppSettings` serialization includes all new terminal properties |
| AC-5 | Default values are reasonable for all platforms |
| AC-6 | `ShellProfile.IsValid` correctly validates required fields |
| AC-7 | Nullable appearance overrides properly indicate "use default" |
| AC-8 | Environment dictionary deep-copies on Clone |

---

## Changelog Entry

```markdown
## v0.5.3c - Shell Profile Models

### Added
- `ShellProfile` model for user-configurable terminal profiles with:
  - Identity: Id, Name, IconPath, AccentColor
  - Shell config: ShellPath, ShellType, Arguments, StartingDirectory, StartupCommand, Environment
  - Appearance overrides: FontFamily, FontSize, ThemeName, CursorStyle, CursorBlink, ScrollbackLines
  - Behavior: CloseOnExit, BellStyle, TabTitleFormat
  - Metadata: IsDefault, IsHidden, IsBuiltIn, SortOrder, CreatedAt, ModifiedAt
  - Clone() method for profile duplication
  - IsValid property for validation

- `TerminalCursorStyle` enumeration (Block, Underline, Bar)
- `ProfileCloseOnExit` enumeration (Always, OnCleanExit, Never)
- `TerminalBellStyle` enumeration (Audible, Visual, Both, None)
- `DirectorySyncMode` enumeration (ActiveTerminalOnly, AllLinkedTerminals, Manual)
- `ShellProfileDefaults` model for effective settings resolution

### Changed
- Extended `AppSettings` with terminal settings:
  - Font settings (TerminalFontFamily, TerminalFontSize)
  - Cursor settings (TerminalCursorStyle, TerminalCursorBlink)
  - Behavior settings (TerminalBellStyle, TerminalScrollbackLines)
  - Appearance (TerminalTheme)
  - Panel settings (TerminalPanelHeight, ShowTerminalOnStartup)
  - Selection behavior (TerminalCopyOnSelect, TerminalWordSeparators)
  - Keyboard shortcuts (TerminalToggleShortcut, TerminalNewShortcut)
  - Sync settings (SyncTerminalWithWorkspace, TerminalSyncMode)
  - Profile reference (DefaultShellProfileId)
  - Session restoration (RestoreTerminalSessions)
```

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.5.3c | 0.5 day |
