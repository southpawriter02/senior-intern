# Design Specification: The Senior Intern v0.2.3e "Settings Panel UI"

## Executive Summary

This document provides a detailed implementation specification for v0.2.3e, which creates the complete `InferenceSettingsPanel` UI with preset dropdown, parameter sliders, save preset dialog, and integration into the MainWindow. This is the final UI layer that ties together all v0.2.3 components.

### v0.2.3e Scope (from v0.2.3 Design Document)

- Create `InferenceSettingsPanel.axaml` with preset dropdown and parameter sliders
- Create `SavePresetDialog` for naming new presets
- Create converters for UI bindings
- Integrate settings panel into MainWindow sidebar
- Update MainWindowViewModel with InferenceSettingsViewModel
- Update status bar to show current preset/temperature
- Update LlmService to use current inference options
- Complete DI registration

### Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| InferenceSettingsPanel | Complete settings panel view |
| SavePresetDialog | Dialog for saving custom presets |
| Converters | BoolToFontWeight, ExpandIcon |
| MainWindow Integration | Sidebar and status bar updates |
| LlmService Integration | Use inference options in generation |

---

## Feature Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     v0.2.3e Feature Tree                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  InferenceSettingsPanel                                           â”‚
â”‚  â”œâ”€â”€ Header Row                                                   â”‚
â”‚  â”‚   â”œâ”€â”€ Expand/Collapse button                                   â”‚
â”‚  â”‚   â”œâ”€â”€ "Inference Settings" title                               â”‚
â”‚  â”‚   â”œâ”€â”€ Reset to Defaults button                                 â”‚
â”‚  â”‚   â””â”€â”€ Save as Preset button (visible when modified)            â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Preset Selector Row                                          â”‚
â”‚  â”‚   â”œâ”€â”€ ComboBox with preset items                               â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Built-in badge (for built-in presets)                â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Name and parameter summary                           â”‚
â”‚  â”‚   â”‚   â””â”€â”€ Default star indicator                               â”‚
â”‚  â”‚   â””â”€â”€ "Modified" badge (when HasUnsavedChanges)                â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Primary Sliders                                              â”‚
â”‚  â”‚   â”œâ”€â”€ Temperature (0-2, step 0.1)                              â”‚
â”‚  â”‚   â”œâ”€â”€ Top-P (0-1, step 0.05)                                   â”‚
â”‚  â”‚   â”œâ”€â”€ Max Tokens (64-8192, step 64)                            â”‚
â”‚  â”‚   â””â”€â”€ Context Size (512-32768, step 512)                       â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Advanced Section (Expander)                                  â”‚
â”‚  â”‚   â”œâ”€â”€ Repetition Penalty (1-2, step 0.05)                      â”‚
â”‚  â”‚   â””â”€â”€ Top-K (0-100, step 5)                                    â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ Error Message (conditional)                                  â”‚
â”‚                                                                   â”‚
â”‚  SavePresetDialog                                                 â”‚
â”‚  â”œâ”€â”€ Name input (required)                                        â”‚
â”‚  â”œâ”€â”€ Description input (optional, multiline)                      â”‚
â”‚  â”œâ”€â”€ Error message display                                        â”‚
â”‚  â””â”€â”€ Cancel / Save buttons                                        â”‚
â”‚                                                                   â”‚
â”‚  MainWindow Integration                                           â”‚
â”‚  â”œâ”€â”€ Sidebar: Add InferenceSettingsPanel below ModelSelector      â”‚
â”‚  â””â”€â”€ Status Bar: Show preset name and temperature                 â”‚
â”‚                                                                   â”‚
â”‚  LlmService Integration                                           â”‚
â”‚  â””â”€â”€ GenerateStreamingAsync uses CurrentOptions from service      â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Diagrams

### Panel Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   InferenceSettingsPanel Layout                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Border (PanelBackgroundColor, CornerRadius=8, Padding=12)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Grid (RowDefinitions="Auto,Auto,*,Auto")                   â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚ Row 0: Header                                              â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ [â–¼] Inference Settings                    [â†º] [ğŸ’¾]    â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚ Row 1: Preset Selector                                     â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ [â–¾ Balanced                              â–¼] [Modified] â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚ Row 2: Parameter Sliders                                   â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ Temperature                              [ 0.7 ]       â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ Balanced creativity and consistency                    â”‚ â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚ â”‚ Top-P                                    [ 0.90 ]      â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ Considers top 90% probability mass                     â”‚ â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚ â”‚ Max Response Tokens                      [ 2048 ]      â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ ~1536 words maximum                                    â”‚ â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚ â”‚ Context Window Size                      [ 4096 ]      â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ â•â•â•â•â•â•â•â•â•â—â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚ â”‚  â”‚
â”‚  â”‚ â”‚ ~3072 words of history                                 â”‚ â”‚  â”‚
â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚
â”‚  â”‚ â”‚ â–¶ Advanced                                             â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚ Row 3: Error Message (conditional)                         â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚ âš  Error message text                                   â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Integration into MainWindow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MainWindow Layout Update                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  SplitView                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚        Pane (Sidebar)     â”‚         Content                  â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                  â”‚â”‚
â”‚  â”‚ â”‚  ModelSelectorView    â”‚ â”‚                                  â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                  â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                  â”‚â”‚
â”‚  â”‚ â”‚InferenceSettingsPanel â”‚ â”‚                                  â”‚â”‚
â”‚  â”‚ â”‚ (NEW - v0.2.3e)       â”‚ â”‚           ChatView               â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                  â”‚â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                  â”‚â”‚
â”‚  â”‚ â”‚ConversationListView   â”‚ â”‚                                  â”‚â”‚
â”‚  â”‚ â”‚                       â”‚ â”‚                                  â”‚â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Status Bar                                                   â”‚â”‚
â”‚  â”‚ Model: Mistral-7B | Preset: Balanced | T:0.7 | Saved        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Directory Structure

```
src/SeniorIntern.Desktop/
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ InferenceSettingsPanel.axaml                  (NEW)
â”‚   â”œâ”€â”€ InferenceSettingsPanel.axaml.cs               (NEW)
â”‚   â””â”€â”€ MainWindow.axaml                              (UPDATE)
â”œâ”€â”€ Dialogs/
â”‚   â”œâ”€â”€ SavePresetDialog.axaml                        (NEW)
â”‚   â””â”€â”€ SavePresetDialog.axaml.cs                     (NEW)
â”œâ”€â”€ Converters/
â”‚   â”œâ”€â”€ BoolToFontWeightConverter.cs                  (NEW)
â”‚   â””â”€â”€ ExpandIconConverter.cs                        (NEW)
â”œâ”€â”€ ViewModels/
â”‚   â””â”€â”€ MainWindowViewModel.cs                        (UPDATE)
â””â”€â”€ Extensions/
    â””â”€â”€ ServiceCollectionExtensions.cs                (UPDATE)

src/SeniorIntern.Services/
â””â”€â”€ LlmService.cs                                     (UPDATE)
```

---

## Implementation Details

### Task 1: Create InferenceSettingsPanel

**File:** `src/SeniorIntern.Desktop/Views/InferenceSettingsPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:controls="using:SeniorIntern.Desktop.Controls"
             x:Class="SeniorIntern.Desktop.Views.InferenceSettingsPanel"
             x:DataType="vm:InferenceSettingsViewModel">

    <Border Background="{DynamicResource PanelBackgroundColor}"
            CornerRadius="8" Padding="12" Margin="12,8">

        <Grid RowDefinitions="Auto,Auto,*,Auto">
            <!-- Header -->
            <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,12">
                <Button Classes="icon-button" Command="{Binding ToggleExpandedCommand}">
                    <PathIcon Data="{Binding IsExpanded, Converter={StaticResource ExpandIconConverter}}"
                              Width="12" Height="12" />
                </Button>
                <TextBlock Grid.Column="1" Text="Inference Settings"
                           FontWeight="Bold" FontSize="14" Margin="8,0,0,0" />
                <StackPanel Grid.Column="2" Orientation="Horizontal" Spacing="4">
                    <Button Classes="icon-button small" Command="{Binding ResetToDefaultsCommand}"
                            ToolTip.Tip="Reset to Defaults">
                        <PathIcon Data="{StaticResource ResetIcon}" Width="14" Height="14" />
                    </Button>
                    <Button Classes="icon-button small" Command="{Binding SaveAsPresetCommand}"
                            ToolTip.Tip="Save as Preset" IsVisible="{Binding HasUnsavedChanges}">
                        <PathIcon Data="{StaticResource SaveIcon}" Width="14" Height="14" />
                    </Button>
                </StackPanel>
            </Grid>

            <!-- Preset Selector -->
            <Grid Grid.Row="1" ColumnDefinitions="*,Auto" Margin="0,0,0,12"
                  IsVisible="{Binding IsExpanded}">
                <ComboBox ItemsSource="{Binding Presets}" SelectedItem="{Binding SelectedPreset}"
                          ItemTemplate="{StaticResource PresetItemTemplate}" MaxDropDownHeight="300" />
                <Border Grid.Column="1" IsVisible="{Binding HasUnsavedChanges}"
                        Background="{DynamicResource WarningBackgroundColor}"
                        CornerRadius="4" Padding="6,2" Margin="8,0,0,0">
                    <TextBlock Text="Modified" FontSize="10" />
                </Border>
            </Grid>

            <!-- Parameter Sliders -->
            <StackPanel Grid.Row="2" Spacing="4" IsVisible="{Binding IsExpanded}">
                <controls:ParameterSlider Label="Temperature" Value="{Binding Temperature}"
                    Minimum="0" Maximum="2" Step="0.1" Description="{Binding TemperatureDescription}" />
                <controls:ParameterSlider Label="Top-P" Value="{Binding TopP}"
                    Minimum="0" Maximum="1" Step="0.05" ValueFormat="F2" Description="{Binding TopPDescription}" />
                <controls:ParameterSlider Label="Max Response Tokens" Value="{Binding MaxTokens}"
                    Minimum="64" Maximum="8192" Step="64" IsInteger="True" Description="{Binding MaxTokensDescription}" />
                <controls:ParameterSlider Label="Context Window Size" Value="{Binding ContextSize}"
                    Minimum="512" Maximum="32768" Step="512" IsInteger="True" Description="{Binding ContextSizeDescription}" />

                <!-- Advanced Section -->
                <Expander Header="Advanced" IsExpanded="{Binding ShowAdvanced}" Margin="0,8,0,0">
                    <StackPanel Spacing="4" Margin="0,8,0,0">
                        <controls:ParameterSlider Label="Repetition Penalty" Value="{Binding RepetitionPenalty}"
                            Minimum="1" Maximum="2" Step="0.05" ValueFormat="F2" Description="{Binding RepetitionPenaltyDescription}" />
                        <controls:ParameterSlider Label="Top-K" Value="{Binding TopK}"
                            Minimum="0" Maximum="100" Step="5" IsInteger="True" Description="{Binding TopKDescription}" />
                    </StackPanel>
                </Expander>
            </StackPanel>

            <!-- Error Message -->
            <Border Grid.Row="3" IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                    Background="{DynamicResource ErrorBackgroundColor}" Padding="8,4" CornerRadius="4" Margin="0,8,0,0">
                <TextBlock Text="{Binding ErrorMessage}" Foreground="{DynamicResource ErrorForegroundColor}" FontSize="11" />
            </Border>
        </Grid>
    </Border>
</UserControl>
```

---

### Task 2: Create SavePresetDialog

**File:** `src/SeniorIntern.Desktop/Dialogs/SavePresetDialog.axaml`

```xml
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
        x:Class="SeniorIntern.Desktop.Dialogs.SavePresetDialog"
        x:DataType="vm:SavePresetDialogViewModel"
        Title="Save Preset" Width="400" SizeToContent="Height"
        WindowStartupLocation="CenterOwner" CanResize="False">

    <Grid Margin="20" RowDefinitions="Auto,Auto,Auto,Auto">
        <!-- Name -->
        <StackPanel Grid.Row="0" Spacing="4">
            <TextBlock Text="Preset Name" FontWeight="SemiBold" />
            <TextBox Text="{Binding Name}" Watermark="Enter a name for this preset" />
        </StackPanel>

        <!-- Description -->
        <StackPanel Grid.Row="1" Spacing="4" Margin="0,12,0,0">
            <TextBlock Text="Description (Optional)" />
            <TextBox Text="{Binding Description}" Watermark="Brief description"
                     AcceptsReturn="True" TextWrapping="Wrap" Height="60" />
        </StackPanel>

        <!-- Error Message -->
        <Border Grid.Row="2" IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                Background="{DynamicResource ErrorBackgroundColor}" Padding="8,4" CornerRadius="4" Margin="0,12,0,0">
            <TextBlock Text="{Binding ErrorMessage}" Foreground="{DynamicResource ErrorForegroundColor}" FontSize="12" />
        </Border>

        <!-- Buttons -->
        <StackPanel Grid.Row="3" Orientation="Horizontal" HorizontalAlignment="Right" Spacing="8" Margin="0,20,0,0">
            <Button Content="Cancel" Command="{Binding CancelCommand}" MinWidth="80" />
            <Button Content="Save" Command="{Binding SaveCommand}" Classes="accent" MinWidth="80" />
        </StackPanel>
    </Grid>
</Window>
```

**File:** `src/SeniorIntern.Desktop/Dialogs/SavePresetDialog.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Dialogs;

using Avalonia.Controls;
using SeniorIntern.Desktop.ViewModels;

public partial class SavePresetDialog : Window
{
    public SavePresetDialog()
    {
        InitializeComponent();
    }

    public static async Task<(bool success, string name, string? description)> ShowAsync(Window owner)
    {
        var viewModel = new SavePresetDialogViewModel();
        var dialog = new SavePresetDialog { DataContext = viewModel };

        viewModel.CloseRequested += (s, result) => dialog.Close(result);

        var result = await dialog.ShowDialog<bool>(owner);
        return (result, viewModel.Name, viewModel.Description);
    }
}
```

---

### Task 3: Create Converters

**File:** `src/SeniorIntern.Desktop/Converters/BoolToFontWeightConverter.cs`

```csharp
namespace SeniorIntern.Desktop.Converters;

using Avalonia.Data.Converters;
using Avalonia.Media;

public class BoolToFontWeightConverter : IValueConverter
{
    public object Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        return value is true ? FontWeight.Bold : FontWeight.Normal;
    }

    public object ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotSupportedException();
}
```

**File:** `src/SeniorIntern.Desktop/Converters/ExpandIconConverter.cs`

```csharp
namespace SeniorIntern.Desktop.Converters;

using Avalonia.Data.Converters;
using Avalonia.Media;

public class ExpandIconConverter : IValueConverter
{
    public static readonly StreamGeometry ExpandedIcon = StreamGeometry.Parse("M19 9l-7 7-7-7");
    public static readonly StreamGeometry CollapsedIcon = StreamGeometry.Parse("M9 5l7 7-7 7");

    public object Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        return value is true ? ExpandedIcon : CollapsedIcon;
    }

    public object ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
        => throw new NotSupportedException();
}
```

---

### Task 4: Update MainWindow

**File:** `src/SeniorIntern.Desktop/Views/MainWindow.axaml` (update sidebar)

```xml
<SplitView.Pane>
    <Border Background="{DynamicResource SidebarBackgroundColor}">
        <Grid RowDefinitions="Auto,Auto,*">
            <!-- Model Selector -->
            <views:ModelSelectorView Grid.Row="0" DataContext="{Binding ModelSelectorViewModel}" />

            <!-- Inference Settings Panel (NEW) -->
            <views:InferenceSettingsPanel Grid.Row="1" DataContext="{Binding InferenceSettingsViewModel}" />

            <!-- Conversation List -->
            <views:ConversationListView Grid.Row="2" DataContext="{Binding ConversationListViewModel}" />
        </Grid>
    </Border>
</SplitView.Pane>
```

**Status bar update:**

```xml
<Border Grid.Row="2" Background="{DynamicResource StatusBarBackgroundColor}" Padding="12,4">
    <Grid ColumnDefinitions="*,Auto,Auto,Auto">
        <TextBlock Text="{Binding ModelSelectorViewModel.CurrentModelName, StringFormat='Model: {0}'}"
                   FontSize="11" Foreground="{DynamicResource TextSecondaryColor}" />
        <TextBlock Grid.Column="1" FontSize="11" Foreground="{DynamicResource TextSecondaryColor}" Margin="16,0,0,0"
                   Text="{Binding InferenceSettingsViewModel.SelectedPreset.Name, StringFormat='Preset: {0}'}" />
        <TextBlock Grid.Column="2" FontSize="11" Foreground="{DynamicResource TextTertiaryColor}" Margin="16,0,0,0"
                   Text="{Binding InferenceSettingsViewModel.Temperature, StringFormat='T:{0:F1}'}" />
        <TextBlock Grid.Column="3" FontSize="11" Foreground="{DynamicResource TextSecondaryColor}" Margin="16,0,0,0"
                   Text="{Binding ChatViewModel.SaveStatus}" />
    </Grid>
</Border>
```

---

### Task 5: Update MainWindowViewModel

```csharp
[ObservableProperty]
private InferenceSettingsViewModel _inferenceSettingsViewModel;

public MainWindowViewModel(
    ChatViewModel chatViewModel,
    ConversationListViewModel conversationListViewModel,
    ModelSelectorViewModel modelSelectorViewModel,
    InferenceSettingsViewModel inferenceSettingsViewModel)
{
    _chatViewModel = chatViewModel;
    _conversationListViewModel = conversationListViewModel;
    _modelSelectorViewModel = modelSelectorViewModel;
    _inferenceSettingsViewModel = inferenceSettingsViewModel;
}

public async Task InitializeAsync()
{
    await _conversationListViewModel.InitializeAsync();
    await _inferenceSettingsViewModel.InitializeAsync();
}
```

---

### Task 6: Update LlmService

```csharp
public sealed class LlmService : ILlmService
{
    private readonly IInferenceSettingsService _inferenceSettings;

    public LlmService(IInferenceSettingsService inferenceSettings, /* ... */)
    {
        _inferenceSettings = inferenceSettings;
    }

    public async IAsyncEnumerable<string> GenerateStreamingAsync(
        IEnumerable<ChatMessage> conversation,
        InferenceOptions? optionsOverride,
        [EnumeratorCancellation] CancellationToken ct = default)
    {
        var options = optionsOverride ?? _inferenceSettings.CurrentOptions;

        var inferParams = new InferenceParams
        {
            Temperature = options.Temperature,
            TopP = options.TopP,
            MaxTokens = options.MaxTokens,
            RepeatPenalty = options.RepetitionPenalty,
            TopK = options.TopK
        };

        // ... inference logic
    }
}
```

---

### Task 7: Update DI Registration

```csharp
// Inference settings (add to existing)
services.AddSingleton<IInferencePresetRepository, InferencePresetRepository>();
services.AddSingleton<IInferenceSettingsService, InferenceSettingsService>();
services.AddSingleton<InferenceSettingsViewModel>();
services.AddTransient<SavePresetDialogViewModel>();
```

---

## Unit Testing Requirements

| Component | Test Count | Focus Areas |
|-----------|------------|-------------|
| InferenceSettingsPanel | 4 | Layout, bindings |
| SavePresetDialog | 3 | Validation, dialog result |
| Converters | 4 | BoolToFontWeight, ExpandIcon |
| Integration | 3 | MainWindow, LlmService |
| **Total** | **14** | |

---

## Files Summary

### Files to Create (6)

| File | Lines (approx) |
|------|----------------|
| `Views/InferenceSettingsPanel.axaml` | 100 |
| `Views/InferenceSettingsPanel.axaml.cs` | 10 |
| `Dialogs/SavePresetDialog.axaml` | 40 |
| `Dialogs/SavePresetDialog.axaml.cs` | 25 |
| `Converters/BoolToFontWeightConverter.cs` | 15 |
| `Converters/ExpandIconConverter.cs` | 20 |

### Files to Modify (4)

| File | Changes |
|------|---------|
| `Views/MainWindow.axaml` | Add panel to sidebar, update status bar |
| `ViewModels/MainWindowViewModel.cs` | Add InferenceSettingsViewModel |
| `Extensions/ServiceCollectionExtensions.cs` | Register services |
| `Services/LlmService.cs` | Use inference settings |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | Settings panel displays in sidebar |
| AC-2 | Preset dropdown shows all presets |
| AC-3 | Built-in badge displays on built-in presets |
| AC-4 | "Modified" badge shows when settings differ |
| AC-5 | All 6 sliders bind and update correctly |
| AC-6 | Advanced section expands/collapses |
| AC-7 | Save preset dialog opens and validates |
| AC-8 | Status bar shows current preset and temperature |
| AC-9 | LlmService uses CurrentOptions |
| AC-10 | Panel collapses when IsExpanded=false |

---

## Design Decisions

| Decision | Rationale |
|----------|-----------|
| Panel in sidebar | Accessible during chat, doesn't take main space |
| Advanced section collapsed | Less overwhelming, power users can expand |
| SavePresetDialog static helper | Simple API for showing dialog |
| Status bar shows T value | Quick reference without opening panel |
| InferenceSettingsViewModel singleton | Shared state across app |

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.2.3e | 1 day |
