# Design Specification: AIntern v0.2.2c "Conversation List UI"

## Executive Summary

This document provides a detailed implementation specification for v0.2.2c, which creates the ConversationListView user control - the visual sidebar component for browsing, searching, and managing conversations. This view implements date-based grouping with collapsible sections, inline renaming, context menus, and keyboard navigation.

v0.2.2c transforms the ViewModel layer (v0.2.2b) into a polished, interactive user interface that provides the primary navigation experience for the application.

### v0.2.2c Scope (from v0.2.2 Design Document)

- Create `ConversationListView.axaml` with full XAML layout
- Create `ConversationListView.axaml.cs` with event handlers
- Create `PinTextConverter` for "Pin"/"Unpin" toggle text
- Define conversation item and group header data templates
- Add context menu with Rename, Pin/Unpin, Archive, Delete actions
- Implement loading indicator, empty state, and error display
- Add hover, selected, and pinned visual states via styles
- Support keyboard navigation (Enter to confirm rename, Escape to cancel)

### Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| ConversationListView.axaml | Full XAML layout with templates and bindings |
| ConversationListView.axaml.cs | Code-behind with keyboard/pointer event handlers |
| PinTextConverter | IValueConverter for "Pin"/"Unpin" menu text |
| Conversation List Styles | Hover, selected, inline-edit, icon-button styles |
| Icon Resources | PathIcon data for Pin, Search, Chat, Edit, Delete, etc. |

---

## Feature Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     v0.2.2c Feature Tree                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  ConversationListView                                             â”‚
â”‚  â”œâ”€â”€ Header Section                                               â”‚
â”‚  â”‚   â”œâ”€â”€ "Conversations" title label                              â”‚
â”‚  â”‚   â””â”€â”€ [+] New Conversation button (icon, Ctrl+N tooltip)       â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Search Section                                               â”‚
â”‚  â”‚   â”œâ”€â”€ Search icon                                              â”‚
â”‚  â”‚   â”œâ”€â”€ TextBox with watermark                                   â”‚
â”‚  â”‚   â”œâ”€â”€ Clear [Ã—] button (visible when text present)             â”‚
â”‚  â”‚   â””â”€â”€ Escape key to clear                                      â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Content Area (ScrollViewer)                                  â”‚
â”‚  â”‚   â”œâ”€â”€ Loading State                                            â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ ProgressRing                                         â”‚
â”‚  â”‚   â”‚   â””â”€â”€ "Loading..." text                                    â”‚
â”‚  â”‚   â”‚                                                            â”‚
â”‚  â”‚   â”œâ”€â”€ Empty State                                              â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Chat icon (large)                                    â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ "No conversations yet" message                       â”‚
â”‚  â”‚   â”‚   â””â”€â”€ "New Conversation" button                            â”‚
â”‚  â”‚   â”‚                                                            â”‚
â”‚  â”‚   â””â”€â”€ Grouped List                                             â”‚
â”‚  â”‚       â”œâ”€â”€ Today (Expander)                                     â”‚
â”‚  â”‚       â”‚   â””â”€â”€ ConversationItem[]                               â”‚
â”‚  â”‚       â”œâ”€â”€ Yesterday (Expander)                                 â”‚
â”‚  â”‚       â”‚   â””â”€â”€ ConversationItem[]                               â”‚
â”‚  â”‚       â””â”€â”€ Previous 7 Days, 30 Days, Older...                   â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Conversation Item Template                                   â”‚
â”‚  â”‚   â”œâ”€â”€ Pin indicator (if pinned)                                â”‚
â”‚  â”‚   â”œâ”€â”€ Title (or inline TextBox if renaming)                    â”‚
â”‚  â”‚   â”œâ”€â”€ Relative time ("2m ago")                                 â”‚
â”‚  â”‚   â”œâ”€â”€ Preview text (truncated)                                 â”‚
â”‚  â”‚   â”œâ”€â”€ Message count                                            â”‚
â”‚  â”‚   â””â”€â”€ Context Menu                                             â”‚
â”‚  â”‚       â”œâ”€â”€ Rename                                               â”‚
â”‚  â”‚       â”œâ”€â”€ Pin/Unpin                                            â”‚
â”‚  â”‚       â”œâ”€â”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€                                            â”‚
â”‚  â”‚       â”œâ”€â”€ Archive                                              â”‚
â”‚  â”‚       â””â”€â”€ Delete (destructive)                                 â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ Error Banner                                                 â”‚
â”‚      â””â”€â”€ Error message (slides in at bottom)                      â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Diagrams

### UI Layout Structure

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Conversations                                    [+] New       â”‚ Row 0: Header
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ğŸ” Search conversations...                          [Ã—]   â”‚  â”‚ Row 1: Search
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â–¾ Today                                                    (2) â”‚ Row 2: Content
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ (ScrollViewer)
â”‚  â”‚ ğŸ“Œ API refactoring help                            2m ago â”‚  â”‚
â”‚  â”‚    Help me refactor the authentication API...             â”‚  â”‚
â”‚  â”‚    3 messages                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Debug memory leak                               â— 1h ago  â”‚  â”‚ â† Selected
â”‚  â”‚    I'm seeing a memory leak in my service...              â”‚  â”‚
â”‚  â”‚    12 messages                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â–¾ Yesterday                                                (1) â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Project setup questions                          23h ago  â”‚  â”‚
â”‚  â”‚    How do I configure the build process...                â”‚  â”‚
â”‚  â”‚    8 messages                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â–¸ Previous 7 Days                                          (2) â”‚ â† Collapsed
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš  Failed to load conversations: Connection timeout          â”‚  â”‚ Error (overlay)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Visual State Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Conversation Item States                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚   NORMAL    â”‚ â† Default state                                 â”‚
â”‚  â”‚  (no bg)    â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚         â”‚                                                        â”‚
â”‚    PointerOver                                                   â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚   HOVER     â”‚ â† ControlHoverBackgroundColor                   â”‚
â”‚  â”‚  (light bg) â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚         â”‚                                                        â”‚
â”‚      Click                                                       â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚  SELECTED   â”‚ â† AccentBackgroundColor                         â”‚
â”‚  â”‚ (accent bg) â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚         â”‚                                                        â”‚
â”‚    PointerOver (while selected)                                  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚  SELECTED + â”‚ â† AccentHoverBackgroundColor                    â”‚
â”‚  â”‚   HOVER     â”‚                                                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚  Additional states:                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚   PINNED    â”‚ â† Shows ğŸ“Œ icon before title                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                 â”‚
â”‚  â”‚  RENAMING   â”‚ â† Title becomes editable TextBox                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                 â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Keyboard Navigation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Keyboard Navigation                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Search TextBox:                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Type text      â”‚ â”€â–º Triggers debounced search               â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Press Escape   â”‚ â”€â–º Clears search, shows all                â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                  â”‚
â”‚  Rename TextBox:                                                 â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Type new title â”‚ â”€â–º Updates EditingTitle                    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Press Enter    â”‚ â”€â–º Confirms rename, saves to DB            â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Press Escape   â”‚ â”€â–º Cancels rename, reverts to original     â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Focus leaves   â”‚ â”€â–º Auto-confirms rename                    â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                  â”‚
â”‚  Global (when implemented in MainWindow):                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Ctrl+N         â”‚ â”€â–º New conversation                        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                            â”‚
â”‚    â”‚ Ctrl+F         â”‚ â”€â–º Focus search box                        â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Prerequisites

Before implementing v0.2.2c, ensure:
- v0.2.1 is complete (Database foundation fully implemented)
- v0.2.2a is complete (DatabaseConversationService)
- v0.2.2b is complete (ViewModels)
- Solution builds successfully
- Existing theme system is in place (Dark.axaml)

---

## Directory Structure

After v0.2.2c implementation:

```
src/SeniorIntern.Desktop/
â”œâ”€â”€ SeniorIntern.Desktop.csproj
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ MainWindow.axaml                              (existing)
â”‚   â”œâ”€â”€ MainWindow.axaml.cs                           (existing)
â”‚   â”œâ”€â”€ ChatView.axaml                                (existing)
â”‚   â”œâ”€â”€ ChatView.axaml.cs                             (existing)
â”‚   â”œâ”€â”€ ConversationListView.axaml                    (NEW)
â”‚   â””â”€â”€ ConversationListView.axaml.cs                 (NEW)
â”œâ”€â”€ Converters/
â”‚   â”œâ”€â”€ BoolConverters.cs                             (existing)
â”‚   â””â”€â”€ PinTextConverter.cs                           (NEW)
â”œâ”€â”€ Themes/
â”‚   â””â”€â”€ Dark.axaml                                    (UPDATED)
â””â”€â”€ Assets/
    â””â”€â”€ Icons.axaml                                   (UPDATED - add icons)
```

---

## Implementation Details

### Task 1: Create PinTextConverter

**File:** `src/SeniorIntern.Desktop/Converters/PinTextConverter.cs`

Converts boolean IsPinned to "Unpin"/"Pin" menu text.

```csharp
namespace SeniorIntern.Desktop.Converters;

using Avalonia.Data.Converters;
using System.Globalization;

/// <summary>
/// Converts a boolean IsPinned value to appropriate menu text.
/// </summary>
public sealed class PinTextConverter : IValueConverter
{
    /// <summary>Singleton instance for XAML use.</summary>
    public static readonly PinTextConverter Instance = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is bool isPinned)
        {
            return isPinned ? "Unpin" : "Pin";
        }
        return "Pin";
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}
```

---

### Task 2: Add Icon Resources

**File:** `src/SeniorIntern.Desktop/Assets/Icons.axaml` (or within App.axaml Resources)

Add the following icon path data:

```xml
<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Conversation List Icons -->
    <StreamGeometry x:Key="PlusIcon">M12 5v14M5 12h14</StreamGeometry>
    <StreamGeometry x:Key="SearchIcon">M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z</StreamGeometry>
    <StreamGeometry x:Key="CloseIcon">M18 6L6 18M6 6l12 12</StreamGeometry>
    <StreamGeometry x:Key="ChatIcon">M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z</StreamGeometry>
    <StreamGeometry x:Key="PinIcon">M16 3h5v5M4 20L21 3M21 11v10H11</StreamGeometry>
    <StreamGeometry x:Key="EditIcon">M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z</StreamGeometry>
    <StreamGeometry x:Key="ArchiveIcon">M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4</StreamGeometry>
    <StreamGeometry x:Key="DeleteIcon">M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16</StreamGeometry>

</ResourceDictionary>
```

---

### Task 3: Create ConversationListView.axaml

**File:** `src/SeniorIntern.Desktop/Views/ConversationListView.axaml`

Full XAML implementation:

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:converters="using:SeniorIntern.Desktop.Converters"
             x:Class="SeniorIntern.Desktop.Views.ConversationListView"
             x:DataType="vm:ConversationListViewModel">

    <UserControl.Resources>
        <!-- Converters -->
        <converters:PinTextConverter x:Key="PinTextConverter" />

        <!-- Conversation Item Template -->
        <DataTemplate x:Key="ConversationItemTemplate" x:DataType="vm:ConversationSummaryViewModel">
            <Border Classes="conversation-item"
                    Classes.selected="{Binding IsSelected}"
                    Classes.pinned="{Binding IsPinned}"
                    Padding="12,8"
                    Margin="0,2"
                    CornerRadius="6"
                    Background="Transparent"
                    PointerPressed="OnConversationPointerPressed">

                <!-- Context Menu -->
                <Border.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Rename"
                                  Command="{Binding $parent[UserControl].((vm:ConversationListViewModel)DataContext).RenameConversationCommand}"
                                  CommandParameter="{Binding}">
                            <MenuItem.Icon>
                                <PathIcon Data="{StaticResource EditIcon}" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="{Binding IsPinned, Converter={StaticResource PinTextConverter}}"
                                  Command="{Binding $parent[UserControl].((vm:ConversationListViewModel)DataContext).TogglePinCommand}"
                                  CommandParameter="{Binding}">
                            <MenuItem.Icon>
                                <PathIcon Data="{StaticResource PinIcon}" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <Separator />
                        <MenuItem Header="Archive"
                                  Command="{Binding $parent[UserControl].((vm:ConversationListViewModel)DataContext).ArchiveConversationCommand}"
                                  CommandParameter="{Binding}">
                            <MenuItem.Icon>
                                <PathIcon Data="{StaticResource ArchiveIcon}" />
                            </MenuItem.Icon>
                        </MenuItem>
                        <MenuItem Header="Delete"
                                  Command="{Binding $parent[UserControl].((vm:ConversationListViewModel)DataContext).DeleteConversationCommand}"
                                  CommandParameter="{Binding}"
                                  Classes="destructive">
                            <MenuItem.Icon>
                                <PathIcon Data="{StaticResource DeleteIcon}" />
                            </MenuItem.Icon>
                        </MenuItem>
                    </ContextMenu>
                </Border.ContextMenu>

                <Grid RowDefinitions="Auto,Auto,Auto">
                    <!-- Row 0: Title Row -->
                    <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto">
                        <!-- Pin indicator -->
                        <PathIcon Grid.Column="0"
                                  Data="{StaticResource PinIcon}"
                                  Width="12" Height="12"
                                  Margin="0,0,6,0"
                                  IsVisible="{Binding IsPinned}"
                                  Foreground="{DynamicResource AccentColor}" />

                        <!-- Title (normal display) -->
                        <TextBlock Grid.Column="1"
                                   Text="{Binding Title}"
                                   IsVisible="{Binding !IsRenaming}"
                                   FontWeight="SemiBold"
                                   TextTrimming="CharacterEllipsis" />

                        <!-- Title (rename mode) -->
                        <TextBox Grid.Column="1"
                                 Text="{Binding EditingTitle, Mode=TwoWay}"
                                 IsVisible="{Binding IsRenaming}"
                                 Classes="inline-edit"
                                 KeyDown="OnRenameKeyDown"
                                 LostFocus="OnRenameLostFocus" />

                        <!-- Timestamp -->
                        <TextBlock Grid.Column="2"
                                   Text="{Binding RelativeTime}"
                                   FontSize="11"
                                   Foreground="{DynamicResource TextSecondaryColor}"
                                   VerticalAlignment="Center"
                                   Margin="8,0,0,0" />
                    </Grid>

                    <!-- Row 1: Preview -->
                    <TextBlock Grid.Row="1"
                               Text="{Binding Preview}"
                               FontSize="12"
                               Foreground="{DynamicResource TextSecondaryColor}"
                               TextTrimming="CharacterEllipsis"
                               Margin="0,4,0,0"
                               IsVisible="{Binding Preview, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />

                    <!-- Row 2: Message count -->
                    <TextBlock Grid.Row="2"
                               Text="{Binding MessageCountText}"
                               FontSize="11"
                               Foreground="{DynamicResource TextTertiaryColor}"
                               Margin="0,4,0,0" />
                </Grid>
            </Border>
        </DataTemplate>

        <!-- Group Header Template -->
        <DataTemplate x:Key="GroupHeaderTemplate" x:DataType="vm:ConversationGroupViewModel">
            <Expander IsExpanded="{Binding IsExpanded, Mode=TwoWay}"
                      Padding="8,4"
                      Classes="group-header">
                <Expander.Header>
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock Text="{Binding Title}"
                                   FontWeight="SemiBold"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextSecondaryColor}" />
                        <TextBlock Grid.Column="1"
                                   Text="{Binding Count}"
                                   FontSize="11"
                                   Foreground="{DynamicResource TextTertiaryColor}"
                                   Margin="8,0,0,0" />
                    </Grid>
                </Expander.Header>

                <ItemsControl ItemsSource="{Binding Conversations}"
                              ItemTemplate="{StaticResource ConversationItemTemplate}" />
            </Expander>
        </DataTemplate>
    </UserControl.Resources>

    <Grid RowDefinitions="Auto,Auto,*">
        <!-- Row 0: Header -->
        <Grid Grid.Row="0"
              ColumnDefinitions="*,Auto"
              Margin="12,12,12,8">
            <TextBlock Text="Conversations"
                       FontWeight="Bold"
                       FontSize="14"
                       VerticalAlignment="Center" />

            <Button Grid.Column="1"
                    Command="{Binding CreateNewConversationCommand}"
                    ToolTip.Tip="New Conversation (Ctrl+N)"
                    Classes="icon-button">
                <PathIcon Data="{StaticResource PlusIcon}"
                          Width="16" Height="16" />
            </Button>
        </Grid>

        <!-- Row 1: Search Box -->
        <Border Grid.Row="1"
                Margin="12,0,12,8"
                Padding="8,6"
                CornerRadius="6"
                Background="{DynamicResource ControlBackgroundColor}">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <PathIcon Grid.Column="0"
                          Data="{StaticResource SearchIcon}"
                          Width="14" Height="14"
                          Foreground="{DynamicResource TextSecondaryColor}"
                          Margin="0,0,8,0" />

                <TextBox Grid.Column="1"
                         Text="{Binding SearchQuery, Mode=TwoWay}"
                         Watermark="Search conversations..."
                         Classes="borderless"
                         KeyDown="OnSearchKeyDown" />

                <Button Grid.Column="2"
                        Command="{Binding ClearSearchCommand}"
                        IsVisible="{Binding SearchQuery, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                        Classes="icon-button small">
                    <PathIcon Data="{StaticResource CloseIcon}"
                              Width="12" Height="12" />
                </Button>
            </Grid>
        </Border>

        <!-- Row 2: Content Area -->
        <ScrollViewer Grid.Row="2"
                      HorizontalScrollBarVisibility="Disabled"
                      VerticalScrollBarVisibility="Auto">

            <Panel>
                <!-- Loading Indicator -->
                <StackPanel IsVisible="{Binding IsLoading}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Spacing="8">
                    <ProgressRing Width="24" Height="24" />
                    <TextBlock Text="Loading..."
                               FontSize="12"
                               Foreground="{DynamicResource TextSecondaryColor}" />
                </StackPanel>

                <!-- Empty State -->
                <StackPanel IsVisible="{Binding IsEmpty}"
                            HorizontalAlignment="Center"
                            VerticalAlignment="Center"
                            Margin="20"
                            Spacing="12">
                    <PathIcon Data="{StaticResource ChatIcon}"
                              Width="48" Height="48"
                              Foreground="{DynamicResource TextTertiaryColor}" />
                    <TextBlock Text="No conversations yet"
                               FontSize="14"
                               Foreground="{DynamicResource TextSecondaryColor}"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Start a new conversation to begin"
                               FontSize="12"
                               Foreground="{DynamicResource TextTertiaryColor}"
                               HorizontalAlignment="Center" />
                    <Button Content="New Conversation"
                            Command="{Binding CreateNewConversationCommand}"
                            HorizontalAlignment="Center"
                            Classes="accent"
                            Margin="0,8,0,0" />
                </StackPanel>

                <!-- Grouped List -->
                <ItemsControl ItemsSource="{Binding Groups}"
                              ItemTemplate="{StaticResource GroupHeaderTemplate}"
                              IsVisible="{Binding !IsEmpty}"
                              Margin="4,0" />
            </Panel>
        </ScrollViewer>

        <!-- Error Message Banner -->
        <Border Grid.Row="2"
                IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
                Background="{DynamicResource ErrorBackgroundColor}"
                Padding="12,8"
                Margin="12"
                CornerRadius="6"
                VerticalAlignment="Bottom">
            <TextBlock Text="{Binding ErrorMessage}"
                       Foreground="{DynamicResource ErrorForegroundColor}"
                       TextWrapping="Wrap" />
        </Border>
    </Grid>
</UserControl>
```

---

### Task 4: Create ConversationListView.axaml.cs

**File:** `src/SeniorIntern.Desktop/Views/ConversationListView.axaml.cs`

Code-behind with event handlers:

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;
using Avalonia.Input;
using Avalonia.Interactivity;
using SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Code-behind for ConversationListView.
/// Handles keyboard navigation and pointer events.
/// </summary>
public partial class ConversationListView : UserControl
{
    public ConversationListView()
    {
        InitializeComponent();
    }

    /// <summary>Gets the typed ViewModel.</summary>
    private ConversationListViewModel? ViewModel => DataContext as ConversationListViewModel;

    /// <summary>
    /// Handles left-click on a conversation item to select it.
    /// </summary>
    private async void OnConversationPointerPressed(object? sender, PointerPressedEventArgs e)
    {
        if (sender is Border border &&
            border.DataContext is ConversationSummaryViewModel summary &&
            e.GetCurrentPoint(border).Properties.IsLeftButtonPressed)
        {
            // Don't select if currently renaming
            if (summary.IsRenaming)
                return;

            await ViewModel?.SelectConversationCommand.ExecuteAsync(summary)!;
        }
    }

    /// <summary>
    /// Handles keyboard input in the rename TextBox.
    /// Enter confirms, Escape cancels.
    /// </summary>
    private async void OnRenameKeyDown(object? sender, KeyEventArgs e)
    {
        if (sender is TextBox textBox &&
            textBox.DataContext is ConversationSummaryViewModel summary)
        {
            if (e.Key == Key.Enter)
            {
                await ViewModel?.ConfirmRenameCommand.ExecuteAsync(summary)!;
                e.Handled = true;
            }
            else if (e.Key == Key.Escape)
            {
                ViewModel?.CancelRenameCommand.Execute(summary);
                e.Handled = true;
            }
        }
    }

    /// <summary>
    /// Handles focus leaving the rename TextBox.
    /// Auto-confirms the rename.
    /// </summary>
    private async void OnRenameLostFocus(object? sender, RoutedEventArgs e)
    {
        if (sender is TextBox textBox &&
            textBox.DataContext is ConversationSummaryViewModel summary &&
            summary.IsRenaming)
        {
            await ViewModel?.ConfirmRenameCommand.ExecuteAsync(summary)!;
        }
    }

    /// <summary>
    /// Handles keyboard input in the search TextBox.
    /// Escape clears the search.
    /// </summary>
    private void OnSearchKeyDown(object? sender, KeyEventArgs e)
    {
        if (e.Key == Key.Escape)
        {
            ViewModel?.ClearSearchCommand.Execute(null);
            e.Handled = true;
        }
    }
}
```

---

### Task 5: Add Conversation List Styles

**File:** `src/SeniorIntern.Desktop/Themes/Dark.axaml` (append these styles)

```xml
<!-- Conversation List Styles -->

<!-- Conversation Item Base -->
<Style Selector="Border.conversation-item">
    <Setter Property="Cursor" Value="Hand" />
</Style>

<!-- Conversation Item Hover -->
<Style Selector="Border.conversation-item:pointerover">
    <Setter Property="Background" Value="{DynamicResource ControlHoverBackgroundColor}" />
</Style>

<!-- Conversation Item Selected -->
<Style Selector="Border.conversation-item.selected">
    <Setter Property="Background" Value="{DynamicResource AccentBackgroundColor}" />
</Style>

<!-- Conversation Item Selected + Hover -->
<Style Selector="Border.conversation-item.selected:pointerover">
    <Setter Property="Background" Value="{DynamicResource AccentHoverBackgroundColor}" />
</Style>

<!-- Inline Edit TextBox -->
<Style Selector="TextBox.inline-edit">
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Padding" Value="0" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="FontWeight" Value="SemiBold" />
</Style>

<!-- Borderless TextBox (Search) -->
<Style Selector="TextBox.borderless">
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Background" Value="Transparent" />
</Style>

<!-- Icon Button -->
<Style Selector="Button.icon-button">
    <Setter Property="Padding" Value="6" />
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="CornerRadius" Value="4" />
</Style>

<Style Selector="Button.icon-button:pointerover">
    <Setter Property="Background" Value="{DynamicResource ControlHoverBackgroundColor}" />
</Style>

<Style Selector="Button.icon-button.small">
    <Setter Property="Padding" Value="4" />
</Style>

<!-- Destructive Menu Item -->
<Style Selector="MenuItem.destructive">
    <Setter Property="Foreground" Value="{DynamicResource ErrorForegroundColor}" />
</Style>

<!-- Accent Button -->
<Style Selector="Button.accent">
    <Setter Property="Background" Value="{DynamicResource AccentColor}" />
    <Setter Property="Foreground" Value="White" />
</Style>

<Style Selector="Button.accent:pointerover">
    <Setter Property="Background" Value="{DynamicResource AccentHoverColor}" />
</Style>

<!-- Group Header Expander -->
<Style Selector="Expander.group-header">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderThickness" Value="0" />
</Style>
```

---

### Task 6: Add Theme Color Resources

**File:** `src/SeniorIntern.Desktop/Themes/Dark.axaml` (ensure these colors exist)

```xml
<!-- Base Colors -->
<Color x:Key="ControlBackgroundColor">#2A2A2A</Color>
<Color x:Key="ControlHoverBackgroundColor">#3A3A3A</Color>

<!-- Accent Colors -->
<Color x:Key="AccentColor">#0078D4</Color>
<Color x:Key="AccentHoverColor">#1084D8</Color>
<Color x:Key="AccentBackgroundColor">#0078D420</Color>
<Color x:Key="AccentHoverBackgroundColor">#0078D430</Color>

<!-- Text Colors -->
<Color x:Key="TextPrimaryColor">#FFFFFF</Color>
<Color x:Key="TextSecondaryColor">#B0B0B0</Color>
<Color x:Key="TextTertiaryColor">#808080</Color>

<!-- Error Colors -->
<Color x:Key="ErrorBackgroundColor">#4A1515</Color>
<Color x:Key="ErrorForegroundColor">#FF6B6B</Color>
```

---

## Logging Specifications

### Note on UI Logging

UI views typically don't log directly. All business logic and error handling occurs in the ViewModel layer, which logs via the service layer.

---

## Unit Testing Requirements

### Test Summary

| Component | Test Count | Focus Areas |
|-----------|------------|-------------|
| PinTextConverter | 2 | trueâ†’"Unpin", falseâ†’"Pin" |
| ConversationListView | 6 | Integration tests with TestWindow |
| **Total** | **8** | |

### Key Test Scenarios

```csharp
// PinTextConverter Tests
[Theory]
[InlineData(true, "Unpin")]
[InlineData(false, "Pin")]
public void Convert_ReturnsCorrectText(bool isPinned, string expected)
{
    var converter = new PinTextConverter();
    var result = converter.Convert(isPinned, typeof(string), null, CultureInfo.InvariantCulture);
    Assert.Equal(expected, result);
}

[Fact]
public void Convert_WithNull_ReturnsPin()
{
    var converter = new PinTextConverter();
    var result = converter.Convert(null, typeof(string), null, CultureInfo.InvariantCulture);
    Assert.Equal("Pin", result);
}

// Integration Tests (require Avalonia test harness)
[AvaloniaFact]
public async Task View_LoadsAndDisplaysGroups()
{
    var vm = CreateMockViewModel(conversations: 5);
    var view = new ConversationListView { DataContext = vm };
    
    await vm.InitializeAsync();
    
    // Verify groups are rendered
    var groups = view.FindDescendants<Expander>().ToList();
    Assert.NotEmpty(groups);
}

[AvaloniaFact]
public async Task ClickingItem_SelectsConversation()
{
    var vm = CreateMockViewModel(conversations: 3);
    var view = new ConversationListView { DataContext = vm };
    await vm.InitializeAsync();
    
    var firstItem = view.FindDescendant<Border>(b => b.Classes.Contains("conversation-item"));
    
    // Simulate click
    firstItem?.RaiseEvent(new PointerPressedEventArgs(...));
    
    Assert.NotNull(vm.SelectedConversation);
}
```

---

## Use Cases

### UC-001: Browse Conversations by Date

| Attribute | Value |
|-----------|-------|
| **Actor** | User |
| **Trigger** | User opens application/sidebar |
| **Success Scenario** | Conversations displayed in date groups (Today, Yesterday, etc.) |
| **Postcondition** | User can see all recent conversations organized by recency |

#### Flow
1. User views sidebar
2. Groups display with expand/collapse toggles
3. Each group shows count badge
4. Conversations within groups show title, preview, time, message count
5. Pinned conversations appear first within each group

---

### UC-002: Search Conversations

| Attribute | Value |
|-----------|-------|
| **Actor** | User |
| **Trigger** | User types in search box |
| **Success Scenario** | List filters to matching conversations after 300ms |
| **Postcondition** | Only matching conversations visible |

#### Flow
1. User clicks search box or focuses with Ctrl+F
2. User types search text
3. After 300ms debounce, list updates
4. Matching conversations displayed in groups
5. User presses Escape or clicks [Ã—] to clear and restore full list

---

### UC-003: Rename Conversation via Context Menu

| Attribute | Value |
|-----------|-------|
| **Actor** | User |
| **Trigger** | User right-clicks â†’ "Rename" |
| **Success Scenario** | Title becomes editable, Enter saves |
| **Postcondition** | Conversation has new title in DB and UI |

#### Flow
1. User right-clicks conversation item
2. Context menu appears with "Rename" option
3. User clicks "Rename"
4. Title TextBlock becomes TextBox with current title
5. User edits title and presses Enter
6. New title saved to database
7. TextBox reverts to TextBlock with new title

---

### UC-004: Select Conversation

| Attribute | Value |
|-----------|-------|
| **Actor** | User |
| **Trigger** | User clicks conversation item |
| **Success Scenario** | Conversation loads in chat area |
| **Postcondition** | Selected conversation highlighted, messages displayed |

---

### UC-005: Empty State Interaction

| Attribute | Value |
|-----------|-------|
| **Actor** | New User |
| **Trigger** | No conversations exist |
| **Success Scenario** | Empty state shows with "New Conversation" button |
| **Postcondition** | User can start first conversation |

---

## Deliverable Checklist

### Presentation Layer (SeniorIntern.Desktop)
- [ ] Views/ConversationListView.axaml
- [ ] Views/ConversationListView.axaml.cs
- [ ] Converters/PinTextConverter.cs
- [ ] Themes/Dark.axaml (UPDATED with conversation list styles)
- [ ] Assets/Icons.axaml (UPDATED with required icons)

### Tests
- [ ] SeniorIntern.Desktop.Tests - Converter tests
- [ ] SeniorIntern.Desktop.Tests - View integration tests

---

## Files Summary

### Files to Create (3)

| File | Purpose | Lines (approx) |
|------|---------|----------------|
| `Views/ConversationListView.axaml` | Full XAML layout | 180 |
| `Views/ConversationListView.axaml.cs` | Code-behind handlers | 60 |
| `Converters/PinTextConverter.cs` | Pin/Unpin text converter | 30 |

### Files to Modify (2)

| File | Changes |
|------|---------|
| `Themes/Dark.axaml` | Add ~50 lines of conversation list styles |
| `Assets/Icons.axaml` | Add 8 icon StreamGeometry resources |

---

## Verification Steps

### Step 1: Verify Compilation

```bash
dotnet build src/SeniorIntern.Desktop
```

### Step 2: Visual Verification

1. Run application
2. Verify header with title and [+] button displays
3. Verify search box renders with placeholder
4. Verify conversation items display with all elements
5. Verify context menu opens on right-click
6. Verify empty state displays when no conversations

### Step 3: Interaction Testing

1. Click conversation â†’ verify selection highlights
2. Right-click â†’ Rename â†’ verify inline edit
3. Type in search â†’ verify filtering
4. Press Escape in search â†’ verify clear
5. Expand/collapse groups â†’ verify toggle

---

## Acceptance Criteria

| ID | Criterion | Verification |
|----|-----------|--------------|
| AC-1 | View compiles | `dotnet build` succeeds |
| AC-2 | Header displays correctly | Title + New button visible |
| AC-3 | Search box functional | Placeholder, clear button work |
| AC-4 | Groups render with expand/collapse | Expander toggles work |
| AC-5 | Conversation items show all data | Title, preview, time, count |
| AC-6 | Context menu has all options | Rename, Pin/Unpin, Archive, Delete |
| AC-7 | Hover/selected states work | Visual feedback on interaction |
| AC-8 | Inline rename works | TextBox appears, Enter/Escape handled |
| AC-9 | Keyboard navigation works | Escape clears search/rename |
| AC-10 | Empty state displays | Icon, message, button when no data |
| AC-11 | Loading indicator shows | ProgressRing during load |
| AC-12 | Error banner displays | Shows on ErrorMessage |

---

## Risk Assessment

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Icon paths not rendering | Low | Medium | Test each icon individually |
| Context menu binding fails | Medium | Medium | Use tested $parent binding syntax |
| Style selectors not matching | Medium | Low | Use Avalonia DevTools to debug |
| Rename focus issues | Low | Low | Test focus management carefully |

---

## Design Decisions

### Decision 1: UserControl vs Window

**Decision:** Implement as UserControl for embedding in MainWindow.
**Rationale:** Sidebar is a component within the main layout, not standalone.

### Decision 2: ItemsControl vs ListBox

**Decision:** Use ItemsControl + manual selection handling.
**Rationale:** More control over selection behavior, avoids ListBox default styles.

### Decision 3: Expander for Groups

**Decision:** Use Expander with custom header template.
**Rationale:** Built-in expand/collapse animation, familiar UX pattern.

### Decision 4: Code-Behind for Pointer Events

**Decision:** Handle PointerPressed in code-behind, not XAML-only.
**Rationale:** Need to check button type and renaming state before selecting.

### Decision 5: Inline Rename with TextBox Swap

**Decision:** Toggle visibility between TextBlock and TextBox.
**Rationale:** Simple state management, clear visual transition.

---

## Future Considerations

| Item | Target Version | Rationale |
|------|----------------|-----------|
| Drag-and-drop reordering | v0.3.0+ | Complex drag handling |
| Virtualization | v0.3.0+ | Performance for large lists |
| Animations | v0.3.0+ | Smooth transitions |
| Accessibility | v0.3.0+ | Screen reader support |

---

## Timeline Estimate

| Version | Estimated Effort | Key Deliverables |
|---------|------------------|------------------|
| v0.2.2c | 1 day | AXAML view, code-behind, styles, converter |

---

## References

- [Avalonia UserControl](https://docs.avaloniaui.net/docs/controls/usercontrol)
- [Avalonia Styles](https://docs.avaloniaui.net/docs/styling/styles)
- [Avalonia Data Templates](https://docs.avaloniaui.net/docs/templates/data-templates)
- [Avalonia Context Menu](https://docs.avaloniaui.net/docs/controls/contextmenu)
- [Avalonia Expander](https://docs.avaloniaui.net/docs/controls/expander)
