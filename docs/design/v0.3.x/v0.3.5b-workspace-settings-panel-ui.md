# Design Specification: The Senior Intern v0.3.5b "Workspace Settings Panel UI"

## Executive Summary

This document provides a detailed implementation specification for v0.3.5b, which creates the settings dialog UI that allows users to configure all workspace-related options. The dialog is organized into clear sections (File Explorer, Editor, Context Attachment) with appropriate controls for each setting type.

### v0.3.5b Scope

- Create `WorkspaceSettingsPanel.axaml` window with organized sections
- Create `WorkspaceSettingsPanel.axaml.cs` code-behind
- Implement File Explorer settings section
- Implement Editor settings section
- Implement Context Attachment settings section
- Add footer with Reset to Defaults, Cancel, and Save buttons
- Add validation error display
- Add settings panel styles to theme

### Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| WorkspaceSettingsPanel.axaml | Settings dialog window |
| WorkspaceSettingsPanel.axaml.cs | Code-behind with initialization |
| File Explorer section | 6 settings controls |
| Editor section | 9 settings controls |
| Context section | 6 settings controls |
| Footer | Buttons and validation display |
| Theme styles | Section headers, labels, dividers |

---

## Feature Overview

```
┌──────────────────────────────────────────────────────────────────┐
│                     v0.3.5b Feature Tree                          │
├──────────────────────────────────────────────────────────────────┤
│                                                                   │
│  WorkspaceSettingsPanel (Window)                                  │
│  ├── Window Properties                                           │
│  │   ├── Title: "Settings"                                      │
│  │   ├── Width: 600, Height: 700                                │
│  │   ├── MinWidth: 500, MinHeight: 500                          │
│  │   └── WindowStartupLocation: CenterOwner                     │
│  │                                                                │
│  ├── Window Styles                                               │
│  │   ├── TextBlock.section-header                               │
│  │   ├── TextBlock.setting-label                                │
│  │   ├── TextBlock.setting-description                          │
│  │   └── Border.section-divider                                 │
│  │                                                                │
│  ├── Content (ScrollViewer)                                      │
│  │   │                                                           │
│  │   ├── FILE EXPLORER SECTION                                  │
│  │   │   ├── Restore last workspace (CheckBox)                  │
│  │   │   ├── Show hidden files (CheckBox)                       │
│  │   │   ├── Respect .gitignore (CheckBox)                      │
│  │   │   ├── Auto-refresh on changes (CheckBox)                 │
│  │   │   ├── Recent workspaces count (NumericUpDown)            │
│  │   │   └── Custom ignore patterns (TextBox multiline)         │
│  │   │                                                           │
│  │   ├── EDITOR SECTION                                         │
│  │   │   ├── Font family (ComboBox → AvailableFonts)            │
│  │   │   ├── Font size (ComboBox → FontSizeOptions)             │
│  │   │   ├── Tab size (ComboBox → TabSizeOptions)               │
│  │   │   ├── Convert tabs to spaces (CheckBox)                  │
│  │   │   ├── Show line numbers (CheckBox)                       │
│  │   │   ├── Highlight current line (CheckBox)                  │
│  │   │   ├── Word wrap (CheckBox)                               │
│  │   │   ├── Column ruler (ComboBox → RulerColumnOptions)       │
│  │   │   └── Syntax theme (ComboBox → AvailableThemes)          │
│  │   │                                                           │
│  │   └── CONTEXT ATTACHMENT SECTION                             │
│  │       ├── Maximum files (NumericUpDown)                      │
│  │       ├── Max tokens per file (NumericUpDown)                │
│  │       ├── Max total tokens (NumericUpDown)                   │
│  │       ├── Max file size KB (NumericUpDown)                   │
│  │       ├── Show token count (CheckBox)                        │
│  │       └── Warn on token limit (CheckBox)                     │
│  │                                                                │
│  └── Footer (Border)                                             │
│      ├── Reset to Defaults (Button, left)                       │
│      ├── ValidationError (TextBlock, red)                       │
│      ├── Cancel (Button, IsCancel=True)                         │
│      └── Save (Button, primary, IsDefault=True)                 │
│                                                                   │
│  WorkspaceSettingsPanel.axaml.cs                                  │
│  ├── Constructor                                                 │
│  │   └── InitializeComponent()                                  │
│  ├── InitializeAsync(ISettingsService)                          │
│  │   └── DataContext = new WorkspaceSettingsViewModel(...)      │
│  └── Event subscriptions                                        │
│      ├── SaveCompleted → Close()                                │
│      └── CancelRequested → Close()                              │
│                                                                   │
└──────────────────────────────────────────────────────────────────┘
```

---

## Architecture Diagrams

### Dialog Layout

```
┌─────────────────────────────────────────────────────────────────┐
│                    Settings Dialog Layout                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌───────────────────────────────────────────────────────────┐   │
│  │                    Settings                          [✕]  │   │
│  ├───────────────────────────────────────────────────────────┤   │
│  │                                                            │   │
│  │  File Explorer                                             │   │
│  │  ───────────────────────────────────────────────────       │   │
│  │                                                            │   │
│  │  ☑ Restore last workspace on startup                      │   │
│  │     Automatically open the last used folder...            │   │
│  │                                                            │   │
│  │  ☐ Show hidden files and folders                          │   │
│  │     Display files starting with a dot...                  │   │
│  │                                                            │   │
│  │  ☑ Respect .gitignore patterns                            │   │
│  │     Hide files and folders matching...                    │   │
│  │                                                            │   │
│  │  ☑ Auto-refresh on external changes                       │   │
│  │     Automatically update the file tree...                 │   │
│  │                                                            │   │
│  │  Recent workspaces to remember           [▼ 10 ▲]         │   │
│  │     Maximum number of recent folders...                   │   │
│  │                                                            │   │
│  │  Custom ignore patterns (one per line)                    │   │
│  │     Files and folders matching...                         │   │
│  │  ┌─────────────────────────────────────────────────────┐  │   │
│  │  │ node_modules/                                        │  │   │
│  │  │ bin/                                                 │  │   │
│  │  │ obj/                                                 │  │   │
│  │  │ .vs/                                                 │  │   │
│  │  └─────────────────────────────────────────────────────┘  │   │
│  │                                                            │   │
│  │  ─────────────────────────────────────────────────────     │   │
│  │                                                            │   │
│  │  Editor                                                    │   │
│  │  ───────────────────────────────────────────────────       │   │
│  │                                                            │   │
│  │  Font family                        [▼ Cascadia Code    ▼]│   │
│  │  Font size                          [▼ 14               ▼]│   │
│  │  Tab size                           [▼ 4                ▼]│   │
│  │  ☑ Convert tabs to spaces                                 │   │
│  │  ☑ Show line numbers                                      │   │
│  │  ☑ Highlight current line                                 │   │
│  │  ☐ Word wrap                                              │   │
│  │  Column ruler                       [▼ 0 (disabled)     ▼]│   │
│  │  Syntax theme                       [▼ DarkPlus         ▼]│   │
│  │                                                            │   │
│  │  ─────────────────────────────────────────────────────     │   │
│  │                                                            │   │
│  │  Context Attachment                                        │   │
│  │  ───────────────────────────────────────────────────       │   │
│  │                                                            │   │
│  │  Maximum files                          [▼ 10  ▲]         │   │
│  │  Maximum tokens per file               [▼ 4000 ▲]         │   │
│  │  Maximum total tokens                  [▼ 8000 ▲]         │   │
│  │  Maximum file size (KB)                 [▼ 500 ▲]         │   │
│  │  ☑ Show token count in context bar                        │   │
│  │  ☑ Warn when approaching token limit                      │   │
│  │                                                            │   │
│  ├───────────────────────────────────────────────────────────┤   │
│  │ [Reset to Defaults]              Error msg │ [Cancel][Save]│   │
│  └───────────────────────────────────────────────────────────┘   │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Control Types by Setting

```
┌─────────────────────────────────────────────────────────────────┐
│                    Control Type Mapping                          │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ CheckBox                                                    │ │
│  │ ─────────                                                   │ │
│  │ • Boolean settings with label + optional description       │ │
│  │ • File Explorer: Restore, Hidden, GitIgnore, AutoRefresh   │ │
│  │ • Editor: Tabs→Spaces, LineNumbers, Highlight, WordWrap    │ │
│  │ • Context: ShowTokenCount, WarnOnLimit                     │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ ComboBox                                                    │ │
│  │ ────────                                                    │ │
│  │ • Selection from predefined options                        │ │
│  │ • ItemsSource bound to ViewModel collection/array          │ │
│  │ • Editor: FontFamily, FontSize, TabSize, Ruler, Theme      │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ NumericUpDown                                               │ │
│  │ ─────────────                                               │ │
│  │ • Integer values with Min/Max constraints                  │ │
│  │ • File Explorer: MaxRecentWorkspaces (1-50)                │ │
│  │ • Context: MaxFiles (1-50), Tokens (100-32000+), Size      │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │ TextBox (multiline)                                        │ │
│  │ ─────────────────────                                       │ │
│  │ • Multi-line text input                                    │ │
│  │ • AcceptsReturn="True", fixed Height                       │ │
│  │ • File Explorer: CustomIgnorePatterns                      │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Data Binding Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    Data Binding Flow                             │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  MainWindow > Menu > Settings                                    │
│         │                                                        │
│         ▼                                                        │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ var dialog = new WorkspaceSettingsPanel();                 │  │
│  │ dialog.InitializeAsync(_settingsService);                  │  │
│  │ await dialog.ShowDialog(this);                             │  │
│  └────────────────────────────────────────────────────────────┘  │
│         │                                                        │
│         ▼                                                        │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ WorkspaceSettingsPanel.InitializeAsync():                  │  │
│  │                                                             │  │
│  │ var vm = new WorkspaceSettingsViewModel(settingsService);  │  │
│  │ vm.SaveCompleted += (s, e) => Close();                     │  │
│  │ vm.CancelRequested += (s, e) => Close();                   │  │
│  │ DataContext = vm;                                          │  │
│  └────────────────────────────────────────────────────────────┘  │
│         │                                                        │
│         ▼ Two-way bindings established                          │
│         │                                                        │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ XAML Bindings:                                             │  │
│  │                                                             │  │
│  │ CheckBox IsChecked="{Binding RestoreLastWorkspace}"        │  │
│  │          │                                                  │  │
│  │          ├─► User clicks → VM property changes             │  │
│  │          └─► VM property changes → UI updates              │  │
│  │                                                             │  │
│  │ ComboBox SelectedItem="{Binding EditorFontFamily}"         │  │
│  │          ItemsSource="{Binding AvailableFonts}"            │  │
│  │                                                             │  │
│  │ NumericUpDown Value="{Binding MaxTokensPerFile}"           │  │
│  │               Minimum="100" Maximum="32000"                │  │
│  └────────────────────────────────────────────────────────────┘  │
│         │                                                        │
│         ▼ User clicks Save                                      │
│         │                                                        │
│  ┌────────────────────────────────────────────────────────────┐  │
│  │ SaveCommand → SaveAsync() → SaveCompleted event            │  │
│  │     → Dialog closes                                         │  │
│  └────────────────────────────────────────────────────────────┘  │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Directory Structure

```
src/SeniorIntern.Desktop/
├── Views/
│   ├── WorkspaceSettingsPanel.axaml                  (NEW)
│   └── WorkspaceSettingsPanel.axaml.cs               (NEW)
└── Themes/
    └── Dark.axaml                                    (MODIFY)
```

---

## Implementation Details

### Task 1: Create WorkspaceSettingsPanel.axaml

**File:** `src/SeniorIntern.Desktop/Views/WorkspaceSettingsPanel.axaml`

```xml
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
        mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="700"
        x:Class="SeniorIntern.Desktop.Views.WorkspaceSettingsPanel"
        x:DataType="vm:WorkspaceSettingsViewModel"
        Title="Settings"
        Width="600"
        Height="700"
        MinWidth="500"
        MinHeight="500"
        WindowStartupLocation="CenterOwner"
        CanResize="True">

    <Window.Styles>
        <Style Selector="TextBlock.section-header">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Margin" Value="0,16,0,8" />
            <Setter Property="Foreground" Value="{DynamicResource TextPrimaryBrush}" />
        </Style>

        <Style Selector="TextBlock.setting-label">
            <Setter Property="FontSize" Value="13" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style Selector="TextBlock.setting-description">
            <Setter Property="FontSize" Value="11" />
            <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}" />
            <Setter Property="TextWrapping" Value="Wrap" />
            <Setter Property="Margin" Value="0,2,0,0" />
        </Style>

        <Style Selector="Border.section-divider">
            <Setter Property="Height" Value="1" />
            <Setter Property="Background" Value="{DynamicResource BorderBrush}" />
            <Setter Property="Margin" Value="0,16,0,0" />
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="*, Auto">
        <!-- Scrollable Content -->
        <ScrollViewer Grid.Row="0"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="24,16">
            <StackPanel Spacing="4">

                <!-- ═══════════════════════════════════════════════════════════ -->
                <!-- FILE EXPLORER SECTION -->
                <!-- ═══════════════════════════════════════════════════════════ -->
                <TextBlock Text="File Explorer" Classes="section-header" />

                <!-- Restore Last Workspace -->
                <CheckBox IsChecked="{Binding RestoreLastWorkspace}">
                    <StackPanel>
                        <TextBlock Text="Restore last workspace on startup" Classes="setting-label" />
                        <TextBlock Text="Automatically open the last used folder when starting the application"
                                   Classes="setting-description" />
                    </StackPanel>
                </CheckBox>

                <!-- Show Hidden Files -->
                <CheckBox IsChecked="{Binding ShowHiddenFiles}" Margin="0,8,0,0">
                    <StackPanel>
                        <TextBlock Text="Show hidden files and folders" Classes="setting-label" />
                        <TextBlock Text="Display files starting with a dot (e.g., .gitignore)"
                                   Classes="setting-description" />
                    </StackPanel>
                </CheckBox>

                <!-- Use GitIgnore -->
                <CheckBox IsChecked="{Binding UseGitIgnore}" Margin="0,8,0,0">
                    <StackPanel>
                        <TextBlock Text="Respect .gitignore patterns" Classes="setting-label" />
                        <TextBlock Text="Hide files and folders matching patterns in .gitignore"
                                   Classes="setting-description" />
                    </StackPanel>
                </CheckBox>

                <!-- Auto Refresh -->
                <CheckBox IsChecked="{Binding AutoRefreshOnExternalChanges}" Margin="0,8,0,0">
                    <StackPanel>
                        <TextBlock Text="Auto-refresh on external changes" Classes="setting-label" />
                        <TextBlock Text="Automatically update the file tree when files change outside the app"
                                   Classes="setting-description" />
                    </StackPanel>
                </CheckBox>

                <!-- Max Recent Workspaces -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,12,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Recent workspaces to remember" Classes="setting-label" />
                        <TextBlock Text="Maximum number of recent folders shown in the menu"
                                   Classes="setting-description" />
                    </StackPanel>
                    <NumericUpDown Grid.Column="1"
                                   Value="{Binding MaxRecentWorkspaces}"
                                   Minimum="1"
                                   Maximum="50"
                                   Width="80"
                                   VerticalAlignment="Center" />
                </Grid>

                <!-- Custom Ignore Patterns -->
                <StackPanel Margin="0,12,0,0">
                    <TextBlock Text="Custom ignore patterns (one per line)" Classes="setting-label" />
                    <TextBlock Text="Files and folders matching these patterns will be hidden"
                               Classes="setting-description" />
                    <TextBox Text="{Binding CustomIgnorePatterns}"
                             AcceptsReturn="True"
                             Height="100"
                             Margin="0,8,0,0"
                             FontFamily="Cascadia Code, Consolas, monospace"
                             FontSize="12" />
                </StackPanel>

                <Border Classes="section-divider" />

                <!-- ═══════════════════════════════════════════════════════════ -->
                <!-- EDITOR SECTION -->
                <!-- ═══════════════════════════════════════════════════════════ -->
                <TextBlock Text="Editor" Classes="section-header" />

                <!-- Font Family -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,0,0,0">
                    <TextBlock Grid.Column="0" Text="Font family" Classes="setting-label" />
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding AvailableFonts}"
                              SelectedItem="{Binding EditorFontFamily}"
                              Width="200" />
                </Grid>

                <!-- Font Size -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <TextBlock Grid.Column="0" Text="Font size" Classes="setting-label" />
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding FontSizeOptions}"
                              SelectedItem="{Binding EditorFontSize}"
                              Width="80" />
                </Grid>

                <!-- Tab Size -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <TextBlock Grid.Column="0" Text="Tab size" Classes="setting-label" />
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding TabSizeOptions}"
                              SelectedItem="{Binding TabSize}"
                              Width="80" />
                </Grid>

                <!-- Convert Tabs to Spaces -->
                <CheckBox IsChecked="{Binding ConvertTabsToSpaces}" Margin="0,8,0,0">
                    <TextBlock Text="Convert tabs to spaces" Classes="setting-label" />
                </CheckBox>

                <!-- Show Line Numbers -->
                <CheckBox IsChecked="{Binding ShowLineNumbers}" Margin="0,8,0,0">
                    <TextBlock Text="Show line numbers" Classes="setting-label" />
                </CheckBox>

                <!-- Highlight Current Line -->
                <CheckBox IsChecked="{Binding HighlightCurrentLine}" Margin="0,8,0,0">
                    <TextBlock Text="Highlight current line" Classes="setting-label" />
                </CheckBox>

                <!-- Word Wrap -->
                <CheckBox IsChecked="{Binding WordWrap}" Margin="0,8,0,0">
                    <TextBlock Text="Word wrap" Classes="setting-label" />
                </CheckBox>

                <!-- Ruler Column -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Column ruler" Classes="setting-label" />
                        <TextBlock Text="Show a vertical line at this column (0 = disabled)"
                                   Classes="setting-description" />
                    </StackPanel>
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding RulerColumnOptions}"
                              SelectedItem="{Binding RulerColumn}"
                              Width="80" />
                </Grid>

                <!-- Editor Theme -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <TextBlock Grid.Column="0" Text="Syntax theme" Classes="setting-label" />
                    <ComboBox Grid.Column="1"
                              ItemsSource="{Binding AvailableThemes}"
                              SelectedItem="{Binding EditorTheme}"
                              Width="150" />
                </Grid>

                <Border Classes="section-divider" />

                <!-- ═══════════════════════════════════════════════════════════ -->
                <!-- CONTEXT ATTACHMENT SECTION -->
                <!-- ═══════════════════════════════════════════════════════════ -->
                <TextBlock Text="Context Attachment" Classes="section-header" />

                <!-- Max Files Attached -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,0,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Maximum files" Classes="setting-label" />
                        <TextBlock Text="Maximum number of files that can be attached at once"
                                   Classes="setting-description" />
                    </StackPanel>
                    <NumericUpDown Grid.Column="1"
                                   Value="{Binding MaxFilesAttached}"
                                   Minimum="1"
                                   Maximum="50"
                                   Width="80" />
                </Grid>

                <!-- Max Tokens Per File -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Maximum tokens per file" Classes="setting-label" />
                        <TextBlock Text="Files exceeding this limit will be truncated"
                                   Classes="setting-description" />
                    </StackPanel>
                    <NumericUpDown Grid.Column="1"
                                   Value="{Binding MaxTokensPerFile}"
                                   Minimum="100"
                                   Maximum="32000"
                                   Increment="500"
                                   Width="100" />
                </Grid>

                <!-- Max Total Tokens -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Maximum total tokens" Classes="setting-label" />
                        <TextBlock Text="Combined token limit for all attached files"
                                   Classes="setting-description" />
                    </StackPanel>
                    <NumericUpDown Grid.Column="1"
                                   Value="{Binding MaxTotalContextTokens}"
                                   Minimum="100"
                                   Maximum="64000"
                                   Increment="1000"
                                   Width="100" />
                </Grid>

                <!-- Max File Size -->
                <Grid ColumnDefinitions="*, Auto" Margin="0,8,0,0">
                    <StackPanel Grid.Column="0">
                        <TextBlock Text="Maximum file size (KB)" Classes="setting-label" />
                        <TextBlock Text="Files larger than this cannot be attached"
                                   Classes="setting-description" />
                    </StackPanel>
                    <NumericUpDown Grid.Column="1"
                                   Value="{Binding MaxFileSizeKb}"
                                   Minimum="1"
                                   Maximum="10000"
                                   Increment="100"
                                   Width="100" />
                </Grid>

                <!-- Show Token Count -->
                <CheckBox IsChecked="{Binding ShowTokenCount}" Margin="0,8,0,0">
                    <TextBlock Text="Show token count in context bar" Classes="setting-label" />
                </CheckBox>

                <!-- Warn on Token Limit -->
                <CheckBox IsChecked="{Binding WarnOnTokenLimit}" Margin="0,8,0,0">
                    <TextBlock Text="Warn when approaching token limit" Classes="setting-label" />
                </CheckBox>

                <!-- Spacer -->
                <Border Height="24" />

            </StackPanel>
        </ScrollViewer>

        <!-- Footer with Buttons -->
        <Border Grid.Row="1"
                Background="{DynamicResource FooterBackgroundBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="24,16">
            <Grid ColumnDefinitions="Auto, *, Auto, Auto, Auto">
                <!-- Reset to Defaults -->
                <Button Grid.Column="0"
                        Content="Reset to Defaults"
                        Command="{Binding ResetToDefaultsCommand}" />

                <!-- Validation Error -->
                <TextBlock Grid.Column="2"
                           Text="{Binding ValidationError}"
                           Foreground="{DynamicResource ErrorBrush}"
                           VerticalAlignment="Center"
                           Margin="0,0,16,0"
                           IsVisible="{Binding ValidationError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />

                <!-- Cancel -->
                <Button Grid.Column="3"
                        Content="Cancel"
                        Command="{Binding CancelCommand}"
                        Margin="0,0,8,0"
                        IsCancel="True" />

                <!-- Save -->
                <Button Grid.Column="4"
                        Content="Save"
                        Command="{Binding SaveCommand}"
                        Classes="primary"
                        IsDefault="True" />
            </Grid>
        </Border>
    </Grid>
</Window>
```

### Task 2: Create WorkspaceSettingsPanel.axaml.cs

**File:** `src/SeniorIntern.Desktop/Views/WorkspaceSettingsPanel.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Desktop.ViewModels;

public partial class WorkspaceSettingsPanel : Window
{
    public WorkspaceSettingsPanel()
    {
        InitializeComponent();
    }

    /// <summary>
    /// Initializes the dialog with the settings service.
    /// </summary>
    public void Initialize(ISettingsService settingsService)
    {
        var viewModel = new WorkspaceSettingsViewModel(settingsService);

        // Subscribe to close events
        viewModel.SaveCompleted += (s, e) => Close(true);
        viewModel.CancelRequested += (s, e) => Close(false);

        DataContext = viewModel;
    }

    /// <summary>
    /// Shows the dialog and returns whether save was clicked.
    /// </summary>
    public static async Task<bool> ShowDialogAsync(Window owner, ISettingsService settingsService)
    {
        var dialog = new WorkspaceSettingsPanel();
        dialog.Initialize(settingsService);

        var result = await dialog.ShowDialog<bool?>(owner);
        return result == true;
    }
}
```

### Task 3: Add Theme Resources

**File:** `src/SeniorIntern.Desktop/Themes/Dark.axaml` (additions)

```xml
<!-- Settings Panel Colors -->
<SolidColorBrush x:Key="FooterBackgroundBrush" Color="#252526" />

<!-- Primary Button Style -->
<Style Selector="Button.primary">
    <Setter Property="Background" Value="{DynamicResource AccentBrush}" />
    <Setter Property="Foreground" Value="White" />
</Style>

<Style Selector="Button.primary:pointerover">
    <Setter Property="Background" Value="{DynamicResource AccentHoverBrush}" />
</Style>

<Style Selector="Button.primary:pressed">
    <Setter Property="Background" Value="{DynamicResource AccentPressedBrush}" />
</Style>

<!-- Accent Colors -->
<SolidColorBrush x:Key="AccentBrush" Color="#0078D4" />
<SolidColorBrush x:Key="AccentHoverBrush" Color="#1084D8" />
<SolidColorBrush x:Key="AccentPressedBrush" Color="#006CBD" />
```

---

## Control Specifications

### CheckBox Controls

| Section | Property | Description |
|---------|----------|-------------|
| File Explorer | RestoreLastWorkspace | With description |
| File Explorer | ShowHiddenFiles | With description |
| File Explorer | UseGitIgnore | With description |
| File Explorer | AutoRefreshOnExternalChanges | With description |
| Editor | ConvertTabsToSpaces | Label only |
| Editor | ShowLineNumbers | Label only |
| Editor | HighlightCurrentLine | Label only |
| Editor | WordWrap | Label only |
| Context | ShowTokenCount | Label only |
| Context | WarnOnTokenLimit | Label only |

### ComboBox Controls

| Section | Property | ItemsSource | Width |
|---------|----------|-------------|-------|
| Editor | EditorFontFamily | AvailableFonts | 200 |
| Editor | EditorFontSize | FontSizeOptions | 80 |
| Editor | TabSize | TabSizeOptions | 80 |
| Editor | RulerColumn | RulerColumnOptions | 80 |
| Editor | EditorTheme | AvailableThemes | 150 |

### NumericUpDown Controls

| Section | Property | Min | Max | Increment | Width |
|---------|----------|-----|-----|-----------|-------|
| File Explorer | MaxRecentWorkspaces | 1 | 50 | 1 | 80 |
| Context | MaxFilesAttached | 1 | 50 | 1 | 80 |
| Context | MaxTokensPerFile | 100 | 32000 | 500 | 100 |
| Context | MaxTotalContextTokens | 100 | 64000 | 1000 | 100 |
| Context | MaxFileSizeKb | 1 | 10000 | 100 | 100 |

---

## Unit Testing Requirements

| Component | Test Count | Focus Areas |
|-----------|------------|-------------|
| Initialize | 2 | Sets DataContext, subscribes events |
| ShowDialogAsync | 2 | Returns true on save, false on cancel |
| Bindings | 5 | CheckBox, ComboBox, NumericUpDown work |
| Footer buttons | 3 | Reset, Cancel, Save commands |
| Validation display | 2 | Shows/hides error message |
| **Total** | **14** | |

---

## Files Summary

### Files to Create (2)

| File | Lines |
|------|-------|
| `Views/WorkspaceSettingsPanel.axaml` | 280 |
| `Views/WorkspaceSettingsPanel.axaml.cs` | 45 |

### Files to Modify (1)

| File | Changes |
|------|---------|
| `Themes/Dark.axaml` | Add footer background, primary button styles |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | All settings displayed in 3 organized sections |
| AC-2 | Changes reflect immediately in ViewModel |
| AC-3 | Save button saves and closes dialog |
| AC-4 | Cancel button reverts and closes dialog |
| AC-5 | Reset to Defaults resets all values |
| AC-6 | Validation errors display in red near footer |
| AC-7 | Primary button uses accent color styling |
| AC-8 | Dialog is resizable with minimum size |
| AC-9 | Dialog centers on owner window |
| AC-10 | Scrollable when content exceeds window height |

---

## Dependencies

| Part | Dependency Description |
|------|------------------------|
| v0.3.5a | WorkspaceSettingsViewModel |
| ISettingsService | For initialization |

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.3.5b | 0.5 day |
