# Design Specification: The Senior Intern v0.3.3e "Editor Panel UI"

## Executive Summary

This document provides a detailed implementation specification for v0.3.3e, which implements the `EditorPanel` view - the main UI for the code editor with a tab bar, TextEditor control, empty state display, and comprehensive keyboard shortcut handling.

### v0.3.3e Scope

- Create `EditorPanel.axaml` with tab bar and editor area
- Create `EditorPanel.axaml.cs` code-behind with event handling
- Create `LanguageToIconConverter` for tab icons
- Add tab bar and editor styles to theme
- Handle keyboard shortcuts for editor operations
- Wire up ViewModel events (undo, redo, find, replace, go-to-line)

### Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| EditorPanel.axaml | Main editor panel XAML |
| EditorPanel.axaml.cs | Code-behind with event handlers |
| LanguageToIconConverter | Maps language to icon |
| Tab bar styles | Active, hover, dirty states |
| Keyboard shortcuts | Ctrl+S, Ctrl+W, Ctrl+Tab, etc. |

---

## Feature Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     v0.3.3e Feature Tree                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  EditorPanel.axaml                                                â”‚
â”‚  â”œâ”€â”€ Grid Layout (2 rows)                                        â”‚
â”‚  â”‚   â”œâ”€â”€ Row 0: Tab Bar (Auto height)                           â”‚
â”‚  â”‚   â””â”€â”€ Row 1: Editor Area (*)                                 â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Tab Bar                                                     â”‚
â”‚  â”‚   â”œâ”€â”€ Border with TabBarBackgroundBrush                      â”‚
â”‚  â”‚   â”œâ”€â”€ ScrollViewer (horizontal scroll)                       â”‚
â”‚  â”‚   â”œâ”€â”€ ItemsControl bound to Tabs                             â”‚
â”‚  â”‚   â”‚   â””â”€â”€ StackPanel (horizontal, spacing 2px)               â”‚
â”‚  â”‚   â”‚                                                           â”‚
â”‚  â”‚   â””â”€â”€ Tab Item Template                                       â”‚
â”‚  â”‚       â”œâ”€â”€ Button with classes: editor-tab, active, dirty     â”‚
â”‚  â”‚       â”œâ”€â”€ Grid (3 columns)                                   â”‚
â”‚  â”‚       â”‚   â”œâ”€â”€ Col 0: Language icon (PathIcon)                â”‚
â”‚  â”‚       â”‚   â”œâ”€â”€ Col 1: DisplayTitle (TextBlock)                â”‚
â”‚  â”‚       â”‚   â””â”€â”€ Col 2: Close button (X icon)                   â”‚
â”‚  â”‚       â””â”€â”€ Context Menu                                       â”‚
â”‚  â”‚           â”œâ”€â”€ Close (Ctrl+W)                                 â”‚
â”‚  â”‚           â”œâ”€â”€ Close Others                                   â”‚
â”‚  â”‚           â”œâ”€â”€ Close Tabs to the Right                        â”‚
â”‚  â”‚           â”œâ”€â”€ Close All                                      â”‚
â”‚  â”‚           â”œâ”€â”€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                    â”‚
â”‚  â”‚           â”œâ”€â”€ Copy Path                                      â”‚
â”‚  â”‚           â””â”€â”€ Reveal in Explorer                             â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Editor Area                                                 â”‚
â”‚  â”‚   â”œâ”€â”€ TextEditor (ae:TextEditor x:Name="Editor")             â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ IsVisible when ActiveTab != null                   â”‚
â”‚  â”‚   â”‚   â”œâ”€â”€ Scrollbars (Auto both)                             â”‚
â”‚  â”‚   â”‚   â””â”€â”€ Background/Foreground from theme                   â”‚
â”‚  â”‚   â”‚                                                           â”‚
â”‚  â”‚   â””â”€â”€ Empty State (when !HasOpenTabs)                        â”‚
â”‚  â”‚       â”œâ”€â”€ FileCodeIcon (64x64)                               â”‚
â”‚  â”‚       â”œâ”€â”€ "No file open" title                               â”‚
â”‚  â”‚       â”œâ”€â”€ "Open a file from Explorer..." subtitle            â”‚
â”‚  â”‚       â””â”€â”€ [Open File] [New File] buttons                     â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ Resources                                                   â”‚
â”‚      â”œâ”€â”€ LanguageToIconConverter                                â”‚
â”‚      â””â”€â”€ BoolToVisibilityConverter                              â”‚
â”‚                                                                   â”‚
â”‚  EditorPanel.axaml.cs                                             â”‚
â”‚  â”œâ”€â”€ State                                                       â”‚
â”‚  â”‚   â”œâ”€â”€ _viewModel: EditorPanelViewModel?                      â”‚
â”‚  â”‚   â”œâ”€â”€ _syntaxService: SyntaxHighlightingService?             â”‚
â”‚  â”‚   â””â”€â”€ _settingsBinding: IDisposable?                         â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Initialization                                              â”‚
â”‚  â”‚   â”œâ”€â”€ OnDataContextChanged â†’ subscribe to ViewModel         â”‚
â”‚  â”‚   â””â”€â”€ Initialize(syntaxService, settings) â†’ configure       â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ ViewModel Event Handlers                                    â”‚
â”‚  â”‚   â”œâ”€â”€ OnViewModelPropertyChanged â†’ ActiveTab changed        â”‚
â”‚  â”‚   â”œâ”€â”€ OnUndoRequested â†’ Editor.Undo()                        â”‚
â”‚  â”‚   â”œâ”€â”€ OnRedoRequested â†’ Editor.Redo()                        â”‚
â”‚  â”‚   â”œâ”€â”€ OnFindRequested â†’ SearchPanel.Open()                   â”‚
â”‚  â”‚   â”œâ”€â”€ OnReplaceRequested â†’ SearchPanel.Open() (replace)      â”‚
â”‚  â”‚   â””â”€â”€ OnGoToLineRequested â†’ navigate to line                 â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Editor Event Handlers                                       â”‚
â”‚  â”‚   â”œâ”€â”€ OnCaretPositionChanged â†’ update caret position        â”‚
â”‚  â”‚   â””â”€â”€ OnSelectionChanged â†’ update selection length           â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Tab Switching                                               â”‚
â”‚  â”‚   â””â”€â”€ UpdateEditorForActiveTab()                             â”‚
â”‚  â”‚       â”œâ”€â”€ Set Editor.Document                                â”‚
â”‚  â”‚       â”œâ”€â”€ Set Editor.IsReadOnly                              â”‚
â”‚  â”‚       â””â”€â”€ Apply syntax highlighting                          â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ Keyboard Shortcuts                                          â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+S â†’ Save                                          â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+W â†’ Close Tab                                     â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+Tab â†’ Next Tab                                    â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+Shift+Tab â†’ Previous Tab                          â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+G â†’ Go to Line                                    â”‚
â”‚  â”‚   â”œâ”€â”€ Ctrl+F â†’ Find                                          â”‚
â”‚  â”‚   â””â”€â”€ Ctrl+H â†’ Replace                                       â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ Cleanup                                                     â”‚
â”‚      â””â”€â”€ OnUnloaded â†’ dispose bindings, unsubscribe             â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Diagrams

### UI Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EditorPanel Layout                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Tab Bar (Row 0, Auto)                                      â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ [ğŸ“„ main.cs] [ğŸ“„ app.tsx â€¢] [ğŸ“„ README.md] [ğŸ“„ config.json]â”‚  â”‚
â”‚  â”‚     â–² active       â–² dirty                                 â”‚  â”‚
â”‚  â”‚     â”‚              â”‚                                        â”‚  â”‚
â”‚  â”‚     â””â”€â”€ accent     â””â”€â”€ bullet indicator                    â”‚  â”‚
â”‚  â”‚         border                                              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Editor Area (Row 1, *)                                     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚  1 â”‚ using System;                                         â”‚  â”‚
â”‚  â”‚  2 â”‚ using System.Collections.Generic;                     â”‚  â”‚
â”‚  â”‚  3 â”‚                                                        â”‚  â”‚
â”‚  â”‚  4 â”‚ namespace SeniorIntern.Desktop                        â”‚  â”‚
â”‚  â”‚  5 â”‚ {                                                      â”‚  â”‚
â”‚  â”‚  6 â”‚     public class App                                  â”‚  â”‚
â”‚  â”‚  7 â”‚     {                                                  â”‚  â”‚
â”‚  â”‚  8 â”‚         â–Œ                                             â”‚  â”‚
â”‚  â”‚  9 â”‚     }                                                  â”‚  â”‚
â”‚  â”‚ 10 â”‚ }                                                      â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Empty State

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Empty State Layout                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                        â”‚   ğŸ“„    â”‚  (FileCodeIcon 64x64)        â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                                                                  â”‚
â”‚                      No file open                                â”‚
â”‚                                                                  â”‚
â”‚         Open a file from the Explorer or use Ctrl+O             â”‚
â”‚                                                                  â”‚
â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚                â”‚ Open File  â”‚  â”‚ New File   â”‚                    â”‚
â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                    primary         default                       â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Tab Switching Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Tab Switching Flow                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  User clicks tab / Ctrl+Tab                                      â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ EditorPanelViewModel.ActiveTab = newTab                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â”‚ PropertyChanged("ActiveTab")                          â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ OnViewModelPropertyChanged()                               â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ if (e.PropertyName == "ActiveTab")                         â”‚  â”‚
â”‚  â”‚     UpdateEditorForActiveTab();                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ UpdateEditorForActiveTab()                                 â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ 1. Editor.Document = activeTab.Document                    â”‚  â”‚
â”‚  â”‚ 2. Editor.IsReadOnly = activeTab.IsReadOnly               â”‚  â”‚
â”‚  â”‚ 3. _syntaxService.SetLanguage(Editor, activeTab.Language)  â”‚  â”‚
â”‚  â”‚ 4. Subscribe to Caret.PositionChanged                      â”‚  â”‚
â”‚  â”‚ 5. UpdateCaretPosition()                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  Editor now displays new tab's content with highlighting         â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Directory Structure

```
src/SeniorIntern.Desktop/
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ EditorPanel.axaml                             (NEW)
â”‚   â””â”€â”€ EditorPanel.axaml.cs                          (NEW)
â”œâ”€â”€ Converters/
â”‚   â””â”€â”€ LanguageToIconConverter.cs                    (NEW)
â”œâ”€â”€ Themes/
â”‚   â””â”€â”€ Dark.axaml                                    (MODIFY)
â””â”€â”€ Assets/
    â””â”€â”€ Icons.axaml                                   (MODIFY)
```

---

## Implementation Details

### Task 1: Create EditorPanel.axaml

**File:** `src/SeniorIntern.Desktop/Views/EditorPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ae="using:AvaloniaEdit"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:conv="using:SeniorIntern.Desktop.Converters"
             x:Class="SeniorIntern.Desktop.Views.EditorPanel"
             x:DataType="vm:EditorPanelViewModel">

    <UserControl.Resources>
        <conv:LanguageToIconConverter x:Key="LanguageIconConverter" />
    </UserControl.Resources>

    <Grid RowDefinitions="Auto, *">
        <!-- Tab Bar -->
        <Border Grid.Row="0"
                Background="{DynamicResource TabBarBackgroundBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,0,0,1"
                IsVisible="{Binding HasOpenTabs}">
            <ScrollViewer HorizontalScrollBarVisibility="Auto"
                          VerticalScrollBarVisibility="Disabled"
                          Padding="4,0">
                <ItemsControl ItemsSource="{Binding Tabs}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Horizontal" Spacing="2" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="vm:EditorTabViewModel">
                            <Button Classes="editor-tab"
                                    Classes.active="{Binding IsActive}"
                                    Classes.dirty="{Binding IsDirty}"
                                    Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).ActivateTabCommand}"
                                    CommandParameter="{Binding}"
                                    ToolTip.Tip="{Binding FilePath}">
                                <Grid ColumnDefinitions="Auto, Auto, Auto" Margin="8,4">
                                    <!-- Language Icon -->
                                    <PathIcon Grid.Column="0"
                                              Data="{Binding Language, Converter={StaticResource LanguageIconConverter}}"
                                              Width="14" Height="14"
                                              Margin="0,0,6,0"
                                              Foreground="{DynamicResource TextSecondaryBrush}" />

                                    <!-- File Name -->
                                    <TextBlock Grid.Column="1"
                                               Text="{Binding DisplayTitle}"
                                               VerticalAlignment="Center"
                                               Foreground="{DynamicResource TextPrimaryBrush}" />

                                    <!-- Close Button -->
                                    <Button Grid.Column="2"
                                            Classes="tab-close-button"
                                            Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CloseTabCommand}"
                                            CommandParameter="{Binding}"
                                            Margin="8,0,0,0"
                                            ToolTip.Tip="Close (Ctrl+W)">
                                        <PathIcon Data="{StaticResource CloseIcon}"
                                                  Width="10" Height="10" />
                                    </Button>
                                </Grid>

                                <!-- Tab Context Menu -->
                                <Button.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="Close"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CloseTabCommand}"
                                                  CommandParameter="{Binding}"
                                                  InputGesture="Ctrl+W" />
                                        <MenuItem Header="Close Others"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CloseOtherTabsCommand}"
                                                  CommandParameter="{Binding}" />
                                        <MenuItem Header="Close Tabs to the Right"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CloseTabsToRightCommand}"
                                                  CommandParameter="{Binding}" />
                                        <MenuItem Header="Close All"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CloseAllTabsCommand}" />
                                        <Separator />
                                        <MenuItem Header="Copy Path"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).CopyPathCommand}"
                                                  CommandParameter="{Binding FilePath}" />
                                        <MenuItem Header="Reveal in Explorer"
                                                  Command="{Binding $parent[UserControl].((vm:EditorPanelViewModel)DataContext).RevealInExplorerCommand}"
                                                  IsEnabled="{Binding !IsNewFile}" />
                                    </ContextMenu>
                                </Button.ContextMenu>
                            </Button>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </Border>

        <!-- Editor Area -->
        <Grid Grid.Row="1">
            <!-- TextEditor -->
            <ae:TextEditor x:Name="Editor"
                           IsVisible="{Binding ActiveTab, Converter={x:Static ObjectConverters.IsNotNull}}"
                           HorizontalScrollBarVisibility="Auto"
                           VerticalScrollBarVisibility="Auto"
                           Background="{DynamicResource EditorBackgroundBrush}"
                           Foreground="{DynamicResource EditorForegroundBrush}" />

            <!-- Empty State -->
            <StackPanel IsVisible="{Binding !HasOpenTabs}"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center"
                        Spacing="16"
                        Opacity="0.6">
                <PathIcon Data="{StaticResource FileCodeIcon}"
                          Width="64" Height="64"
                          Foreground="{DynamicResource TextMutedBrush}" />
                <TextBlock Text="No file open"
                           FontSize="18"
                           FontWeight="SemiBold"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextSecondaryBrush}" />
                <TextBlock Text="Open a file from the Explorer or use Ctrl+O"
                           HorizontalAlignment="Center"
                           Foreground="{DynamicResource TextMutedBrush}" />
                <StackPanel Orientation="Horizontal"
                            HorizontalAlignment="Center"
                            Spacing="8"
                            Margin="0,16,0,0">
                    <Button Content="Open File"
                            Command="{Binding OpenFileDialogCommand}"
                            Classes="primary" />
                    <Button Content="New File"
                            Command="{Binding NewFileCommand}" />
                </StackPanel>
            </StackPanel>
        </Grid>
    </Grid>
</UserControl>
```

### Task 2: Create EditorPanel.axaml.cs

**File:** `src/SeniorIntern.Desktop/Views/EditorPanel.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using System;
using System.ComponentModel;
using Avalonia.Controls;
using Avalonia.Input;
using Avalonia.Interactivity;
using AvaloniaEdit;
using AvaloniaEdit.Search;
using SeniorIntern.Core.Models;
using SeniorIntern.Desktop.Services;
using SeniorIntern.Desktop.ViewModels;

public partial class EditorPanel : UserControl
{
    private EditorPanelViewModel? _viewModel;
    private SyntaxHighlightingService? _syntaxService;
    private IDisposable? _settingsBinding;

    public EditorPanel()
    {
        InitializeComponent();
        DataContextChanged += OnDataContextChanged;
    }

    private void OnDataContextChanged(object? sender, EventArgs e)
    {
        // Unsubscribe from old ViewModel
        if (_viewModel != null)
        {
            _viewModel.PropertyChanged -= OnViewModelPropertyChanged;
            _viewModel.UndoRequested -= OnUndoRequested;
            _viewModel.RedoRequested -= OnRedoRequested;
            _viewModel.FindRequested -= OnFindRequested;
            _viewModel.ReplaceRequested -= OnReplaceRequested;
            _viewModel.GoToLineRequested -= OnGoToLineRequested;
        }

        _viewModel = DataContext as EditorPanelViewModel;

        if (_viewModel != null)
        {
            _viewModel.PropertyChanged += OnViewModelPropertyChanged;
            _viewModel.UndoRequested += OnUndoRequested;
            _viewModel.RedoRequested += OnRedoRequested;
            _viewModel.FindRequested += OnFindRequested;
            _viewModel.ReplaceRequested += OnReplaceRequested;
            _viewModel.GoToLineRequested += OnGoToLineRequested;

            UpdateEditorForActiveTab();
        }
    }

    private void OnViewModelPropertyChanged(object? sender, PropertyChangedEventArgs e)
    {
        if (e.PropertyName == nameof(EditorPanelViewModel.ActiveTab))
        {
            UpdateEditorForActiveTab();
        }
    }

    private void UpdateEditorForActiveTab()
    {
        var activeTab = _viewModel?.ActiveTab;

        if (activeTab == null)
        {
            Editor.Document = null;
            return;
        }

        Editor.Document = activeTab.Document;
        Editor.IsReadOnly = activeTab.IsReadOnly;

        if (_syntaxService != null)
        {
            _syntaxService.SetLanguage(Editor, activeTab.Language);
        }

        Editor.TextArea.Caret.PositionChanged += OnCaretPositionChanged;
        Editor.TextArea.SelectionChanged += OnSelectionChanged;

        UpdateCaretPosition();
    }

    private void OnCaretPositionChanged(object? sender, EventArgs e) => UpdateCaretPosition();
    private void OnSelectionChanged(object? sender, EventArgs e) => UpdateCaretPosition();

    private void UpdateCaretPosition()
    {
        if (_viewModel?.ActiveTab == null) return;

        var caret = Editor.TextArea.Caret;
        var selection = Editor.TextArea.Selection;
        var selectionLength = selection.IsEmpty ? 0 : Math.Abs(selection.Length);

        _viewModel.ActiveTab.UpdateCaretPosition(caret.Line, caret.Column, selectionLength);
    }

    public void Initialize(SyntaxHighlightingService syntaxService, AppSettings settings)
    {
        _syntaxService = syntaxService;

        EditorConfiguration.ApplySettings(Editor, settings);
        _settingsBinding?.Dispose();
        _settingsBinding = EditorConfiguration.BindToSettings(Editor, settings);
        _syntaxService.ApplyHighlighting(Editor, null);
    }

    // Event handlers
    private void OnUndoRequested(object? sender, EventArgs e) => Editor.Undo();
    private void OnRedoRequested(object? sender, EventArgs e) => Editor.Redo();

    private void OnFindRequested(object? sender, EventArgs e)
    {
        var searchPanel = SearchPanel.Install(Editor);
        searchPanel.Open();
    }

    private void OnReplaceRequested(object? sender, EventArgs e)
    {
        var searchPanel = SearchPanel.Install(Editor);
        searchPanel.Open();
        searchPanel.IsReplaceMode = true;
    }

    private void OnGoToLineRequested(object? sender, int lineNumber)
    {
        if (_viewModel?.ActiveTab == null) return;

        var offset = _viewModel.ActiveTab.GetOffsetForLine(lineNumber);
        Editor.TextArea.Caret.Offset = offset;
        Editor.TextArea.Caret.BringCaretToView();
        Editor.Focus();
    }

    protected override void OnKeyDown(KeyEventArgs e)
    {
        base.OnKeyDown(e);

        if (e.KeyModifiers == KeyModifiers.Control)
        {
            switch (e.Key)
            {
                case Key.S:
                    _viewModel?.SaveCommand.Execute(null);
                    e.Handled = true;
                    break;
                case Key.W:
                    if (_viewModel?.ActiveTab != null)
                        _viewModel.CloseTabCommand.Execute(_viewModel.ActiveTab);
                    e.Handled = true;
                    break;
                case Key.Tab:
                    if (e.KeyModifiers.HasFlag(KeyModifiers.Shift))
                        _viewModel?.PreviousTabCommand.Execute(null);
                    else
                        _viewModel?.NextTabCommand.Execute(null);
                    e.Handled = true;
                    break;
                case Key.G:
                    _viewModel?.GoToLineCommand.Execute(null);
                    e.Handled = true;
                    break;
                case Key.F:
                    _viewModel?.FindCommand.Execute(null);
                    e.Handled = true;
                    break;
                case Key.H:
                    _viewModel?.ReplaceCommand.Execute(null);
                    e.Handled = true;
                    break;
            }
        }
    }

    protected override void OnUnloaded(RoutedEventArgs e)
    {
        base.OnUnloaded(e);

        _settingsBinding?.Dispose();
        _syntaxService?.RemoveHighlighting(Editor);

        if (_viewModel != null)
        {
            _viewModel.PropertyChanged -= OnViewModelPropertyChanged;
            _viewModel.UndoRequested -= OnUndoRequested;
            _viewModel.RedoRequested -= OnRedoRequested;
            _viewModel.FindRequested -= OnFindRequested;
            _viewModel.ReplaceRequested -= OnReplaceRequested;
            _viewModel.GoToLineRequested -= OnGoToLineRequested;
        }
    }
}
```

### Task 3: Create LanguageToIconConverter

**File:** `src/SeniorIntern.Desktop/Converters/LanguageToIconConverter.cs`

```csharp
namespace SeniorIntern.Desktop.Converters;

using System;
using System.Globalization;
using Avalonia.Data.Converters;
using Avalonia.Media;

/// <summary>
/// Converts a language identifier to an icon geometry.
/// </summary>
public class LanguageToIconConverter : IValueConverter
{
    public static LanguageToIconConverter Instance { get; } = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        var language = value as string;

        // Return icon key based on language
        // Icons should be defined in Icons.axaml
        return language?.ToLowerInvariant() switch
        {
            "csharp" => GetGeometry("CSharpIcon"),
            "javascript" or "javascriptreact" => GetGeometry("JavaScriptIcon"),
            "typescript" or "typescriptreact" => GetGeometry("TypeScriptIcon"),
            "python" => GetGeometry("PythonIcon"),
            "html" => GetGeometry("HtmlIcon"),
            "css" or "scss" or "less" => GetGeometry("CssIcon"),
            "json" or "jsonc" => GetGeometry("JsonIcon"),
            "markdown" => GetGeometry("MarkdownIcon"),
            "xml" => GetGeometry("XmlIcon"),
            "yaml" or "toml" => GetGeometry("ConfigIcon"),
            "rust" => GetGeometry("RustIcon"),
            "go" => GetGeometry("GoIcon"),
            "java" or "kotlin" => GetGeometry("JavaIcon"),
            "shellscript" or "bash" or "powershell" => GetGeometry("TerminalIcon"),
            "dockerfile" => GetGeometry("DockerIcon"),
            _ => GetGeometry("FileIcon") // Default file icon
        };
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }

    private static Geometry? GetGeometry(string resourceKey)
    {
        if (Avalonia.Application.Current?.TryFindResource(resourceKey, out var resource) == true)
            return resource as Geometry;
        return null;
    }
}
```

### Task 4: Add Tab Bar Styles to Dark.axaml

**File:** `src/SeniorIntern.Desktop/Themes/Dark.axaml` (additions)

```xml
<!-- Tab Bar Colors -->
<SolidColorBrush x:Key="TabBarBackgroundBrush" Color="#252526" />
<SolidColorBrush x:Key="TabActiveBackgroundBrush" Color="#1E1E1E" />
<SolidColorBrush x:Key="TabHoverBackgroundBrush" Color="#2D2D2D" />

<!-- Editor Colors -->
<SolidColorBrush x:Key="EditorBackgroundBrush" Color="#1E1E1E" />
<SolidColorBrush x:Key="EditorForegroundBrush" Color="#D4D4D4" />

<!-- Editor Tab Button Style -->
<Style Selector="Button.editor-tab">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Padding" Value="0" />
    <Setter Property="CornerRadius" Value="0" />
    <Setter Property="MinHeight" Value="35" />
</Style>

<Style Selector="Button.editor-tab:pointerover">
    <Setter Property="Background" Value="{DynamicResource TabHoverBackgroundBrush}" />
</Style>

<Style Selector="Button.editor-tab.active">
    <Setter Property="Background" Value="{DynamicResource TabActiveBackgroundBrush}" />
</Style>

<Style Selector="Button.editor-tab.active /template/ ContentPresenter">
    <Setter Property="BorderThickness" Value="0,0,0,2" />
    <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}" />
</Style>

<!-- Tab Close Button -->
<Style Selector="Button.tab-close-button">
    <Setter Property="Background" Value="Transparent" />
    <Setter Property="BorderThickness" Value="0" />
    <Setter Property="Padding" Value="4" />
    <Setter Property="CornerRadius" Value="4" />
    <Setter Property="Opacity" Value="0.5" />
</Style>

<Style Selector="Button.tab-close-button:pointerover">
    <Setter Property="Background" Value="{DynamicResource HoverBackgroundBrush}" />
    <Setter Property="Opacity" Value="1" />
</Style>
```

---

## Keyboard Shortcuts Reference

| Shortcut | Action | Handler |
|----------|--------|---------|
| Ctrl+S | Save active tab | `SaveCommand` |
| Ctrl+W | Close active tab | `CloseTabCommand` |
| Ctrl+Tab | Next tab | `NextTabCommand` |
| Ctrl+Shift+Tab | Previous tab | `PreviousTabCommand` |
| Ctrl+G | Go to line | `GoToLineCommand` |
| Ctrl+F | Find | `FindCommand` |
| Ctrl+H | Replace | `ReplaceCommand` |
| Ctrl+Z | Undo | `Editor.Undo()` |
| Ctrl+Y | Redo | `Editor.Redo()` |

---

## Unit Testing Requirements

| Component | Test Count | Focus Areas |
|-----------|------------|-------------|
| Tab switching | 3 | Active tab display, document bind, language |
| Keyboard shortcuts | 7 | Each shortcut handled |
| Empty state | 2 | Visibility, button commands |
| Caret position | 2 | Update on move, selection display |
| Initialize | 2 | Settings applied, syntax service set |
| DataContext change | 2 | Subscribe, unsubscribe |
| OnUnloaded | 2 | Cleanup, disposal |
| LanguageToIconConverter | 4 | Known languages, unknown, null |
| **Total** | **24** | |

---

## Files Summary

### Files to Create (3)

| File | Lines |
|------|-------|
| `Views/EditorPanel.axaml` | 120 |
| `Views/EditorPanel.axaml.cs` | 140 |
| `Converters/LanguageToIconConverter.cs` | 50 |

### Files to Modify (2)

| File | Changes |
|------|---------|
| `Themes/Dark.axaml` | Add tab bar and editor styles |
| `Assets/Icons.axaml` | Add CloseIcon, FileCodeIcon, language icons |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | Tab bar displays all open tabs |
| AC-2 | Active tab is visually distinguished (accent border) |
| AC-3 | Dirty indicator (â€¢) shows on modified tabs |
| AC-4 | Tab close button closes tab with prompt if dirty |
| AC-5 | Tab context menu shows with all options |
| AC-6 | Empty state displays when no tabs open |
| AC-7 | Editor displays active tab content |
| AC-8 | Syntax highlighting applied based on language |
| AC-9 | Keyboard shortcuts work (Ctrl+S, Ctrl+W, etc.) |
| AC-10 | Caret position updates in status bar |

---

## Dependencies

| Part | Dependency Description |
|------|------------------------|
| v0.3.3a | EditorTabViewModel |
| v0.3.3b | EditorPanelViewModel |
| v0.3.3c | SyntaxHighlightingService |
| v0.3.3d | EditorConfiguration |
| AvaloniaEdit | TextEditor, SearchPanel |

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.3.3e | 1 day |
