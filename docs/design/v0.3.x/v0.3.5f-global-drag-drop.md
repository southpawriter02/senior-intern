# Design Specification: The Senior Intern v0.3.5f "Global Drag-Drop"

## Executive Summary

This document provides a detailed implementation specification for v0.3.5f, which implements drag-and-drop support for files and folders across the main application window. Users can drag files or folders from the system file manager onto the application to open them - folders open as workspaces, files open in the editor.

### v0.3.5f Scope

- Add drag-drop event handlers to MainWindow
- Detect whether dropped items are files or folders
- Open folders as workspaces
- Open files in editor tabs
- Support multiple file drops (open all as tabs)
- Show visual drop overlay during drag
- Display contextual message ("Open as workspace" vs "Open N file(s)")
- Reject invalid drop types gracefully

### Key Deliverables

| Deliverable | Description |
|-------------|-------------|
| DragEnter handler | Show overlay on drag enter |
| DragLeave handler | Hide overlay on drag leave |
| DragOver handler | Update message based on content |
| Drop handler | Process files/folders |
| Drop overlay | Visual feedback during drag |
| DropIcon | Icon for overlay display |

---

## Feature Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     v0.3.5f Feature Tree                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  MainWindow Drag-Drop Handlers                                    â”‚
â”‚  â”œâ”€â”€ InitializeDragDrop()                                        â”‚
â”‚  â”‚   â”œâ”€â”€ AddHandler(DragDrop.DragEnterEvent, ...)               â”‚
â”‚  â”‚   â”œâ”€â”€ AddHandler(DragDrop.DragLeaveEvent, ...)               â”‚
â”‚  â”‚   â”œâ”€â”€ AddHandler(DragDrop.DragOverEvent, ...)                â”‚
â”‚  â”‚   â””â”€â”€ AddHandler(DragDrop.DropEvent, ...)                    â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ OnDragEnter(sender, DragEventArgs)                          â”‚
â”‚  â”‚   â”œâ”€â”€ Check e.Data.Contains(DataFormats.FileNames)           â”‚
â”‚  â”‚   â””â”€â”€ ShowDropOverlay(true)                                  â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ OnDragLeave(sender, DragEventArgs)                          â”‚
â”‚  â”‚   â””â”€â”€ ShowDropOverlay(false)                                 â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ OnDragOver(sender, DragEventArgs)                           â”‚
â”‚  â”‚   â”œâ”€â”€ Get files = e.Data.GetFileNames()                      â”‚
â”‚  â”‚   â”œâ”€â”€ Detect hasFolder = files.Any(Directory.Exists)         â”‚
â”‚  â”‚   â”œâ”€â”€ Detect hasFiles = files.Any(File.Exists)               â”‚
â”‚  â”‚   â”œâ”€â”€ If folder: DragEffects.Link, "Open as workspace"       â”‚
â”‚  â”‚   â”œâ”€â”€ If files: DragEffects.Copy, "Open N file(s)"           â”‚
â”‚  â”‚   â””â”€â”€ Else: DragEffects.None                                 â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ OnDrop(sender, DragEventArgs)                               â”‚
â”‚  â”‚   â”œâ”€â”€ ShowDropOverlay(false)                                 â”‚
â”‚  â”‚   â”œâ”€â”€ Get files from data                                    â”‚
â”‚  â”‚   â”œâ”€â”€ Find folders â†’ OpenWorkspaceAsync(first folder)        â”‚
â”‚  â”‚   â””â”€â”€ Find files â†’ OpenFileAsync(each file)                  â”‚
â”‚  â”‚                                                                â”‚
â”‚  â”œâ”€â”€ ShowDropOverlay(bool show)                                  â”‚
â”‚  â”‚   â””â”€â”€ DropOverlay.IsVisible = show                           â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ UpdateDropOverlay(string message)                           â”‚
â”‚      â””â”€â”€ DropOverlayText.Text = message                         â”‚
â”‚                                                                   â”‚
â”‚  Drop Overlay (XAML)                                              â”‚
â”‚  â”œâ”€â”€ Outer Border                                                â”‚
â”‚  â”‚   â”œâ”€â”€ Grid.RowSpan="3" (covers entire window)                â”‚
â”‚  â”‚   â”œâ”€â”€ Background="#CC1E1E1E" (semi-transparent)              â”‚
â”‚  â”‚   â”œâ”€â”€ IsVisible="{Binding ElementName=...}"                  â”‚
â”‚  â”‚   â”œâ”€â”€ IsHitTestVisible="False"                               â”‚
â”‚  â”‚   â””â”€â”€ ZIndex="1000"                                          â”‚
â”‚  â”‚                                                                â”‚
â”‚  â””â”€â”€ Inner Border                                                â”‚
â”‚      â”œâ”€â”€ Background="#402196F3" (blue tint)                     â”‚
â”‚      â”œâ”€â”€ BorderBrush="#2196F3" (blue)                           â”‚
â”‚      â”œâ”€â”€ BorderThickness="3"                                    â”‚
â”‚      â”œâ”€â”€ CornerRadius="12"                                      â”‚
â”‚      â”œâ”€â”€ Margin="24"                                            â”‚
â”‚      â””â”€â”€ Content (StackPanel)                                   â”‚
â”‚          â”œâ”€â”€ DropIcon (48x48)                                   â”‚
â”‚          â””â”€â”€ DropOverlayText ("Drop to open")                   â”‚
â”‚                                                                   â”‚
â”‚  Drop Types                                                       â”‚
â”‚  â”œâ”€â”€ Folder â†’ Open as workspace (first folder wins)             â”‚
â”‚  â”œâ”€â”€ Files â†’ Open in editor tabs                                â”‚
â”‚  â”œâ”€â”€ Mixed â†’ Folder takes priority, files also opened           â”‚
â”‚  â””â”€â”€ Invalid â†’ DragEffects.None, no overlay update              â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Architecture Diagrams

### Drop Overlay Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Drop Overlay Layout                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                             â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                             â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                    ðŸ“¥                       â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                             â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚            Open as workspace                â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚               - or -                        â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚             Open 3 file(s)                  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                             â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚                                             â”‚â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â”‚  â–‘ = Semi-transparent dark overlay (#CC1E1E1E)                   â”‚
â”‚  Blue border = Active drop zone (#2196F3)                        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Drag-Drop Event Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Drag-Drop Event Flow                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  User drags file(s)/folder(s) from system file manager          â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ DragEnter event                                            â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ if (e.Data.Contains(DataFormats.FileNames))                â”‚  â”‚
â”‚  â”‚     ShowDropOverlay(true);                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼ Mouse moves over window                               â”‚
â”‚         â”‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ DragOver event (fires continuously)                        â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ var files = e.Data.GetFileNames()?.ToList();               â”‚  â”‚
â”‚  â”‚ var hasFolder = files.Any(Directory.Exists);               â”‚  â”‚
â”‚  â”‚ var hasFiles = files.Any(File.Exists);                     â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ if (hasFolder)                                             â”‚  â”‚
â”‚  â”‚     e.DragEffects = DragDropEffects.Link;                  â”‚  â”‚
â”‚  â”‚     UpdateDropOverlay("Open as workspace");                â”‚  â”‚
â”‚  â”‚ else if (hasFiles)                                         â”‚  â”‚
â”‚  â”‚     e.DragEffects = DragDropEffects.Copy;                  â”‚  â”‚
â”‚  â”‚     UpdateDropOverlay($"Open {files.Count} file(s)");      â”‚  â”‚
â”‚  â”‚ else                                                        â”‚  â”‚
â”‚  â”‚     e.DragEffects = DragDropEffects.None;                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”                                              â”‚
â”‚    â–¼             â–¼                                              â”‚
â”‚ [Released]   [Left window]                                      â”‚
â”‚    â”‚             â”‚                                               â”‚
â”‚    â–¼             â–¼                                               â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                       â”‚
â”‚ â”‚ Drop     â”‚ â”‚ DragLeaveâ”‚                                       â”‚
â”‚ â”‚ event    â”‚ â”‚ event    â”‚                                       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                       â”‚
â”‚    â”‚             â”‚                                               â”‚
â”‚    â–¼             â–¼                                               â”‚
â”‚ Process     ShowDropOverlay(false)                              â”‚
â”‚ files                                                           â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Drop Processing Logic

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Drop Processing Logic                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  OnDrop(sender, DragEventArgs e)                                 â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ShowDropOverlay(false);                                    â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ var files = e.Data.GetFileNames()?.ToList();               â”‚  â”‚
â”‚  â”‚ if (files == null || files.Count == 0) return;             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Process Folders                                            â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ var folders = files.Where(Directory.Exists).ToList();      â”‚  â”‚
â”‚  â”‚ if (folders.Count > 0)                                     â”‚  â”‚
â”‚  â”‚ {                                                           â”‚  â”‚
â”‚  â”‚     await viewModel.OpenWorkspaceAsync(folders[0]);        â”‚  â”‚
â”‚  â”‚     // Only first folder opens as workspace                â”‚  â”‚
â”‚  â”‚     // (could notify user about additional folders)        â”‚  â”‚
â”‚  â”‚ }                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                                                        â”‚
â”‚         â–¼                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Process Files                                              â”‚  â”‚
â”‚  â”‚                                                             â”‚  â”‚
â”‚  â”‚ var fileList = files.Where(File.Exists).ToList();          â”‚  â”‚
â”‚  â”‚ foreach (var file in fileList)                             â”‚  â”‚
â”‚  â”‚ {                                                           â”‚  â”‚
â”‚  â”‚     await viewModel.EditorPanel.OpenFileAsync(file);       â”‚  â”‚
â”‚  â”‚     // Each file opens in a new tab                        â”‚  â”‚
â”‚  â”‚ }                                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â”‚
â”‚                                                                  â”‚
â”‚  Drop Scenarios:                                                 â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Dropped Items   â”‚ Action                                     â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ 1 folder        â”‚ Open folder as workspace                  â”‚ â”‚
â”‚  â”‚ 3 files         â”‚ Open 3 tabs in editor                     â”‚ â”‚
â”‚  â”‚ 1 folder +      â”‚ Open folder as workspace +                â”‚ â”‚
â”‚  â”‚ 2 files         â”‚ open 2 tabs in editor                     â”‚ â”‚
â”‚  â”‚ 2 folders       â”‚ Open first folder as workspace            â”‚ â”‚
â”‚  â”‚                 â”‚ (ignore second)                           â”‚ â”‚
â”‚  â”‚ Invalid         â”‚ DragEffects.None, no action               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Directory Structure

```
src/SeniorIntern.Desktop/
â”œâ”€â”€ Views/
â”‚   â”œâ”€â”€ MainWindow.axaml                              (MODIFY)
â”‚   â””â”€â”€ MainWindow.axaml.cs                           (MODIFY)
â””â”€â”€ Assets/
    â””â”€â”€ Icons.axaml                                   (MODIFY)
```

---

## Implementation Details

### Task 1: Add Drag-Drop Handlers to MainWindow.axaml.cs

**File:** `src/SeniorIntern.Desktop/Views/MainWindow.axaml.cs` (additions)

```csharp
// Add to MainWindow constructor or initialization
private void InitializeDragDrop()
{
    AddHandler(DragDrop.DragEnterEvent, OnDragEnter);
    AddHandler(DragDrop.DragLeaveEvent, OnDragLeave);
    AddHandler(DragDrop.DragOverEvent, OnDragOver);
    AddHandler(DragDrop.DropEvent, OnDrop);
}

private void OnDragEnter(object? sender, DragEventArgs e)
{
    if (e.Data.Contains(DataFormats.FileNames))
    {
        ShowDropOverlay(true);
    }
}

private void OnDragLeave(object? sender, DragEventArgs e)
{
    ShowDropOverlay(false);
}

private void OnDragOver(object? sender, DragEventArgs e)
{
    if (!e.Data.Contains(DataFormats.FileNames))
    {
        e.DragEffects = DragDropEffects.None;
        return;
    }

    var files = e.Data.GetFileNames()?.ToList();
    if (files == null || files.Count == 0)
    {
        e.DragEffects = DragDropEffects.None;
        return;
    }

    // Determine if dropping folders or files
    var hasFolder = files.Any(Directory.Exists);
    var hasFiles = files.Any(File.Exists);

    if (hasFolder)
    {
        e.DragEffects = DragDropEffects.Link;
        UpdateDropOverlay("Open as workspace");
    }
    else if (hasFiles)
    {
        var count = files.Count(File.Exists);
        e.DragEffects = DragDropEffects.Copy;
        UpdateDropOverlay(count == 1 
            ? $"Open {Path.GetFileName(files.First(File.Exists))}" 
            : $"Open {count} files");
    }
    else
    {
        e.DragEffects = DragDropEffects.None;
    }
}

private async void OnDrop(object? sender, DragEventArgs e)
{
    ShowDropOverlay(false);

    if (!e.Data.Contains(DataFormats.FileNames)) return;

    var files = e.Data.GetFileNames()?.ToList();
    if (files == null || files.Count == 0) return;

    var viewModel = DataContext as MainWindowViewModel;
    if (viewModel == null) return;

    // Process folders first (open as workspace)
    var folders = files.Where(Directory.Exists).ToList();
    if (folders.Count > 0)
    {
        // Open the first folder as workspace
        await viewModel.OpenWorkspaceAsync(folders[0]);

        // Note: If multiple folders dropped, only first is opened
    }

    // Process files (open in editor)
    var fileList = files.Where(File.Exists).ToList();
    foreach (var file in fileList)
    {
        await viewModel.EditorPanel.OpenFileAsync(file);
    }
}

private void ShowDropOverlay(bool show)
{
    DropOverlay.IsVisible = show;
}

private void UpdateDropOverlay(string message)
{
    DropOverlayText.Text = message;
}
```

### Task 2: Add Drop Overlay to MainWindow.axaml

**File:** `src/SeniorIntern.Desktop/Views/MainWindow.axaml` (additions)

```xml
<!-- Add at the end of the main Grid, after all other content -->

<!-- Drop Overlay -->
<Border x:Name="DropOverlay"
        Grid.RowSpan="3"
        Background="#CC1E1E1E"
        IsVisible="False"
        IsHitTestVisible="False"
        ZIndex="1000">
    <Border Background="#402196F3"
            BorderBrush="#2196F3"
            BorderThickness="3"
            CornerRadius="12"
            Margin="24"
            Padding="32">
        <StackPanel HorizontalAlignment="Center"
                    VerticalAlignment="Center"
                    Spacing="16">
            <PathIcon Data="{StaticResource DropIcon}"
                      Width="48" Height="48"
                      Foreground="#2196F3" />
            <TextBlock x:Name="DropOverlayText"
                       Text="Drop to open"
                       FontSize="18"
                       FontWeight="SemiBold"
                       Foreground="#2196F3"
                       HorizontalAlignment="Center" />
        </StackPanel>
    </Border>
</Border>
```

### Task 3: Add DropIcon

**File:** `src/SeniorIntern.Desktop/Assets/Icons.axaml` (additions)

```xml
<!-- Drop Icon (Download/Import arrow) -->
<StreamGeometry x:Key="DropIcon">M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z</StreamGeometry>
```

---

## DragDropEffects Mapping

| Dropped Content | Effect | Cursor Hint |
|-----------------|--------|-------------|
| Folder(s) | Link | Shortcut cursor |
| File(s) | Copy | Copy cursor |
| Mixed (folder + files) | Link | Shortcut cursor |
| Invalid/unsupported | None | Not allowed cursor |

---

## Overlay Messages

| Scenario | Message |
|----------|---------|
| Single folder | "Open as workspace" |
| Multiple folders | "Open as workspace" |
| Single file | "Open {filename}" |
| Multiple files | "Open {N} files" |
| Mixed | "Open as workspace" |
| Default/pending | "Drop to open" |

---

## Unit Testing Requirements

| Component | Test Count | Focus Areas |
|-----------|------------|-------------|
| OnDragEnter | 2 | Shows overlay, no show for invalid |
| OnDragLeave | 1 | Hides overlay |
| OnDragOver (folder) | 2 | Sets Link effect, correct message |
| OnDragOver (files) | 3 | Sets Copy effect, single/multi message |
| OnDragOver (mixed) | 1 | Folder takes priority |
| OnDragOver (invalid) | 1 | Sets None effect |
| OnDrop (folder) | 2 | Opens workspace, first only |
| OnDrop (files) | 2 | Opens all files as tabs |
| OnDrop (mixed) | 1 | Opens workspace + files |
| **Total** | **17** | |

---

## Files Summary

### Files to Create (0)

(None - all changes are modifications)

### Files to Modify (3)

| File | Changes |
|------|---------|
| `Views/MainWindow.axaml` | Add drop overlay Border |
| `Views/MainWindow.axaml.cs` | Add drag-drop event handlers |
| `Assets/Icons.axaml` | Add DropIcon |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | Drop overlay appears when dragging files/folders into window |
| AC-2 | Drop overlay disappears when dragging out of window |
| AC-3 | Dropping a folder opens it as workspace |
| AC-4 | Dropping files opens them in editor tabs |
| AC-5 | Multiple files open as multiple tabs |
| AC-6 | Mixed drop (folder + files) opens workspace + tabs |
| AC-7 | Overlay shows "Open as workspace" for folders |
| AC-8 | Overlay shows "Open N file(s)" for files |
| AC-9 | Invalid drops show not-allowed cursor |
| AC-10 | Overlay is visually appealing with blue highlight |

---

## Dependencies

| Part | Dependency Description |
|------|------------------------|
| MainWindowViewModel | For OpenWorkspaceAsync method |
| EditorPanelViewModel | For OpenFileAsync method |
| DataFormats | Avalonia drag-drop data formats |

---

## Edge Cases

| Scenario | Behavior |
|----------|----------|
| Drop 2 folders | First folder opens, second ignored |
| Drop folder + files | Folder opens as workspace, files open as tabs |
| Drop symbolic link to folder | Treated as folder |
| Drop .lnk file (Windows) | Treated as file (not resolved) |
| Drop while processing | Queue or ignore (TBD) |
| Drop unsupported format (text, image) | DragEffects.None |

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.3.5f | 0.5 day |
