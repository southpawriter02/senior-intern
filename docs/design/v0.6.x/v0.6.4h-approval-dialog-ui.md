# Design Specification: AIntern v0.6.4h "Approval Dialog UI"

## Overview

**Version**: v0.6.4h
**Parent**: v0.6.4 Safety & Approval
**Focus**: Approval dialog presenting tool call requests with risk visualization

### Purpose

Design and implement the approval dialog that:
1. Presents tool call requests to users clearly
2. Visualizes risk level with color-coded badges
3. Lists risk factors contributing to the assessment
4. Shows execution summary and parameters
5. Provides remember options for convenience
6. Supports keyboard shortcuts for efficiency
7. Displays countdown timer for timeout awareness

### Dependencies

**From v0.6.4b (Risk Classification Engine)**:
- `RiskClassificationResult`, `RiskFactor`
- `RiskLevel`

**From v0.6.4c (Permission Check System)**:
- `ApprovalDecision`, `RememberOption`

**From v0.6.4d (IPermissionManager Interface)**:
- `ApprovalRequestedEventArgs`

**From v0.6.1 (Tool Framework)**:
- `ITool`, `ToolCategory`, `ToolCallRequest`

**From Existing UI Layer**:
- Avalonia Window infrastructure
- ViewModelBase
- Theme resources

---

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    v0.6.4h Approval Dialog UI Architecture                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Dialog Structure:                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ToolApprovalDialog                                â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                    Header (Row 0)                                  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Risk    â”‚  â”‚  Tool Name               â”‚  â”‚  Timeout        â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  Badge   â”‚  â”‚  Category â€¢ Risk Level   â”‚  â”‚  Countdown      â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  (Icon)  â”‚  â”‚                          â”‚  â”‚  Progress Bar   â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  Execution Summary (Row 1)                         â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  "This action will:"                                              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  [Write to file: /path/to/file.txt]                              â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  Risk Factors (Row 2, conditional)                 â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â— File operation in protected path                              â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â— Write operation detected                                      â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  Parameters Expander (Row 3)                       â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â–¼ View parameters                                                â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  { "path": "...", "content": "..." }                        â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â”‚                                      [Edit] / [Done]        â”‚  â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  Remember Options (Row 4)                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â˜ Remember for this session                                     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  â˜ Always allow this tool                                        â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚                  Action Buttons (Row 5)                            â”‚  â”‚ â”‚
â”‚  â”‚  â”‚  [Enter to allow, Esc to deny]        [Deny]   [Allow (accent)]  â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                          â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Risk Level Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Risk Level Visualization                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Risk Badge Colors:                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Risk Level  â”‚ Color     â”‚ Hex        â”‚ Description                       â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ Safe        â”‚ Green     â”‚ #22C55E    â”‚ Read-only, no side effects        â”‚â”‚
â”‚  â”‚ Low         â”‚ Lime      â”‚ #84CC16    â”‚ Minor side effects, reversible    â”‚â”‚
â”‚  â”‚ Medium      â”‚ Amber     â”‚ #F59E0B    â”‚ Moderate risk, needs attention    â”‚â”‚
â”‚  â”‚ High        â”‚ Red       â”‚ #EF4444    â”‚ High risk, destructive potential  â”‚â”‚
â”‚  â”‚ Critical    â”‚ Dark Red  â”‚ #7C2D12    â”‚ Critical, system-level danger     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  Risk Icons:                                                                 â”‚
â”‚  â”œâ”€â”€ Safe     â†’ âœ“  (CheckCircle)                                            â”‚
â”‚  â”œâ”€â”€ Low      â†’ â„¹  (InfoCircle)                                             â”‚
â”‚  â”œâ”€â”€ Medium   â†’ âš   (AlertTriangle)                                          â”‚
â”‚  â”œâ”€â”€ High     â†’ âš   (AlertCircle)                                            â”‚
â”‚  â””â”€â”€ Critical â†’ ðŸ›¡  (ShieldAlert)                                            â”‚
â”‚                                                                              â”‚
â”‚  Badge Layout:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚   56 x 56     â”‚  Circular badge with centered icon                       â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”     â”‚                                                          â”‚
â”‚  â”‚   â”‚ âš   â”‚     â”‚  24x24 white icon on colored background                 â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”˜     â”‚                                                          â”‚
â”‚  â”‚               â”‚                                                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Timeout Visualization

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Timeout Countdown Display                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Display Format:                                                             â”‚
â”‚  â”œâ”€â”€ > 60 seconds: "1:30" (minutes:seconds)                                 â”‚
â”‚  â””â”€â”€ â‰¤ 60 seconds: "45s" (seconds only)                                     â”‚
â”‚                                                                              â”‚
â”‚  Progress Bar:                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  100%                                                                    â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  Green (#22C55E)          â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  75%                                                                     â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Green (#22C55E)          â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  50%                                                                     â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Green (#22C55E)          â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  45%                                                                     â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Orange (#F59E0B)         â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  25%                                                                     â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Orange (#F59E0B)         â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â”‚  10%                                                                     â”‚â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  Red (#EF4444)            â”‚â”‚
â”‚  â”‚                                                                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                              â”‚
â”‚  Color Thresholds:                                                           â”‚
â”‚  â”œâ”€â”€ > 50%: Green (plenty of time)                                          â”‚
â”‚  â”œâ”€â”€ 25-50%: Orange (warning)                                               â”‚
â”‚  â””â”€â”€ < 25%: Red (urgent)                                                    â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Specifications

### 1. ToolApprovalDialog.axaml

**Location**: `src/SeniorIntern.Desktop/Views/Dialogs/ToolApprovalDialog.axaml`

```xml
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
        xmlns:converters="using:SeniorIntern.Desktop.Converters"
        x:Class="SeniorIntern.Desktop.Views.Dialogs.ToolApprovalDialog"
        x:DataType="vm:ToolApprovalViewModel"
        Title="Tool Execution Request"
        Width="520"
        SizeToContent="Height"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        ShowInTaskbar="False"
        SystemDecorations="BorderOnly">

    <Window.Resources>
        <converters:RiskLevelBrushConverter x:Key="RiskLevelBrushConverter" />
    </Window.Resources>

    <Window.Styles>
        <StyleInclude Source="/Styles/ApprovalDialogStyles.axaml" />
    </Window.Styles>

    <Window.KeyBindings>
        <KeyBinding Command="{Binding AllowCommand}" Gesture="Enter" />
        <KeyBinding Command="{Binding DenyCommand}" Gesture="Escape" />
    </Window.KeyBindings>

    <Border Classes="dialog-container" Padding="24">
        <Grid RowDefinitions="Auto, Auto, Auto, Auto, Auto, Auto">

            <!-- Row 0: Header with Risk Indicator -->
            <Grid ColumnDefinitions="Auto, *, Auto" Margin="0,0,0,16">

                <!-- Risk Level Badge -->
                <Border Classes="risk-badge"
                        Classes.safe="{Binding IsSafe}"
                        Classes.low="{Binding IsLow}"
                        Classes.medium="{Binding IsMedium}"
                        Classes.high="{Binding IsHigh}"
                        Classes.critical="{Binding IsCritical}"
                        Width="56" Height="56" CornerRadius="28">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <PathIcon Data="{Binding RiskIconData}"
                                  Width="24" Height="24"
                                  Foreground="White" />
                    </StackPanel>
                </Border>

                <!-- Tool Info -->
                <StackPanel Grid.Column="1" Margin="16,0" VerticalAlignment="Center">
                    <TextBlock Text="{Binding ToolName}"
                               FontSize="20"
                               FontWeight="SemiBold" />
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="{Binding CategoryText}"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextMuted}" />
                        <TextBlock Text="â€¢"
                                   FontSize="12"
                                   Foreground="{DynamicResource TextMuted}" />
                        <TextBlock Text="{Binding RiskLevelText}"
                                   FontSize="12"
                                   Foreground="{Binding RiskLevelBrush}"
                                   FontWeight="SemiBold" />
                    </StackPanel>
                </StackPanel>

                <!-- Timeout Indicator -->
                <StackPanel Grid.Column="2" VerticalAlignment="Center" HorizontalAlignment="Right">
                    <TextBlock Text="{Binding TimeoutText}"
                               FontSize="12"
                               Foreground="{DynamicResource TextMuted}"
                               HorizontalAlignment="Right" />
                    <ProgressBar Value="{Binding TimeoutProgress}"
                                 Maximum="100"
                                 Height="3"
                                 Width="60"
                                 Foreground="{Binding TimeoutBrush}" />
                </StackPanel>
            </Grid>

            <!-- Row 1: Execution Summary -->
            <Border Grid.Row="1"
                    Classes="summary-box"
                    Padding="16"
                    Margin="0,0,0,16">
                <Grid RowDefinitions="Auto, Auto">
                    <TextBlock Text="This action will:"
                               FontSize="12"
                               Foreground="{DynamicResource TextMuted}"
                               Margin="0,0,0,8" />
                    <TextBlock Grid.Row="1"
                               Text="{Binding ExecutionSummary}"
                               TextWrapping="Wrap"
                               FontFamily="{DynamicResource MonoFont}"
                               FontSize="14" />
                </Grid>
            </Border>

            <!-- Row 2: Risk Factors (conditional) -->
            <Border Grid.Row="2"
                    Classes="risk-factors-box"
                    IsVisible="{Binding HasRiskFactors}"
                    Padding="16"
                    Margin="0,0,0,16">
                <StackPanel>
                    <TextBlock Text="Risk factors:"
                               FontSize="12"
                               FontWeight="SemiBold"
                               Margin="0,0,0,8" />
                    <ItemsControl ItemsSource="{Binding RiskFactors}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Grid ColumnDefinitions="Auto, *" Margin="0,4">
                                    <Ellipse Width="8" Height="8"
                                             Fill="{Binding Contribution, 
                                                    Converter={StaticResource RiskLevelBrushConverter}}"
                                             Margin="0,5,12,0"
                                             VerticalAlignment="Top" />
                                    <TextBlock Grid.Column="1"
                                               Text="{Binding Description}"
                                               TextWrapping="Wrap"
                                               FontSize="13" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <!-- Row 3: Parameters Expander -->
            <Expander Grid.Row="3"
                      Header="View parameters"
                      IsExpanded="{Binding IsDetailsExpanded}"
                      Margin="0,0,0,16">
                <Border Classes="details-box" Padding="12">
                    <Grid RowDefinitions="Auto, Auto">
                        <TextBox Text="{Binding ParametersJson}"
                                 IsReadOnly="{Binding !IsEditingParameters}"
                                 AcceptsReturn="True"
                                 FontFamily="{DynamicResource MonoFont}"
                                 FontSize="12"
                                 MaxHeight="200"
                                 TextWrapping="Wrap"
                                 Classes.editing="{Binding IsEditingParameters}" />

                        <StackPanel Grid.Row="1"
                                    Orientation="Horizontal"
                                    HorizontalAlignment="Right"
                                    Margin="0,8,0,0"
                                    IsVisible="{Binding CanEditParameters}">
                            <Button Content="{Binding EditButtonText}"
                                    Command="{Binding ToggleEditCommand}"
                                    Classes="link-button" />
                        </StackPanel>
                    </Grid>
                </Border>
            </Expander>

            <!-- Row 4: Remember Options -->
            <StackPanel Grid.Row="4" Spacing="12" Margin="0,0,0,20">
                <CheckBox IsChecked="{Binding RememberForSession}">
                    <TextBlock>
                        <Run Text="Remember for this session" />
                        <Run Text=" â€” don't ask again until restart"
                             Foreground="{DynamicResource TextMuted}"
                             FontSize="12" />
                    </TextBlock>
                </CheckBox>

                <CheckBox IsChecked="{Binding RememberAlways}"
                          IsVisible="{Binding CanRememberPermanently}">
                    <TextBlock>
                        <Run Text="Always allow this tool" />
                        <Run Text=" â€” can be changed in Settings"
                             Foreground="{DynamicResource TextMuted}"
                             FontSize="12" />
                    </TextBlock>
                </CheckBox>
            </StackPanel>

            <!-- Row 5: Action Buttons -->
            <Grid Grid.Row="5" ColumnDefinitions="Auto, *, Auto, Auto">

                <!-- Keyboard hints -->
                <TextBlock VerticalAlignment="Center"
                           FontSize="11"
                           Foreground="{DynamicResource TextMuted}">
                    <Run Text="Enter" FontWeight="SemiBold" /> to allow,
                    <Run Text="Esc" FontWeight="SemiBold" /> to deny
                </TextBlock>

                <!-- Deny Button -->
                <Button Grid.Column="2"
                        Content="Deny"
                        Command="{Binding DenyCommand}"
                        Width="100"
                        Margin="0,0,12,0" />

                <!-- Allow Button -->
                <Button Grid.Column="3"
                        Content="Allow"
                        Command="{Binding AllowCommand}"
                        Classes="accent"
                        Width="100" />
            </Grid>
        </Grid>
    </Border>
</Window>
```

### 2. ToolApprovalDialog.axaml.cs

**Location**: `src/SeniorIntern.Desktop/Views/Dialogs/ToolApprovalDialog.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views.Dialogs;

using Avalonia.Controls;
using SeniorIntern.Core.Models.Permissions;
using SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Code-behind for the tool approval dialog.
/// </summary>
public partial class ToolApprovalDialog : Window
{
    /// <summary>
    /// The result of the approval dialog.
    /// </summary>
    public ApprovalDecision? Result { get; private set; }

    public ToolApprovalDialog()
    {
        InitializeComponent();
    }

    public ToolApprovalDialog(ToolApprovalViewModel viewModel) : this()
    {
        DataContext = viewModel;

        // Subscribe to close request from ViewModel
        viewModel.DialogCloseRequested += OnDialogCloseRequested;

        // Cleanup on close
        Closed += (_, _) =>
        {
            viewModel.DialogCloseRequested -= OnDialogCloseRequested;
            viewModel.Dispose();
        };
    }

    private void OnDialogCloseRequested(object? sender, ApprovalDecision? decision)
    {
        Result = decision;
        Close(decision);
    }

    /// <summary>
    /// Show the dialog and return the result.
    /// </summary>
    public static async Task<ApprovalDecision?> ShowAsync(
        Window owner,
        ToolApprovalViewModel viewModel)
    {
        var dialog = new ToolApprovalDialog(viewModel);
        await dialog.ShowDialog(owner);
        return dialog.Result;
    }
}
```

### 3. ApprovalDialogStyles.axaml

**Location**: `src/SeniorIntern.Desktop/Styles/ApprovalDialogStyles.axaml`

```xml
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- ============================================== -->
    <!-- Risk Badge Colors                              -->
    <!-- ============================================== -->

    <Style Selector="Border.risk-badge">
        <Setter Property="Background" Value="{DynamicResource SurfaceVariant}" />
        <Setter Property="BoxShadow" Value="0 2 4 0 #20000000" />
    </Style>

    <Style Selector="Border.risk-badge.safe">
        <Setter Property="Background" Value="#22C55E" />
    </Style>

    <Style Selector="Border.risk-badge.low">
        <Setter Property="Background" Value="#84CC16" />
    </Style>

    <Style Selector="Border.risk-badge.medium">
        <Setter Property="Background" Value="#F59E0B" />
    </Style>

    <Style Selector="Border.risk-badge.high">
        <Setter Property="Background" Value="#EF4444" />
    </Style>

    <Style Selector="Border.risk-badge.critical">
        <Setter Property="Background" Value="#7C2D12" />
    </Style>

    <!-- ============================================== -->
    <!-- Summary Box                                    -->
    <!-- ============================================== -->

    <Style Selector="Border.summary-box">
        <Setter Property="Background" Value="{DynamicResource SurfaceVariant}" />
        <Setter Property="CornerRadius" Value="8" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderMuted}" />
        <Setter Property="BorderThickness" Value="1" />
    </Style>

    <!-- ============================================== -->
    <!-- Risk Factors Box                               -->
    <!-- ============================================== -->

    <Style Selector="Border.risk-factors-box">
        <Setter Property="Background" Value="#FEF3C7" />
        <Setter Property="CornerRadius" Value="8" />
        <Setter Property="BorderBrush" Value="#FCD34D" />
        <Setter Property="BorderThickness" Value="1" />
    </Style>

    <!-- Dark theme variant -->
    <Style Selector="Window.dark Border.risk-factors-box">
        <Setter Property="Background" Value="#422006" />
        <Setter Property="BorderBrush" Value="#78350F" />
    </Style>

    <!-- ============================================== -->
    <!-- Details Box                                    -->
    <!-- ============================================== -->

    <Style Selector="Border.details-box">
        <Setter Property="Background" Value="{DynamicResource Surface}" />
        <Setter Property="CornerRadius" Value="4" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderMuted}" />
        <Setter Property="BorderThickness" Value="1" />
    </Style>

    <!-- ============================================== -->
    <!-- Dialog Container                               -->
    <!-- ============================================== -->

    <Style Selector="Border.dialog-container">
        <Setter Property="Background" Value="{DynamicResource Background}" />
    </Style>

    <!-- ============================================== -->
    <!-- Editing TextBox                                -->
    <!-- ============================================== -->

    <Style Selector="TextBox.editing">
        <Setter Property="Background" Value="{DynamicResource Surface}" />
        <Setter Property="BorderBrush" Value="{DynamicResource AccentColor}" />
    </Style>

    <!-- ============================================== -->
    <!-- Link Button                                    -->
    <!-- ============================================== -->

    <Style Selector="Button.link-button">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderThickness" Value="0" />
        <Setter Property="Foreground" Value="{DynamicResource AccentColor}" />
        <Setter Property="Padding" Value="0" />
        <Setter Property="Cursor" Value="Hand" />
    </Style>

    <Style Selector="Button.link-button:pointerover">
        <Setter Property="Foreground" Value="{DynamicResource AccentColorDark}" />
    </Style>

    <!-- ============================================== -->
    <!-- Accent Button                                  -->
    <!-- ============================================== -->

    <Style Selector="Button.accent">
        <Setter Property="Background" Value="{DynamicResource AccentColor}" />
        <Setter Property="Foreground" Value="White" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>

    <Style Selector="Button.accent:pointerover">
        <Setter Property="Background" Value="{DynamicResource AccentColorDark}" />
    </Style>

    <!-- ============================================== -->
    <!-- Expander Customization                         -->
    <!-- ============================================== -->

    <Style Selector="Expander">
        <Setter Property="Padding" Value="0" />
    </Style>

    <Style Selector="Expander /template/ ToggleButton">
        <Setter Property="Foreground" Value="{DynamicResource AccentColor}" />
        <Setter Property="FontSize" Value="13" />
    </Style>

    <!-- ============================================== -->
    <!-- Timeout Progress Bar                           -->
    <!-- ============================================== -->

    <Style Selector="ProgressBar">
        <Setter Property="Height" Value="3" />
        <Setter Property="CornerRadius" Value="2" />
        <Setter Property="Background" Value="{DynamicResource SurfaceVariant}" />
    </Style>

</Styles>
```

### 4. RiskLevelBrushConverter.cs

**Location**: `src/SeniorIntern.Desktop/Converters/RiskLevelBrushConverter.cs`

```csharp
namespace SeniorIntern.Desktop.Converters;

using System.Globalization;
using Avalonia.Data.Converters;
using Avalonia.Media;
using SeniorIntern.Core.Models.Permissions;

/// <summary>
/// Converts RiskLevel to a color brush for display.
/// </summary>
public class RiskLevelBrushConverter : IValueConverter
{
    /// <summary>
    /// Risk level color palette.
    /// </summary>
    private static readonly Dictionary<RiskLevel, SolidColorBrush> RiskBrushes = new()
    {
        [RiskLevel.Safe] = new SolidColorBrush(Color.Parse("#22C55E")),
        [RiskLevel.Low] = new SolidColorBrush(Color.Parse("#84CC16")),
        [RiskLevel.Medium] = new SolidColorBrush(Color.Parse("#F59E0B")),
        [RiskLevel.High] = new SolidColorBrush(Color.Parse("#EF4444")),
        [RiskLevel.Critical] = new SolidColorBrush(Color.Parse("#7C2D12"))
    };

    /// <summary>
    /// Default brush for unknown risk levels.
    /// </summary>
    private static readonly SolidColorBrush DefaultBrush =
        new(Color.Parse("#6B7280")); // Gray

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is RiskLevel level)
        {
            return RiskBrushes.GetValueOrDefault(level, DefaultBrush);
        }

        // Also support conversion from int (for RiskFactor.Contribution)
        if (value is int contribution)
        {
            var level = contribution switch
            {
                >= 4 => RiskLevel.Critical,
                3 => RiskLevel.High,
                2 => RiskLevel.Medium,
                1 => RiskLevel.Low,
                _ => RiskLevel.Safe
            };
            return RiskBrushes.GetValueOrDefault(level, DefaultBrush);
        }

        return DefaultBrush;
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotSupportedException("RiskLevelBrushConverter only supports one-way conversion.");
    }
}

/// <summary>
/// Converts RiskLevel to display text.
/// </summary>
public class RiskLevelTextConverter : IValueConverter
{
    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is RiskLevel level)
        {
            return level switch
            {
                RiskLevel.Safe => "Safe",
                RiskLevel.Low => "Low Risk",
                RiskLevel.Medium => "Medium Risk",
                RiskLevel.High => "High Risk",
                RiskLevel.Critical => "Critical",
                _ => level.ToString()
            };
        }

        return value?.ToString();
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotSupportedException();
    }
}
```

### 5. RiskIcons.cs

**Location**: `src/SeniorIntern.Desktop/Resources/RiskIcons.cs`

```csharp
namespace SeniorIntern.Desktop.Resources;

using Avalonia.Media;

/// <summary>
/// Icon geometries for risk level display.
/// </summary>
public static class RiskIcons
{
    /// <summary>
    /// Check circle icon (Safe).
    /// </summary>
    public static readonly StreamGeometry CheckCircle = StreamGeometry.Parse(
        "M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM16.7071 9.29289C17.0976 9.68342 17.0976 10.3166 16.7071 10.7071L11.7071 15.7071C11.3166 16.0976 10.6834 16.0976 10.2929 15.7071L7.29289 12.7071C6.90237 12.3166 6.90237 11.6834 7.29289 11.2929C7.68342 10.9024 8.31658 10.9024 8.70711 11.2929L11 13.5858L15.2929 9.29289C15.6834 8.90237 16.3166 8.90237 16.7071 9.29289Z");

    /// <summary>
    /// Info circle icon (Low).
    /// </summary>
    public static readonly StreamGeometry InfoCircle = StreamGeometry.Parse(
        "M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM12 10C12.5523 10 13 10.4477 13 11V17C13 17.5523 12.5523 18 12 18C11.4477 18 11 17.5523 11 17V11C11 10.4477 11.4477 10 12 10ZM12 8C12.5523 8 13 7.55228 13 7C13 6.44772 12.5523 6 12 6C11.4477 6 11 6.44772 11 7C11 7.55228 11.4477 8 12 8Z");

    /// <summary>
    /// Alert triangle icon (Medium).
    /// </summary>
    public static readonly StreamGeometry AlertTriangle = StreamGeometry.Parse(
        "M12.8944 3.55279C12.5259 2.81579 11.4741 2.81579 11.1056 3.55279L2.10557 21.5528C1.78025 22.2035 2.25596 23 2.99999 23H21C21.744 23 22.2197 22.2035 21.8944 21.5528L12.8944 3.55279ZM12 17C12.5523 17 13 17.4477 13 18C13 18.5523 12.5523 19 12 19C11.4477 19 11 18.5523 11 18C11 17.4477 11.4477 17 12 17ZM12 9C12.5523 9 13 9.44772 13 10V15C13 15.5523 12.5523 16 12 16C11.4477 16 11 15.5523 11 15V10C11 9.44772 11.4477 9 12 9Z");

    /// <summary>
    /// Alert circle icon (High).
    /// </summary>
    public static readonly StreamGeometry AlertCircle = StreamGeometry.Parse(
        "M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM12 7C12.5523 7 13 7.44772 13 8V12C13 12.5523 12.5523 13 12 13C11.4477 13 11 12.5523 11 12V8C11 7.44772 11.4477 7 12 7ZM12 15C12.5523 15 13 15.4477 13 16C13 16.5523 12.5523 17 12 17C11.4477 17 11 16.5523 11 16C11 15.4477 11.4477 15 12 15Z");

    /// <summary>
    /// Shield alert icon (Critical).
    /// </summary>
    public static readonly StreamGeometry ShieldAlert = StreamGeometry.Parse(
        "M12 2L4 5V11C4 16.55 7.84 21.74 12 23C16.16 21.74 20 16.55 20 11V5L12 2ZM12 11.99H18C17.47 16.11 15.04 19.7 12 21.15V12H6V6.3L12 4.19V11.99ZM11 9V7H13V9H11ZM11 13V11H13V13H11Z");

    /// <summary>
    /// Help circle icon (Unknown).
    /// </summary>
    public static readonly StreamGeometry HelpCircle = StreamGeometry.Parse(
        "M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22ZM12 8C11.4477 8 11 8.44772 11 9C11 9.55228 10.5523 10 10 10C9.44772 10 9 9.55228 9 9C9 7.34315 10.3431 6 12 6C13.6569 6 15 7.34315 15 9C15 10.1234 14.2837 11.0891 13.2689 11.4996C13.1121 11.5629 13 11.7191 13 11.8889V13C13 13.5523 12.5523 14 12 14C11.4477 14 11 13.5523 11 13V11.8889C11 10.7988 11.684 9.83955 12.6919 9.42792C13.0231 9.29375 13.25 8.97178 13.25 8.61111V9C13.25 8.30964 12.6904 7.75 12 7.75V8ZM12 18C12.5523 18 13 17.5523 13 17C13 16.4477 12.5523 16 12 16C11.4477 16 11 16.4477 11 17C11 17.5523 11.4477 18 12 18Z");

    /// <summary>
    /// Get icon for risk level.
    /// </summary>
    public static StreamGeometry GetIcon(RiskLevel level) => level switch
    {
        RiskLevel.Safe => CheckCircle,
        RiskLevel.Low => InfoCircle,
        RiskLevel.Medium => AlertTriangle,
        RiskLevel.High => AlertCircle,
        RiskLevel.Critical => ShieldAlert,
        _ => HelpCircle
    };
}
```

---

## File Summary

| File | Location | Purpose | Lines |
|------|----------|---------|-------|
| `ToolApprovalDialog.axaml` | `Views/Dialogs/` | Dialog XAML | ~175 |
| `ToolApprovalDialog.axaml.cs` | `Views/Dialogs/` | Code-behind | ~55 |
| `ApprovalDialogStyles.axaml` | `Styles/` | Dialog styling | ~130 |
| `RiskLevelBrushConverter.cs` | `Converters/` | Color converter | ~80 |
| `RiskIcons.cs` | `Resources/` | Icon geometries | ~65 |

---

## Unit Test Plan

| Test | Description |
|------|-------------|
| `Dialog_DisplaysToolName` | Tool name shown |
| `Dialog_DisplaysRiskBadge` | Risk badge colored correctly |
| `Dialog_DisplaysRiskFactors` | Risk factors listed |
| `Dialog_HidesRiskFactorsWhenEmpty` | Conditional visibility |
| `Dialog_DisplaysExecutionSummary` | Summary shown |
| `Dialog_DisplaysParameters` | Parameters visible in expander |
| `Dialog_ParametersEditable` | Edit mode works |
| `Dialog_TimeoutCountdown` | Timer decrements |
| `Dialog_TimeoutColorChanges` | Color changes with time |
| `Dialog_KeyboardEnterAllows` | Enter key allows |
| `Dialog_KeyboardEscDenies` | Escape key denies |
| `Dialog_RememberOptionsVisible` | Checkboxes shown |
| `Dialog_HighRiskHidesAlwaysRemember` | Safety feature |
| `RiskLevelBrushConverter_ReturnsCorrectColors` | Converter mapping |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | Dialog displays tool name and risk level |
| AC-2 | Risk factors are clearly listed |
| AC-3 | Parameters are viewable and optionally editable |
| AC-4 | Remember options work correctly |
| AC-5 | Keyboard shortcuts work (Enter/Escape) |
| AC-6 | Timeout countdown is visible |

---

## Changelog Entry

```markdown
## v0.6.4h - Approval Dialog UI

### Added
- `ToolApprovalDialog` Avalonia window
  - 6-row layout: Header, Summary, Risk Factors, Parameters, Remember, Actions
  - Risk badge with color-coded icons
  - Timeout countdown with progress bar
  - Keyboard shortcuts: Enter (Allow), Escape (Deny)
- Risk level visualization
  - 5 color palette: Green, Lime, Amber, Red, Dark Red
  - Risk-specific icons: CheckCircle, InfoCircle, AlertTriangle, etc.
- Execution summary display with monospace font
- Risk factors list with colored indicators
- Parameters expander with edit mode
- Remember options
  - "Remember for this session" checkbox
  - "Always allow this tool" checkbox (hidden for High/Critical)
- `ApprovalDialogStyles.axaml` styling
  - Risk badge colors
  - Summary and details boxes
  - Link button and accent button styles
  - Dark theme support
- `RiskLevelBrushConverter` for color binding
- `RiskIcons` static class with SVG path geometries
- Timeout visualization
  - Countdown text (mm:ss or Xs format)
  - Progress bar with color transitions
  - Auto-deny on timeout
```

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.6.4h | 0.75 day |
