# Design Specification: AIntern v0.6.3h "Workspace Tools"

## Overview

**Version**: v0.6.3h
**Parent**: v0.6.3 Built-in Tools
**Focus**: Workspace intelligence tools for project type detection, key files, and current context

### Purpose

Implement workspace tools that enable the AI agent to:
1. Understand the current workspace context
2. Detect project type (dotnet, node, python, rust, go)
3. Identify framework being used (Avalonia, React, Vue, etc.)
4. Find key configuration and documentation files
5. Summarize directory structure
6. Integrate with Git for repository status
7. List currently open files in the editor

### Dependencies

**From v0.3.x (Workspace Awareness)**:
- `IWorkspaceService` for workspace access
- `IFileSystemService` for file operations

**From v0.6.1 (Tool Framework)**:
- `ToolBase`, `ToolResult`
- `JsonSchemaBuilder`, `RiskLevel`

**Optional**:
- `IGitService` for Git status integration

---

## Architecture

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                    v0.6.3h Workspace Tools Architecture                       │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  src/SeniorIntern.Services/Tools/Workspace/                                  │
│  ├─────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                          │ │
│  │  GetWorkspaceInfoTool : ToolBase                                         │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐│ │
│  │  │  Id: "workspace-info"                                                ││ │
│  │  │  DefaultRiskLevel: Safe                                              ││ │
│  │  │                                                                      ││ │
│  │  │  Parameters: None required                                           ││ │
│  │  │                                                                      ││ │
│  │  │  Detects                                                              ││ │
│  │  │  ├── Project Type: dotnet, node, python, rust, go                    ││ │
│  │  │  ├── Framework: Avalonia, React, Vue, Angular, Next.js, etc.         ││ │
│  │  │  ├── Key Files: README, LICENSE, config files                        ││ │
│  │  │  ├── Structure: top-level dirs, file/dir counts                      ││ │
│  │  │  └── Git Info: branch, changes (if available)                        ││ │
│  │  └─────────────────────────────────────────────────────────────────────┘│ │
│  │                                                                          │ │
│  │  GetOpenFilesTool : ToolBase                                             │ │
│  │  ┌─────────────────────────────────────────────────────────────────────┐│ │
│  │  │  Id: "workspace-open-files"                                          ││ │
│  │  │  DefaultRiskLevel: Safe                                              ││ │
│  │  │                                                                      ││ │
│  │  │  Parameters: None required                                           ││ │
│  │  │                                                                      ││ │
│  │  │  Returns                                                              ││ │
│  │  │  ├── List of open files                                              ││ │
│  │  │  ├── Active file highlighted                                         ││ │
│  │  │  └── File language/type                                              ││ │
│  │  └─────────────────────────────────────────────────────────────────────┘│ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  Data Models                                                                 │
│  ├─────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                          │ │
│  │  WorkspaceInfoData                                                       │ │
│  │  ├── Name: string                                                        │ │
│  │  ├── Path: string                                                        │ │
│  │  ├── ProjectType: string (dotnet|node|python|rust|go|unknown)           │ │
│  │  ├── Framework: string? (Avalonia|React|Vue|etc.)                       │ │
│  │  ├── KeyFiles: string[]                                                  │ │
│  │  ├── Structure: StructureSummary                                        │ │
│  │  └── Git: GitInfo?                                                       │ │
│  │                                                                          │ │
│  │  StructureSummary                                                        │ │
│  │  ├── TopLevelDirectories: string[]                                      │ │
│  │  ├── TotalFiles: int                                                     │ │
│  │  └── TotalDirectories: int                                               │ │
│  │                                                                          │ │
│  │  GitInfo                                                                 │ │
│  │  ├── Branch: string                                                      │ │
│  │  ├── HasUncommittedChanges: bool                                        │ │
│  │  ├── ModifiedFiles: int                                                  │ │
│  │  └── UntrackedFiles: int                                                 │ │
│  │                                                                          │ │
│  │  ProjectTypeInfo                                                         │ │
│  │  ├── Type: string                                                        │ │
│  │  └── Framework: string?                                                  │ │
│  │                                                                          │ │
│  └─────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Project Type Detection

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                        Project Type Detection Logic                           │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Detection Order (first match wins):                                         │
│                                                                              │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                         │ │
│  │  1. .NET (dotnet)                                                       │ │
│  │     Indicator:  *.csproj files OR *.sln file                            │ │
│  │     Framework Detection:                                                │ │
│  │     ├── Contains "Avalonia" → Avalonia                                  │ │
│  │     ├── Contains "Microsoft.AspNetCore" → ASP.NET Core                  │ │
│  │     ├── Contains "Microsoft.Maui" → MAUI                                │ │
│  │     └── Contains "WPF" → WPF                                            │ │
│  │                                                                         │ │
│  │  2. Node.js (node)                                                      │ │
│  │     Indicator:  package.json                                            │ │
│  │     Framework Detection:                                                │ │
│  │     ├── Contains "next" → Next.js                                       │ │
│  │     ├── Contains "react" → React                                        │ │
│  │     ├── Contains "vue" → Vue                                            │ │
│  │     ├── Contains "angular" → Angular                                    │ │
│  │     └── Contains "express" → Express                                    │ │
│  │                                                                         │ │
│  │  3. Python (python)                                                     │ │
│  │     Indicator:  pyproject.toml OR setup.py OR requirements.txt          │ │
│  │     Framework: None detected (future: Django, Flask, FastAPI)           │ │
│  │                                                                         │ │
│  │  4. Rust (rust)                                                         │ │
│  │     Indicator:  Cargo.toml                                              │ │
│  │     Framework: None detected                                            │ │
│  │                                                                         │ │
│  │  5. Go (go)                                                             │ │
│  │     Indicator:  go.mod                                                  │ │
│  │     Framework: None detected                                            │ │
│  │                                                                         │ │
│  │  6. Unknown                                                             │ │
│  │     Fallback when no indicators match                                   │ │
│  │                                                                         │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Key Files Detection

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                          Key Files Detection                                  │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  Common Files (checked for all projects):                                    │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │  README.md                                                              │ │
│  │  LICENSE                                                                │ │
│  │  .gitignore                                                             │ │
│  │  Dockerfile                                                             │ │
│  │  docker-compose.yml                                                     │ │
│  │  .env.example                                                           │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
│  Project-Specific Files:                                                     │
│  ┌────────────────────────────────────────────────────────────────────────┐ │
│  │                                                                         │ │
│  │  dotnet:                                                                │ │
│  │  ├── *.sln files                                                        │ │
│  │  └── *.csproj files (first 3)                                          │ │
│  │                                                                         │ │
│  │  node:                                                                  │ │
│  │  ├── package.json                                                       │ │
│  │  └── tsconfig.json (if exists)                                         │ │
│  │                                                                         │ │
│  │  python:                                                                │ │
│  │  ├── pyproject.toml (if exists)                                        │ │
│  │  └── requirements.txt (if exists)                                      │ │
│  │                                                                         │ │
│  │  rust:                                                                  │ │
│  │  └── Cargo.toml                                                         │ │
│  │                                                                         │ │
│  │  go:                                                                    │ │
│  │  └── go.mod                                                             │ │
│  │                                                                         │ │
│  └────────────────────────────────────────────────────────────────────────┘ │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## Execution Flow

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                   GetWorkspaceInfoTool Execution Flow                         │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  ExecuteAsync(context)                                                       │
│      │                                                                       │
│      ▼                                                                       │
│  ┌─────────────────────────────┐                                             │
│  │  1. Check Workspace Open    │                                             │
│  │  CurrentWorkspace != null   │                                             │
│  └─────────────┬───────────────┘                                             │
│                │                                                             │
│       ┌────────┴────────┐                                                    │
│       │ No workspace    │ Workspace exists                                   │
│       ▼                 ▼                                                    │
│  ┌──────────┐    ┌─────────────────────────────┐                             │
│  │  RETURN  │    │  2. Detect Project Type     │                             │
│  │  Failed  │    │  DetectProjectTypeAsync()   │                             │
│  └──────────┘    └─────────────┬───────────────┘                             │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  3. Find Key Files          │                             │
│                  │  FindKeyFilesAsync()        │                             │
│                  └─────────────┬───────────────┘                             │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  4. Get Structure Summary   │                             │
│                  │  GetStructureSummaryAsync() │                             │
│                  └─────────────┬───────────────┘                             │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  5. Check for Git Repo      │                             │
│                  │  IsGitRepositoryAsync()     │                             │
│                  └─────────────┬───────────────┘                             │
│                                │                                             │
│                 ┌──────────────┴──────────────┐                              │
│                 │ Not Git repo                │ Is Git repo                  │
│                 ▼                             ▼                              │
│          ┌──────────┐                ┌─────────────────────────────┐         │
│          │ Git null │                │  6. Get Git Info            │         │
│          └─────┬────┘                │  GetGitInfoAsync()          │         │
│                │                     └─────────────┬───────────────┘         │
│                │                                   │                         │
│                └───────────────┬───────────────────┘                         │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  7. Build WorkspaceInfoData │                             │
│                  └─────────────┬───────────────┘                             │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  8. Format Output           │                             │
│                  │  FormatWorkspaceInfo()      │                             │
│                  └─────────────┬───────────────┘                             │
│                                │                                             │
│                                ▼                                             │
│                  ┌─────────────────────────────┐                             │
│                  │  9. Return Result           │                             │
│                  └─────────────────────────────┘                             │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## File Specifications

### 1. GetWorkspaceInfoTool.cs

**Location**: `src/SeniorIntern.Services/Tools/Workspace/GetWorkspaceInfoTool.cs`

```csharp
namespace SeniorIntern.Services.Tools.Workspace;

using System.Text;
using System.Text.Json;
using Microsoft.Extensions.Logging;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Models;
using SeniorIntern.Core.Tools;
using SeniorIntern.Services.Tools;

/// <summary>
/// Tool for getting workspace information.
/// </summary>
/// <remarks>
/// <para>
/// GetWorkspaceInfoTool provides comprehensive workspace context:
/// </para>
/// <list type="bullet">
/// <item>Project type detection (dotnet, node, python, etc.)</item>
/// <item>Framework identification (React, Vue, Avalonia, etc.)</item>
/// <item>Key file discovery</item>
/// <item>Directory structure summary</item>
/// <item>Git repository status</item>
/// </list>
/// </remarks>
public sealed class GetWorkspaceInfoTool : ToolBase
{
    #region Tool Metadata

    public override string Id => "workspace-info";

    public override string Name => "Get Workspace Info";

    public override string Description => """
        Get information about the current workspace.
        Returns project type, structure, key files, and git status.

        Use this at the start of a task to understand the project context.
        """;

    public override ToolCategory Category => ToolCategory.Workspace;

    public override RiskLevel DefaultRiskLevel => RiskLevel.Safe;

    public override IReadOnlyList<string> Tags => new[] { "workspace", "project", "info" };

    public override JsonSchema InputSchema => JsonSchemaBuilder.Create()
        .WithDescription("No parameters required")
        .Build();

    #endregion

    #region Dependencies

    private readonly IWorkspaceService _workspace;
    private readonly IFileSystemService _fileSystem;
    private readonly IGitService? _gitService;
    private readonly ILogger<GetWorkspaceInfoTool> _logger;

    #endregion

    public GetWorkspaceInfoTool(
        IWorkspaceService workspace,
        IFileSystemService fileSystem,
        ILogger<GetWorkspaceInfoTool> logger,
        IGitService? gitService = null)
    {
        _workspace = workspace ?? throw new ArgumentNullException(nameof(workspace));
        _fileSystem = fileSystem ?? throw new ArgumentNullException(nameof(fileSystem));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
        _gitService = gitService; // Optional
    }

    public override bool IsAvailable => _workspace.CurrentWorkspace != null;

    #region ExecuteAsync

    public override async Task<ToolResult> ExecuteAsync(
        ToolExecutionContext context,
        CancellationToken ct = default)
    {
        var workspace = _workspace.CurrentWorkspace;
        if (workspace == null)
        {
            return ToolResult.Failed("No workspace is currently open");
        }

        var rootPath = workspace.RootPath;

        _logger.LogDebug("GetWorkspaceInfoTool executing for: {Path}", rootPath);

        try
        {
            // Detect project type
            var projectType = await DetectProjectTypeAsync(rootPath, ct);

            // Find key files
            var keyFiles = await FindKeyFilesAsync(rootPath, projectType, ct);

            // Get directory structure summary
            var structure = await GetStructureSummaryAsync(rootPath, ct);

            // Get Git info if available
            GitInfo? gitInfo = null;
            if (_gitService != null && await _gitService.IsGitRepositoryAsync(rootPath, ct))
            {
                gitInfo = await GetGitInfoAsync(rootPath, ct);
            }

            var resultData = new WorkspaceInfoData
            {
                Name = workspace.DisplayName,
                Path = rootPath,
                ProjectType = projectType.Type,
                Framework = projectType.Framework,
                KeyFiles = keyFiles,
                Structure = structure,
                Git = gitInfo
            };

            // Format output
            var output = FormatWorkspaceInfo(resultData);

            var message = projectType.Framework != null
                ? $"Workspace: {workspace.DisplayName} ({projectType.Type}/{projectType.Framework})"
                : $"Workspace: {workspace.DisplayName} ({projectType.Type})";

            _logger.LogInformation(
                "GetWorkspaceInfoTool success: {Name}, type={Type}",
                workspace.DisplayName, projectType.Type);

            return ToolResult.Success(output, resultData, message);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to get workspace info");
            return ToolResult.Failed($"Failed to get workspace info: {ex.Message}");
        }
    }

    #endregion

    #region Project Type Detection

    /// <summary>
    /// Detect the project type from workspace files.
    /// </summary>
    private async Task<ProjectTypeInfo> DetectProjectTypeAsync(string path, CancellationToken ct)
    {
        // .NET
        var csprojFiles = Directory.GetFiles(path, "*.csproj", SearchOption.TopDirectoryOnly);
        var slnFiles = Directory.GetFiles(path, "*.sln", SearchOption.TopDirectoryOnly);

        if (csprojFiles.Length > 0 || slnFiles.Length > 0)
        {
            var framework = await DetectDotNetFrameworkAsync(
                csprojFiles.FirstOrDefault() ??
                Directory.GetFiles(path, "*.csproj", SearchOption.AllDirectories).FirstOrDefault(),
                ct);
            return new ProjectTypeInfo { Type = "dotnet", Framework = framework };
        }

        // Node.js
        var packageJson = Path.Combine(path, "package.json");
        if (File.Exists(packageJson))
        {
            var framework = await DetectNodeFrameworkAsync(packageJson, ct);
            return new ProjectTypeInfo { Type = "node", Framework = framework };
        }

        // Python
        if (File.Exists(Path.Combine(path, "pyproject.toml")) ||
            File.Exists(Path.Combine(path, "setup.py")) ||
            File.Exists(Path.Combine(path, "requirements.txt")))
        {
            return new ProjectTypeInfo { Type = "python" };
        }

        // Rust
        if (File.Exists(Path.Combine(path, "Cargo.toml")))
        {
            return new ProjectTypeInfo { Type = "rust" };
        }

        // Go
        if (File.Exists(Path.Combine(path, "go.mod")))
        {
            return new ProjectTypeInfo { Type = "go" };
        }

        return new ProjectTypeInfo { Type = "unknown" };
    }

    /// <summary>
    /// Detect .NET framework from csproj content.
    /// </summary>
    private async Task<string?> DetectDotNetFrameworkAsync(string? csprojPath, CancellationToken ct)
    {
        if (csprojPath == null || !File.Exists(csprojPath)) return null;

        var content = await _fileSystem.ReadFileAsync(csprojPath, ct);

        if (content.Contains("Avalonia")) return "Avalonia";
        if (content.Contains("Microsoft.AspNetCore")) return "ASP.NET Core";
        if (content.Contains("Microsoft.Maui")) return "MAUI";
        if (content.Contains("WPF")) return "WPF";
        if (content.Contains("WindowsForms")) return "WinForms";

        return null;
    }

    /// <summary>
    /// Detect Node.js framework from package.json.
    /// </summary>
    private async Task<string?> DetectNodeFrameworkAsync(string packageJsonPath, CancellationToken ct)
    {
        var content = await _fileSystem.ReadFileAsync(packageJsonPath, ct);

        if (content.Contains("\"next\"")) return "Next.js";
        if (content.Contains("\"react\"")) return "React";
        if (content.Contains("\"vue\"")) return "Vue";
        if (content.Contains("\"@angular/core\"")) return "Angular";
        if (content.Contains("\"express\"")) return "Express";
        if (content.Contains("\"svelte\"")) return "Svelte";
        if (content.Contains("\"electron\"")) return "Electron";

        return null;
    }

    #endregion

    #region Key Files

    /// <summary>
    /// Find key files in the workspace.
    /// </summary>
    private async Task<List<string>> FindKeyFilesAsync(
        string path, ProjectTypeInfo projectType, CancellationToken ct)
    {
        var keyFiles = new List<string>();

        // Common files present in most projects
        var commonFiles = new[]
        {
            "README.md", "README", "LICENSE", "LICENSE.md",
            ".gitignore", "Dockerfile", "docker-compose.yml",
            ".env.example", ".editorconfig"
        };

        foreach (var file in commonFiles)
        {
            if (File.Exists(Path.Combine(path, file)))
            {
                keyFiles.Add(file);
            }
        }

        // Project-specific files
        switch (projectType.Type)
        {
            case "dotnet":
                keyFiles.AddRange(
                    Directory.GetFiles(path, "*.sln")
                        .Select(Path.GetFileName)!);
                keyFiles.AddRange(
                    Directory.GetFiles(path, "*.csproj")
                        .Take(3)
                        .Select(Path.GetFileName)!);
                break;

            case "node":
                keyFiles.Add("package.json");
                if (File.Exists(Path.Combine(path, "tsconfig.json")))
                    keyFiles.Add("tsconfig.json");
                if (File.Exists(Path.Combine(path, "vite.config.ts")))
                    keyFiles.Add("vite.config.ts");
                if (File.Exists(Path.Combine(path, "next.config.js")))
                    keyFiles.Add("next.config.js");
                break;

            case "python":
                if (File.Exists(Path.Combine(path, "pyproject.toml")))
                    keyFiles.Add("pyproject.toml");
                if (File.Exists(Path.Combine(path, "requirements.txt")))
                    keyFiles.Add("requirements.txt");
                if (File.Exists(Path.Combine(path, "setup.py")))
                    keyFiles.Add("setup.py");
                break;

            case "rust":
                keyFiles.Add("Cargo.toml");
                break;

            case "go":
                keyFiles.Add("go.mod");
                if (File.Exists(Path.Combine(path, "go.sum")))
                    keyFiles.Add("go.sum");
                break;
        }

        return keyFiles.Distinct().ToList();
    }

    #endregion

    #region Structure Summary

    /// <summary>
    /// Get a summary of the directory structure.
    /// </summary>
    private Task<StructureSummary> GetStructureSummaryAsync(string path, CancellationToken ct)
    {
        // Get top-level directories (excluding hidden)
        var topDirs = Directory.GetDirectories(path)
            .Select(Path.GetFileName)
            .Where(d => !d!.StartsWith('.'))
            .Take(15)
            .ToList();

        // Count total files and directories
        var fileCount = 0;
        var dirCount = 0;

        try
        {
            fileCount = Directory.GetFiles(path, "*", SearchOption.AllDirectories).Length;
            dirCount = Directory.GetDirectories(path, "*", SearchOption.AllDirectories).Length;
        }
        catch
        {
            // Ignore access errors
        }

        return Task.FromResult(new StructureSummary
        {
            TopLevelDirectories = topDirs!,
            TotalFiles = fileCount,
            TotalDirectories = dirCount
        });
    }

    #endregion

    #region Git Info

    /// <summary>
    /// Get Git repository information.
    /// </summary>
    private async Task<GitInfo> GetGitInfoAsync(string path, CancellationToken ct)
    {
        var branch = await _gitService!.GetCurrentBranchAsync(path, ct);
        var status = await _gitService.GetStatusAsync(path, ct);

        return new GitInfo
        {
            Branch = branch,
            HasUncommittedChanges = status.HasChanges,
            ModifiedFiles = status.ModifiedCount,
            UntrackedFiles = status.UntrackedCount
        };
    }

    #endregion

    #region Output Formatting

    /// <summary>
    /// Format workspace info for display.
    /// </summary>
    private static string FormatWorkspaceInfo(WorkspaceInfoData data)
    {
        var sb = new StringBuilder();

        sb.AppendLine($"# Workspace: {data.Name}");
        sb.AppendLine();
        sb.AppendLine($"**Path:** {data.Path}");
        sb.AppendLine($"**Type:** {data.ProjectType}");
        if (data.Framework != null)
            sb.AppendLine($"**Framework:** {data.Framework}");
        sb.AppendLine();

        if (data.KeyFiles.Count > 0)
        {
            sb.AppendLine("## Key Files");
            foreach (var file in data.KeyFiles)
            {
                sb.AppendLine($"- {file}");
            }
            sb.AppendLine();
        }

        sb.AppendLine("## Structure");
        sb.AppendLine($"- {data.Structure.TotalFiles:N0} files in {data.Structure.TotalDirectories:N0} directories");
        if (data.Structure.TopLevelDirectories.Count > 0)
        {
            sb.AppendLine($"- Top-level: {string.Join(", ", data.Structure.TopLevelDirectories)}");
        }

        if (data.Git != null)
        {
            sb.AppendLine();
            sb.AppendLine("## Git");
            sb.AppendLine($"- Branch: {data.Git.Branch}");
            if (data.Git.HasUncommittedChanges)
            {
                sb.AppendLine($"- Changes: {data.Git.ModifiedFiles} modified, {data.Git.UntrackedFiles} untracked");
            }
            else
            {
                sb.AppendLine("- Working tree clean");
            }
        }

        return sb.ToString();
    }

    #endregion

    #region Overrides

    public override string GetExecutionSummary(JsonElement parameters) =>
        "Get workspace info";

    #endregion
}
```

### 2. GetOpenFilesTool.cs

**Location**: `src/SeniorIntern.Services/Tools/Workspace/GetOpenFilesTool.cs`

```csharp
namespace SeniorIntern.Services.Tools.Workspace;

using System.Text;
using System.Text.Json;
using Microsoft.Extensions.Logging;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Tools;
using SeniorIntern.Services.Tools;

/// <summary>
/// Tool for getting currently open files in the editor.
/// </summary>
public sealed class GetOpenFilesTool : ToolBase
{
    #region Tool Metadata

    public override string Id => "workspace-open-files";

    public override string Name => "Get Open Files";

    public override string Description => """
        Get the list of currently open files in the editor.
        Shows which file is currently active.

        Use this to understand what files the user is working on.
        """;

    public override ToolCategory Category => ToolCategory.Workspace;

    public override RiskLevel DefaultRiskLevel => RiskLevel.Safe;

    public override IReadOnlyList<string> Tags => new[] { "workspace", "files", "editor" };

    public override JsonSchema InputSchema => JsonSchemaBuilder.Create()
        .WithDescription("No parameters required")
        .Build();

    #endregion

    #region Dependencies

    private readonly IWorkspaceService _workspace;
    private readonly IEditorService _editorService;
    private readonly ILogger<GetOpenFilesTool> _logger;

    #endregion

    public GetOpenFilesTool(
        IWorkspaceService workspace,
        IEditorService editorService,
        ILogger<GetOpenFilesTool> logger)
    {
        _workspace = workspace ?? throw new ArgumentNullException(nameof(workspace));
        _editorService = editorService ?? throw new ArgumentNullException(nameof(editorService));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    public override bool IsAvailable => _workspace.CurrentWorkspace != null;

    #region ExecuteAsync

    public override async Task<ToolResult> ExecuteAsync(
        ToolExecutionContext context,
        CancellationToken ct = default)
    {
        _logger.LogDebug("GetOpenFilesTool executing");

        try
        {
            var openFiles = await _editorService.GetOpenFilesAsync(ct);
            var activeFile = await _editorService.GetActiveFileAsync(ct);

            if (openFiles.Count == 0)
            {
                return ToolResult.Success(
                    "(no files open)",
                    new OpenFilesData { Files = new(), ActiveFile = null },
                    "No files currently open");
            }

            // Build output
            var sb = new StringBuilder();
            foreach (var file in openFiles)
            {
                var marker = file.Path == activeFile?.Path ? " ← active" : "";
                var relativePath = Path.GetRelativePath(context.WorkspacePath!, file.Path);
                sb.AppendLine($"- {relativePath}{marker}");
            }

            var resultData = new OpenFilesData
            {
                Files = openFiles.Select(f => new OpenFileInfo
                {
                    Path = Path.GetRelativePath(context.WorkspacePath!, f.Path),
                    Language = f.Language,
                    IsActive = f.Path == activeFile?.Path
                }).ToList(),
                ActiveFile = activeFile != null
                    ? Path.GetRelativePath(context.WorkspacePath!, activeFile.Path)
                    : null
            };

            _logger.LogInformation(
                "GetOpenFilesTool success: {Count} files open",
                openFiles.Count);

            return ToolResult.Success(
                sb.ToString().TrimEnd(),
                resultData,
                $"{openFiles.Count} files open");
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to get open files");
            return ToolResult.Failed($"Failed to get open files: {ex.Message}");
        }
    }

    #endregion

    #region Overrides

    public override string GetExecutionSummary(JsonElement parameters) =>
        "Get open files";

    #endregion
}
```

### 3. WorkspaceInfoData.cs

**Location**: `src/SeniorIntern.Services/Tools/Workspace/WorkspaceInfoData.cs`

```csharp
namespace SeniorIntern.Services.Tools.Workspace;

/// <summary>
/// Project type detection result.
/// </summary>
public sealed class ProjectTypeInfo
{
    /// <summary>Project type (dotnet, node, python, rust, go, unknown).</summary>
    public string Type { get; init; } = "unknown";

    /// <summary>Framework if detected (Avalonia, React, etc.).</summary>
    public string? Framework { get; init; }
}

/// <summary>
/// Directory structure summary.
/// </summary>
public sealed class StructureSummary
{
    /// <summary>Top-level directories (non-hidden).</summary>
    public List<string> TopLevelDirectories { get; init; } = new();

    /// <summary>Total file count in workspace.</summary>
    public int TotalFiles { get; init; }

    /// <summary>Total directory count in workspace.</summary>
    public int TotalDirectories { get; init; }
}

/// <summary>
/// Git repository information.
/// </summary>
public sealed class GitInfo
{
    /// <summary>Current branch name.</summary>
    public string Branch { get; init; } = string.Empty;

    /// <summary>Whether there are uncommitted changes.</summary>
    public bool HasUncommittedChanges { get; init; }

    /// <summary>Number of modified files.</summary>
    public int ModifiedFiles { get; init; }

    /// <summary>Number of untracked files.</summary>
    public int UntrackedFiles { get; init; }
}

/// <summary>
/// Complete workspace information.
/// </summary>
public sealed class WorkspaceInfoData
{
    /// <summary>Workspace display name.</summary>
    public string Name { get; init; } = string.Empty;

    /// <summary>Workspace root path.</summary>
    public string Path { get; init; } = string.Empty;

    /// <summary>Detected project type.</summary>
    public string ProjectType { get; init; } = string.Empty;

    /// <summary>Detected framework (if any).</summary>
    public string? Framework { get; init; }

    /// <summary>Key files found in workspace.</summary>
    public List<string> KeyFiles { get; init; } = new();

    /// <summary>Directory structure summary.</summary>
    public StructureSummary Structure { get; init; } = new();

    /// <summary>Git information (if available).</summary>
    public GitInfo? Git { get; init; }
}

/// <summary>
/// Information about an open file.
/// </summary>
public sealed class OpenFileInfo
{
    /// <summary>Relative path to the file.</summary>
    public string Path { get; init; } = string.Empty;

    /// <summary>File language/type.</summary>
    public string? Language { get; init; }

    /// <summary>Whether this is the active file.</summary>
    public bool IsActive { get; init; }
}

/// <summary>
/// Result data for open files query.
/// </summary>
public sealed class OpenFilesData
{
    /// <summary>List of open files.</summary>
    public List<OpenFileInfo> Files { get; init; } = new();

    /// <summary>Currently active file path.</summary>
    public string? ActiveFile { get; init; }

    /// <summary>Number of open files.</summary>
    public int Count => Files.Count;
}
```

---

## Output Format

```
┌──────────────────────────────────────────────────────────────────────────────┐
│                    GetWorkspaceInfoTool Output Example                        │
├──────────────────────────────────────────────────────────────────────────────┤
│                                                                              │
│  # Workspace: SeniorIntern                                                   │
│                                                                              │
│  **Path:** /Users/ryan/projects/SeniorIntern                                 │
│  **Type:** dotnet                                                            │
│  **Framework:** Avalonia                                                     │
│                                                                              │
│  ## Key Files                                                                │
│  - README.md                                                                 │
│  - LICENSE                                                                   │
│  - .gitignore                                                                │
│  - SeniorIntern.sln                                                          │
│  - SeniorIntern.csproj                                                       │
│  - SeniorIntern.Core.csproj                                                  │
│                                                                              │
│  ## Structure                                                                │
│  - 847 files in 124 directories                                             │
│  - Top-level: src, tests, docs, scripts, tools                              │
│                                                                              │
│  ## Git                                                                      │
│  - Branch: feature/tool-framework                                           │
│  - Changes: 5 modified, 2 untracked                                         │
│                                                                              │
└──────────────────────────────────────────────────────────────────────────────┘
```

---

## File Summary

| File | Location | Purpose | Lines |
|------|----------|---------|-------|
| `GetWorkspaceInfoTool.cs` | `Services/Tools/Workspace/` | Workspace info | ~320 |
| `GetOpenFilesTool.cs` | `Services/Tools/Workspace/` | Open files list | ~100 |
| `WorkspaceInfoData.cs` | `Services/Tools/Workspace/` | Data models | ~100 |

---

## Unit Test Plan

| Test | Description |
|------|-------------|
| `GetWorkspaceInfoTool_DotNetProject_DetectsType` | .NET detection |
| `GetWorkspaceInfoTool_NodeProject_DetectsType` | Node.js detection |
| `GetWorkspaceInfoTool_PythonProject_DetectsType` | Python detection |
| `GetWorkspaceInfoTool_ReactFramework_DetectsFramework` | React in package.json |
| `GetWorkspaceInfoTool_AvaloniaFramework_DetectsFramework` | Avalonia in csproj |
| `GetWorkspaceInfoTool_FindsKeyFiles` | README, LICENSE, etc. |
| `GetWorkspaceInfoTool_GitInfo_IncludesStatus` | Git branch and changes |
| `GetWorkspaceInfoTool_NoGit_OmitsGitSection` | Non-Git workspace |
| `GetOpenFilesTool_NoFiles_ReturnsEmpty` | No files open |
| `GetOpenFilesTool_ActiveFile_Marked` | Active file indication |

---

## Acceptance Criteria

| ID | Criterion |
|----|-----------|
| AC-1 | GetWorkspaceInfoTool detects project type |
| AC-2 | Key files are identified |
| AC-3 | Directory structure is summarized |
| AC-4 | Git status is included when available |
| AC-5 | Framework detection works for common stacks |

---

## Changelog Entry

```markdown
## v0.6.3h - Workspace Tools

### Added
- `GetWorkspaceInfoTool` for comprehensive workspace context
  - Project type detection (dotnet, node, python, rust, go)
  - Framework detection (Avalonia, React, Vue, Angular, etc.)
  - Key file discovery (README, LICENSE, config files)
  - Directory structure summary (file/dir counts)
  - Git integration (branch, uncommitted changes)
- `GetOpenFilesTool` for listing open editor files
  - Active file highlighting
  - File language detection
- Data models for workspace information
  - `WorkspaceInfoData`, `ProjectTypeInfo`, `StructureSummary`
  - `GitInfo`, `OpenFileInfo`, `OpenFilesData`
```

---

## Timeline Estimate

| Version | Estimated Effort |
|---------|------------------|
| v0.6.3h | 0.5 day |
