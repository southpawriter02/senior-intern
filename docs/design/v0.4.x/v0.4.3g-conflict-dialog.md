# v0.4.3g: Conflict Dialog - Design Specification

**Status**: _IMPLEMENTED_

## Executive Summary

This specification details the implementation of the **Conflict Warning Dialog** for The Senior Intern's Apply Changes Workflow. The Conflict Dialog provides a user-facing interface when a file conflict is detected, allowing users to choose between refreshing the diff against the current file content, force-applying their changes (potentially overwriting recent edits), or cancelling the operation entirely.

### Key Deliverables
- `ConflictWarningDialogViewModel` with MVVM pattern using CommunityToolkit.Mvvm
- `ConflictWarningDialog.axaml` Avalonia window with warning UI and resolution options
- `ConflictWarningDialog.axaml.cs` code-behind with static `ShowAsync` factory method
- `ConflictResolution` enumeration for dialog results
- Integration with ConflictDetector and Apply Dialog workflow
- Warning-styled UI with clear action consequences

---

## Feature Overview

```
v0.4.3g: Conflict Dialog
├── ViewModel (ConflictWarningDialogViewModel)
│   ├── Observable Properties
│   │   ├── FilePath (full path to conflicting file)
│   │   ├── FileName (extracted filename for display)
│   │   ├── ConflictMessage (human-readable conflict description)
│   │   ├── ConflictReason (specific reason enumeration)
│   │   ├── LastModified (file's modification timestamp)
│   │   ├── SnapshotTime (when original snapshot was taken)
│   │   └── SelectedResolution (user's choice)
│   └── Commands
│       ├── RefreshDiffCommand (recompute diff)
│       ├── ForceApplyCommand (overwrite file)
│       └── CancelCommand (abort operation)
├── View (ConflictWarningDialog.axaml)
│   ├── Warning Header (icon + title)
│   ├── Conflict Details Panel
│   │   ├── Conflict message
│   │   ├── File information card
│   │   └── Timestamp comparison
│   └── Action Buttons
│       ├── Refresh Diff (recommended)
│       ├── Force Apply (warning styled)
│       └── Cancel (neutral)
├── Code-Behind (ConflictWarningDialog.axaml.cs)
│   └── Static ShowAsync Factory Method
├── Enumeration (ConflictResolution)
│   ├── Cancel
│   ├── RefreshDiff
│   └── ForceApply
└── Visual Design
    ├── Warning icon and colors
    ├── Consequence indicators
    └── Keyboard shortcuts
```

---

## Architecture Diagrams

### Conflict Detection Flow

```
┌─────────────────────────────────────────────────────────────────┐
│                    Conflict Detection Flow                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│   User clicks "Apply"                                           │
│          │                                                       │
│          ▼                                                       │
│   ┌──────────────────┐                                          │
│   │ ConflictDetector │                                          │
│   │ CheckConflict()  │                                          │
│   └────────┬─────────┘                                          │
│            │                                                     │
│     ┌──────┴──────┐                                             │
│     │             │                                             │
│     ▼             ▼                                             │
│ No Conflict   Conflict Detected                                 │
│     │             │                                             │
│     ▼             ▼                                             │
│ ┌────────┐   ┌──────────────────────┐                          │
│ │ Apply  │   │ ConflictWarningDialog │                          │
│ │Changes │   │      .ShowAsync()     │                          │
│ └────────┘   └──────────┬───────────┘                          │
│                         │                                       │
│           ┌─────────────┼─────────────┐                        │
│           │             │             │                        │
│           ▼             ▼             ▼                        │
│     ┌─────────┐   ┌──────────┐   ┌──────────┐                 │
│     │ Cancel  │   │ Refresh  │   │  Force   │                 │
│     │         │   │   Diff   │   │  Apply   │                 │
│     └────┬────┘   └────┬─────┘   └────┬─────┘                 │
│          │             │              │                        │
│          ▼             ▼              ▼                        │
│      Abort        Recompute      Overwrite                    │
│      Operation    & Show         File                         │
│                   Apply Dialog                                 │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Dialog Layout Structure

```
┌─────────────────────────────────────────────────────────────────┐
│  File Conflict Detected                                    [×]  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│                         ⚠                                       │
│                  (Warning Icon 48x48)                           │
│                                                                  │
│              File Conflict Detected                             │
│                 (18pt SemiBold)                                 │
│                                                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│     File content has been modified since the proposal           │
│     was generated. Your changes may overwrite recent edits.     │
│                                                                  │
│  ┌───────────────────────────────────────────────────────────┐  │
│  │  File:                                                     │  │
│  │  /path/to/modified/file.cs                                │  │
│  │                                                            │  │
│  │  Last modified: 1/10/2026 3:45 PM                         │  │
│  │  Snapshot taken: 1/10/2026 3:30 PM                        │  │
│  │  (15 minutes ago)                                         │  │
│  └───────────────────────────────────────────────────────────┘  │
│                                                                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│    [ Refresh Diff ]    [ Force Apply ]    [ Cancel ]            │
│     (Recommended)        (Warning)                              │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

### Resolution Consequence Diagram

```
┌─────────────────────────────────────────────────────────────────┐
│                   Resolution Consequences                        │
├─────────────────────────────────────────────────────────────────┤
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ REFRESH DIFF (Recommended)                               │    │
│  │                                                          │    │
│  │  • Re-reads current file content                        │    │
│  │  • Recomputes diff against latest version               │    │
│  │  • Returns to Apply Dialog with updated preview         │    │
│  │  • User's external edits are preserved                  │    │
│  │  • Proposed changes may need adjustment                 │    │
│  │                                                          │    │
│  │  Result: User sees accurate diff, can make decision     │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ FORCE APPLY (Warning)                                    │    │
│  │                                                          │    │
│  │  ⚠ Ignores external modifications                       │    │
│  │  ⚠ Overwrites file with proposed content                │    │
│  │  ⚠ Recent edits will be lost                            │    │
│  │  ✓ Backup created if enabled                            │    │
│  │  ✓ Can undo within time window                          │    │
│  │                                                          │    │
│  │  Result: Proposed changes applied, external edits lost  │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
│  ┌─────────────────────────────────────────────────────────┐    │
│  │ CANCEL                                                   │    │
│  │                                                          │    │
│  │  • Closes conflict dialog                               │    │
│  │  • No changes made to file                              │    │
│  │  • Proposal remains available                           │    │
│  │  • User can retry apply later                           │    │
│  │                                                          │    │
│  │  Result: No changes, safe abort                         │    │
│  └─────────────────────────────────────────────────────────┘    │
│                                                                  │
└─────────────────────────────────────────────────────────────────┘
```

---

## Detailed Design

### 1. ConflictResolution Enumeration

```csharp
// src/SeniorIntern.Desktop/Enums/ConflictResolution.cs
namespace SeniorIntern.Desktop.Enums;

/// <summary>
/// Specifies the user's chosen resolution for a file conflict.
/// </summary>
public enum ConflictResolution
{
    /// <summary>
    /// User cancelled the operation. No changes will be made.
    /// </summary>
    Cancel = 0,

    /// <summary>
    /// User requested to refresh the diff against current file content.
    /// The Apply Dialog should be shown again with updated diff.
    /// </summary>
    RefreshDiff = 1,

    /// <summary>
    /// User chose to force apply despite the conflict.
    /// The file will be overwritten with proposed changes.
    /// </summary>
    ForceApply = 2
}
```

### 2. ConflictWarningDialogViewModel

```csharp
// src/SeniorIntern.Desktop/ViewModels/ConflictWarningDialogViewModel.cs
using System.IO;
using Avalonia.Controls;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using SeniorIntern.Desktop.Enums;
using SeniorIntern.Services.Enums;
using SeniorIntern.Services.Models;

namespace SeniorIntern.Desktop.ViewModels;

/// <summary>
/// ViewModel for the Conflict Warning dialog.
/// Presents conflict information and resolution options to the user.
/// </summary>
public partial class ConflictWarningDialogViewModel : ViewModelBase
{
    private readonly Window _dialog;

    #region Observable Properties

    /// <summary>
    /// Gets the full path to the conflicting file.
    /// </summary>
    [ObservableProperty]
    private string _filePath = string.Empty;

    /// <summary>
    /// Gets the file name (without directory) for display.
    /// </summary>
    [ObservableProperty]
    private string _fileName = string.Empty;

    /// <summary>
    /// Gets the human-readable conflict message.
    /// </summary>
    [ObservableProperty]
    private string _conflictMessage = string.Empty;

    /// <summary>
    /// Gets the specific reason for the conflict.
    /// </summary>
    [ObservableProperty]
    private ConflictReason _conflictReason;

    /// <summary>
    /// Gets the file's last modification time.
    /// </summary>
    [ObservableProperty]
    private DateTime _lastModified;

    /// <summary>
    /// Gets when the original snapshot was taken.
    /// </summary>
    [ObservableProperty]
    private DateTime _snapshotTime;

    /// <summary>
    /// Gets the user's selected resolution.
    /// </summary>
    [ObservableProperty]
    private ConflictResolution _selectedResolution = ConflictResolution.Cancel;

    #endregion

    #region Computed Properties

    /// <summary>
    /// Gets the time elapsed since the snapshot was taken.
    /// </summary>
    public TimeSpan TimeSinceSnapshot => DateTime.UtcNow - SnapshotTime;

    /// <summary>
    /// Gets a human-readable description of time since snapshot.
    /// </summary>
    public string TimeSinceSnapshotText => FormatTimeSpan(TimeSinceSnapshot);

    /// <summary>
    /// Gets the icon data key based on conflict reason.
    /// </summary>
    public string ConflictIconKey => ConflictReason switch
    {
        ConflictReason.FileCreated => "FilePlusIcon",
        ConflictReason.FileDeleted => "FileMinusIcon",
        ConflictReason.ContentModified => "FileEditIcon",
        ConflictReason.PermissionChanged => "FileLockIcon",
        _ => "WarningIcon"
    };

    /// <summary>
    /// Gets a detailed explanation based on conflict reason.
    /// </summary>
    public string ConflictExplanation => ConflictReason switch
    {
        ConflictReason.FileCreated =>
            "This file was created after the proposal was generated. " +
            "Force applying will overwrite the newly created file.",

        ConflictReason.FileDeleted =>
            "This file was deleted after the proposal was generated. " +
            "Force applying will recreate the file with the proposed content.",

        ConflictReason.ContentModified =>
            "This file has been modified since the proposal was generated. " +
            "Force applying may overwrite recent edits.",

        ConflictReason.PermissionChanged =>
            "File permissions have changed since the proposal was generated. " +
            "You may need to check file access before applying.",

        _ =>
            "The file state has changed since the proposal was generated. " +
            "Review the conflict details before proceeding."
    };

    /// <summary>
    /// Gets whether force apply should show extra warning for destructive scenarios.
    /// </summary>
    public bool IsDestructiveConflict => ConflictReason is
        ConflictReason.ContentModified or
        ConflictReason.FileCreated;

    #endregion

    /// <summary>
    /// Initializes a new instance of the ConflictWarningDialogViewModel.
    /// </summary>
    /// <param name="conflict">The conflict information.</param>
    /// <param name="filePath">The path to the conflicting file.</param>
    /// <param name="dialog">The dialog window instance.</param>
    public ConflictWarningDialogViewModel(
        ConflictInfo conflict,
        string filePath,
        Window dialog)
    {
        ArgumentNullException.ThrowIfNull(conflict);
        ArgumentException.ThrowIfNullOrWhiteSpace(filePath);
        ArgumentNullException.ThrowIfNull(dialog);

        _dialog = dialog;

        FilePath = filePath;
        FileName = Path.GetFileName(filePath);
        ConflictMessage = conflict.Message ?? GetDefaultMessage(conflict.Reason);
        ConflictReason = conflict.Reason;
        LastModified = conflict.LastModified ?? DateTime.UtcNow;
        SnapshotTime = conflict.SnapshotTime ?? DateTime.UtcNow;
    }

    #region Commands

    /// <summary>
    /// Selects the Refresh Diff resolution and closes the dialog.
    /// </summary>
    [RelayCommand]
    private void RefreshDiff()
    {
        SelectedResolution = ConflictResolution.RefreshDiff;
        _dialog.Close(SelectedResolution);
    }

    /// <summary>
    /// Selects the Force Apply resolution and closes the dialog.
    /// </summary>
    [RelayCommand]
    private void ForceApply()
    {
        SelectedResolution = ConflictResolution.ForceApply;
        _dialog.Close(SelectedResolution);
    }

    /// <summary>
    /// Selects the Cancel resolution and closes the dialog.
    /// </summary>
    [RelayCommand]
    private void Cancel()
    {
        SelectedResolution = ConflictResolution.Cancel;
        _dialog.Close(SelectedResolution);
    }

    #endregion

    #region Private Helpers

    /// <summary>
    /// Gets a default message for a conflict reason.
    /// </summary>
    private static string GetDefaultMessage(ConflictReason reason) => reason switch
    {
        ConflictReason.FileCreated => "File was created after the proposal was generated",
        ConflictReason.FileDeleted => "File was deleted after the proposal was generated",
        ConflictReason.ContentModified => "File content has been modified",
        ConflictReason.PermissionChanged => "File permissions have changed",
        _ => "File has been modified"
    };

    /// <summary>
    /// Formats a TimeSpan into a human-readable string.
    /// </summary>
    private static string FormatTimeSpan(TimeSpan timeSpan)
    {
        if (timeSpan.TotalSeconds < 60)
            return "just now";
        if (timeSpan.TotalMinutes < 60)
            return $"{(int)timeSpan.TotalMinutes} minute{((int)timeSpan.TotalMinutes == 1 ? "" : "s")} ago";
        if (timeSpan.TotalHours < 24)
            return $"{(int)timeSpan.TotalHours} hour{((int)timeSpan.TotalHours == 1 ? "" : "s")} ago";

        return $"{(int)timeSpan.TotalDays} day{((int)timeSpan.TotalDays == 1 ? "" : "s")} ago";
    }

    #endregion
}
```

### 3. ConflictWarningDialog.axaml (View)

```xml
<!-- src/SeniorIntern.Desktop/Views/ConflictWarningDialog.axaml -->
<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
        mc:Ignorable="d"
        x:Class="SeniorIntern.Desktop.Views.ConflictWarningDialog"
        x:DataType="vm:ConflictWarningDialogViewModel"
        Title="File Conflict Detected"
        Width="520"
        Height="380"
        MinWidth="400"
        MinHeight="300"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        SystemDecorations="Full"
        ExtendClientAreaToDecorationsHint="False"
        ShowInTaskbar="False">

    <Window.KeyBindings>
        <KeyBinding Gesture="Escape" Command="{Binding CancelCommand}" />
        <KeyBinding Gesture="Enter" Command="{Binding RefreshDiffCommand}" />
    </Window.KeyBindings>

    <Grid RowDefinitions="Auto, *, Auto" Margin="24">

        <!-- Header Section -->
        <StackPanel Grid.Row="0"
                    Spacing="12"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,16">

            <!-- Warning Icon -->
            <Border Background="{DynamicResource WarningBackgroundSubtle}"
                    CornerRadius="24"
                    Width="64"
                    Height="64"
                    HorizontalAlignment="Center">
                <PathIcon Data="{StaticResource WarningIcon}"
                          Width="32"
                          Height="32"
                          Foreground="{DynamicResource WarningForeground}" />
            </Border>

            <!-- Title -->
            <TextBlock Text="File Conflict Detected"
                       FontSize="20"
                       FontWeight="SemiBold"
                       HorizontalAlignment="Center"
                       Foreground="{DynamicResource TextPrimary}" />
        </StackPanel>

        <!-- Content Section -->
        <StackPanel Grid.Row="1" Spacing="16">

            <!-- Conflict Message -->
            <TextBlock Text="{Binding ConflictMessage}"
                       TextWrapping="Wrap"
                       TextAlignment="Center"
                       FontSize="14"
                       Foreground="{DynamicResource TextSecondary}"
                       LineHeight="22" />

            <!-- Conflict Explanation -->
            <TextBlock Text="{Binding ConflictExplanation}"
                       TextWrapping="Wrap"
                       TextAlignment="Center"
                       FontSize="13"
                       Foreground="{DynamicResource TextMuted}"
                       LineHeight="20"
                       Margin="0,0,0,8" />

            <!-- File Information Card -->
            <Border Background="{DynamicResource SurfaceBackground}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="16">
                <Grid RowDefinitions="Auto, Auto, Auto, Auto" ColumnDefinitions="Auto, *">

                    <!-- File Label -->
                    <TextBlock Grid.Row="0" Grid.Column="0"
                               Text="File:"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextMuted}"
                               FontSize="12"
                               Margin="0,0,12,4" />

                    <!-- File Path -->
                    <TextBlock Grid.Row="0" Grid.Column="1"
                               Text="{Binding FilePath}"
                               FontFamily="Cascadia Code, Consolas, monospace"
                               FontSize="12"
                               Foreground="{DynamicResource TextPrimary}"
                               TextTrimming="CharacterEllipsis"
                               ToolTip.Tip="{Binding FilePath}"
                               Margin="0,0,0,4" />

                    <!-- Last Modified Label -->
                    <TextBlock Grid.Row="1" Grid.Column="0"
                               Text="Modified:"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextMuted}"
                               FontSize="12"
                               Margin="0,8,12,4" />

                    <!-- Last Modified Value -->
                    <TextBlock Grid.Row="1" Grid.Column="1"
                               FontSize="12"
                               Foreground="{DynamicResource TextPrimary}"
                               Margin="0,8,0,4">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0:g}">
                                <Binding Path="LastModified" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>

                    <!-- Snapshot Label -->
                    <TextBlock Grid.Row="2" Grid.Column="0"
                               Text="Snapshot:"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource TextMuted}"
                               FontSize="12"
                               Margin="0,4,12,4" />

                    <!-- Snapshot Value -->
                    <TextBlock Grid.Row="2" Grid.Column="1"
                               FontSize="12"
                               Foreground="{DynamicResource TextPrimary}"
                               Margin="0,4,0,4">
                        <TextBlock.Text>
                            <MultiBinding StringFormat="{}{0:g}">
                                <Binding Path="SnapshotTime" />
                            </MultiBinding>
                        </TextBlock.Text>
                    </TextBlock>

                    <!-- Time Since Snapshot -->
                    <TextBlock Grid.Row="3" Grid.Column="1"
                               Text="{Binding TimeSinceSnapshotText, StringFormat='({0})'}"
                               FontSize="11"
                               Foreground="{DynamicResource TextMuted}"
                               FontStyle="Italic"
                               Margin="0,2,0,0" />
                </Grid>
            </Border>
        </StackPanel>

        <!-- Actions Section -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Spacing="12"
                    Margin="0,24,0,0">

            <!-- Refresh Diff Button (Recommended) -->
            <Button Command="{Binding RefreshDiffCommand}"
                    MinWidth="120"
                    Classes="accent primary"
                    ToolTip.Tip="Recompute diff against current file content (Recommended)">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <PathIcon Data="{StaticResource RefreshIcon}"
                              Width="14"
                              Height="14" />
                    <TextBlock Text="Refresh Diff" />
                </StackPanel>
            </Button>

            <!-- Force Apply Button (Warning) -->
            <Button Command="{Binding ForceApplyCommand}"
                    MinWidth="110"
                    Classes="warning"
                    ToolTip.Tip="Overwrite file with proposed changes (may lose recent edits)">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <PathIcon Data="{StaticResource AlertTriangleIcon}"
                              Width="14"
                              Height="14" />
                    <TextBlock Text="Force Apply" />
                </StackPanel>
            </Button>

            <!-- Cancel Button -->
            <Button Content="Cancel"
                    Command="{Binding CancelCommand}"
                    MinWidth="80"
                    Classes="secondary"
                    ToolTip.Tip="Cancel without making changes" />
        </StackPanel>
    </Grid>
</Window>
```

### 4. ConflictWarningDialog.axaml.cs (Code-Behind)

```csharp
// src/SeniorIntern.Desktop/Views/ConflictWarningDialog.axaml.cs
using Avalonia.Controls;
using SeniorIntern.Desktop.Enums;
using SeniorIntern.Desktop.ViewModels;
using SeniorIntern.Services.Models;

namespace SeniorIntern.Desktop.Views;

/// <summary>
/// Conflict Warning dialog window.
/// Displays conflict information and allows user to choose a resolution.
/// </summary>
public partial class ConflictWarningDialog : Window
{
    /// <summary>
    /// Initializes a new instance of the ConflictWarningDialog.
    /// </summary>
    public ConflictWarningDialog()
    {
        InitializeComponent();
    }

    /// <summary>
    /// Shows the Conflict Warning dialog and returns the user's resolution choice.
    /// </summary>
    /// <param name="parent">The parent window.</param>
    /// <param name="conflict">The conflict information.</param>
    /// <param name="filePath">The path to the conflicting file.</param>
    /// <returns>The user's chosen resolution.</returns>
    public static async Task<ConflictResolution> ShowAsync(
        Window parent,
        ConflictInfo conflict,
        string filePath)
    {
        ArgumentNullException.ThrowIfNull(parent);
        ArgumentNullException.ThrowIfNull(conflict);
        ArgumentException.ThrowIfNullOrWhiteSpace(filePath);

        var dialog = new ConflictWarningDialog();
        dialog.DataContext = new ConflictWarningDialogViewModel(conflict, filePath, dialog);

        var result = await dialog.ShowDialog<ConflictResolution?>(parent);
        return result ?? ConflictResolution.Cancel;
    }

    /// <summary>
    /// Shows the Conflict Warning dialog for a specific conflict reason.
    /// </summary>
    /// <param name="parent">The parent window.</param>
    /// <param name="filePath">The path to the conflicting file.</param>
    /// <param name="reason">The conflict reason.</param>
    /// <param name="lastModified">When the file was last modified.</param>
    /// <param name="snapshotTime">When the snapshot was taken.</param>
    /// <returns>The user's chosen resolution.</returns>
    public static Task<ConflictResolution> ShowAsync(
        Window parent,
        string filePath,
        ConflictReason reason,
        DateTime? lastModified = null,
        DateTime? snapshotTime = null)
    {
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            Reason = reason,
            LastModified = lastModified,
            SnapshotTime = snapshotTime
        };

        return ShowAsync(parent, conflict, filePath);
    }
}
```

### 5. Dialog Styles

```xml
<!-- src/SeniorIntern.Desktop/Styles/ConflictDialogStyles.axaml -->
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Warning Button Style -->
    <Style Selector="Button.warning">
        <Setter Property="Background" Value="{DynamicResource WarningBackgroundSubtle}" />
        <Setter Property="Foreground" Value="{DynamicResource WarningForeground}" />
        <Setter Property="BorderBrush" Value="{DynamicResource WarningBorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
    </Style>

    <Style Selector="Button.warning:pointerover">
        <Setter Property="Background" Value="{DynamicResource WarningBackground}" />
        <Setter Property="Foreground" Value="{DynamicResource WarningForegroundStrong}" />
    </Style>

    <Style Selector="Button.warning:pressed">
        <Setter Property="Background" Value="{DynamicResource WarningBackgroundPressed}" />
    </Style>

    <Style Selector="Button.warning PathIcon">
        <Setter Property="Foreground" Value="{DynamicResource WarningForeground}" />
    </Style>

    <!-- Secondary Button Style -->
    <Style Selector="Button.secondary">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}" />
        <Setter Property="BorderThickness" Value="1" />
        <Setter Property="Foreground" Value="{DynamicResource TextSecondary}" />
    </Style>

    <Style Selector="Button.secondary:pointerover">
        <Setter Property="Background" Value="{DynamicResource SurfaceHoverBrush}" />
    </Style>

    <Style Selector="Button.secondary:pressed">
        <Setter Property="Background" Value="{DynamicResource SurfacePressedBrush}" />
    </Style>

</Styles>
```

### 6. Required Theme Resources

```xml
<!-- Additions to Dark.axaml -->
<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Warning Colors -->
    <Color x:Key="WarningColor">#F59E0B</Color>
    <Color x:Key="WarningColorLight">#FCD34D</Color>
    <Color x:Key="WarningColorDark">#D97706</Color>

    <SolidColorBrush x:Key="WarningForeground" Color="{StaticResource WarningColor}" />
    <SolidColorBrush x:Key="WarningForegroundStrong" Color="{StaticResource WarningColorLight}" />
    <SolidColorBrush x:Key="WarningBackground" Color="#44F59E0B" />
    <SolidColorBrush x:Key="WarningBackgroundSubtle" Color="#22F59E0B" />
    <SolidColorBrush x:Key="WarningBackgroundPressed" Color="#55F59E0B" />
    <SolidColorBrush x:Key="WarningBorderBrush" Color="#66F59E0B" />

</ResourceDictionary>

<!-- Additions to Light.axaml -->
<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Warning Colors (Light Theme) -->
    <Color x:Key="WarningColor">#D97706</Color>
    <Color x:Key="WarningColorLight">#F59E0B</Color>
    <Color x:Key="WarningColorDark">#B45309</Color>

    <SolidColorBrush x:Key="WarningForeground" Color="{StaticResource WarningColor}" />
    <SolidColorBrush x:Key="WarningForegroundStrong" Color="{StaticResource WarningColorDark}" />
    <SolidColorBrush x:Key="WarningBackground" Color="#33F59E0B" />
    <SolidColorBrush x:Key="WarningBackgroundSubtle" Color="#18F59E0B" />
    <SolidColorBrush x:Key="WarningBackgroundPressed" Color="#44F59E0B" />
    <SolidColorBrush x:Key="WarningBorderBrush" Color="#55D97706" />

</ResourceDictionary>
```

### 7. Required Icon Resources

```xml
<!-- Additions to Icons.axaml -->
<ResourceDictionary xmlns="https://github.com/avaloniaui"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Warning Icon (Triangle with Exclamation) -->
    <StreamGeometry x:Key="WarningIcon">
        M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16
    </StreamGeometry>

    <!-- Alert Triangle Icon (Smaller variant) -->
    <StreamGeometry x:Key="AlertTriangleIcon">
        M12,2L1,21H23M12,6L19.53,19H4.47M11,10V14H13V10M11,16V18H13V16
    </StreamGeometry>

    <!-- Refresh Icon -->
    <StreamGeometry x:Key="RefreshIcon">
        M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z
    </StreamGeometry>

    <!-- File Plus Icon (for FileCreated) -->
    <StreamGeometry x:Key="FilePlusIcon">
        M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M15,13H13V16H10V18H13V21H15V18H18V16H15V13Z
    </StreamGeometry>

    <!-- File Minus Icon (for FileDeleted) -->
    <StreamGeometry x:Key="FileMinusIcon">
        M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M10,14H18V16H10V14Z
    </StreamGeometry>

    <!-- File Edit Icon (for ContentModified) -->
    <StreamGeometry x:Key="FileEditIcon">
        M6,2C4.89,2 4,2.89 4,4V20A2,2 0 0,0 6,22H10V20.09L12.09,18H6V16H14.09L16.09,14H6V12H18.09L20,10.09V8L14,2H6M13,3.5L18.5,9H13V3.5M20.15,13C20,13 19.86,13.05 19.75,13.16L18.73,14.18L20.82,16.26L21.84,15.25C22.05,15.03 22.05,14.67 21.84,14.46L20.54,13.16C20.43,13.05 20.29,13 20.15,13M18.14,14.77L12,20.92V23H14.08L20.23,16.85L18.14,14.77Z
    </StreamGeometry>

    <!-- File Lock Icon (for PermissionChanged) -->
    <StreamGeometry x:Key="FileLockIcon">
        M6,2C4.89,2 4,2.9 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2H6M13,3.5L18.5,9H13V3.5M12,11A3,3 0 0,1 15,14V15H16V19H8V15H9V14A3,3 0 0,1 12,11M12,13A1,1 0 0,0 11,14V15H13V14A1,1 0 0,0 12,13Z
    </StreamGeometry>

</ResourceDictionary>
```

### 8. Integration with Apply Dialog Workflow

```csharp
// Example: Integration in MainViewModel or ApplyChangesDialogViewModel
public partial class MainViewModel : ViewModelBase
{
    private readonly IConflictDetector _conflictDetector;
    private readonly IDiffService _diffService;
    private readonly IFileChangeService _changeService;

    /// <summary>
    /// Applies a code block with conflict detection and resolution.
    /// </summary>
    public async Task ApplyWithConflictHandlingAsync(
        CodeBlock codeBlock,
        Window parentWindow)
    {
        var filePath = codeBlock.TargetFilePath;

        // Check for conflicts
        var conflict = await _conflictDetector.CheckConflictAsync(filePath);

        if (conflict.HasConflict)
        {
            // Show conflict dialog
            var resolution = await ConflictWarningDialog.ShowAsync(
                parentWindow,
                conflict,
                filePath);

            switch (resolution)
            {
                case ConflictResolution.Cancel:
                    // User cancelled - do nothing
                    return;

                case ConflictResolution.RefreshDiff:
                    // Refresh the diff and show apply dialog again
                    await RefreshAndShowApplyDialogAsync(codeBlock, parentWindow);
                    return;

                case ConflictResolution.ForceApply:
                    // Force apply - skip conflict check
                    await ForceApplyCodeBlockAsync(codeBlock, parentWindow);
                    return;
            }
        }

        // No conflict - proceed with normal apply
        await ShowApplyDialogAsync(codeBlock, parentWindow);
    }

    /// <summary>
    /// Refreshes the diff and shows the apply dialog.
    /// </summary>
    private async Task RefreshAndShowApplyDialogAsync(
        CodeBlock codeBlock,
        Window parentWindow)
    {
        // Take new snapshot
        await _conflictDetector.TakeSnapshotAsync(codeBlock.TargetFilePath);

        // Recompute diff against current content
        var currentContent = await ReadCurrentContentAsync(codeBlock.TargetFilePath);
        var diff = await _diffService.ComputeDiffAsync(
            currentContent,
            codeBlock.Content,
            codeBlock.TargetFilePath);

        // Show apply dialog with refreshed diff
        await ApplyChangesDialog.ShowAsync(
            parentWindow,
            codeBlock,
            diff,
            _serviceProvider);
    }

    /// <summary>
    /// Force applies a code block, skipping conflict detection.
    /// </summary>
    private async Task ForceApplyCodeBlockAsync(
        CodeBlock codeBlock,
        Window parentWindow)
    {
        var options = new ApplyOptions
        {
            CreateBackup = true,
            CheckForConflicts = false // Skip conflict check
        };

        var result = await _changeService.ApplyCodeBlockAsync(
            codeBlock,
            _workspaceService.CurrentWorkspacePath,
            options);

        if (result.Success)
        {
            await ShowSuccessNotificationAsync(codeBlock.TargetFilePath);
        }
        else
        {
            await ShowErrorDialogAsync(result.ErrorMessage, parentWindow);
        }
    }
}
```

---

## Files to Create

| File | Purpose |
|------|---------|
| `src/SeniorIntern.Desktop/Enums/ConflictResolution.cs` | Resolution choice enumeration |
| `src/SeniorIntern.Desktop/ViewModels/ConflictWarningDialogViewModel.cs` | Dialog ViewModel |
| `src/SeniorIntern.Desktop/Views/ConflictWarningDialog.axaml` | Dialog UI |
| `src/SeniorIntern.Desktop/Views/ConflictWarningDialog.axaml.cs` | Dialog code-behind |
| `src/SeniorIntern.Desktop/Styles/ConflictDialogStyles.axaml` | Warning button styles |

## Files to Modify

| File | Changes |
|------|---------|
| `src/SeniorIntern.Desktop/Resources/Icons.axaml` | Add WarningIcon, RefreshIcon, file conflict icons |
| `src/SeniorIntern.Desktop/Resources/Dark.axaml` | Add warning color resources |
| `src/SeniorIntern.Desktop/Resources/Light.axaml` | Add warning color resources (light theme) |
| `src/SeniorIntern.Desktop/App.axaml` | Include ConflictDialogStyles.axaml |
| `src/SeniorIntern.Desktop/ViewModels/MainViewModel.cs` | Integrate conflict handling workflow |

---

## Testing Strategy

### Unit Tests

```csharp
// tests/SeniorIntern.Desktop.Tests/ViewModels/ConflictWarningDialogViewModelTests.cs
namespace SeniorIntern.Desktop.Tests.ViewModels;

public class ConflictWarningDialogViewModelTests
{
    private readonly Mock<Window> _mockDialog;

    public ConflictWarningDialogViewModelTests()
    {
        _mockDialog = new Mock<Window>();
    }

    private ConflictWarningDialogViewModel CreateViewModel(
        ConflictInfo? conflict = null,
        string filePath = "/test/file.cs")
    {
        conflict ??= new ConflictInfo
        {
            HasConflict = true,
            Reason = ConflictReason.ContentModified,
            Message = "File has been modified",
            LastModified = DateTime.UtcNow,
            SnapshotTime = DateTime.UtcNow.AddMinutes(-10)
        };

        return new ConflictWarningDialogViewModel(conflict, filePath, _mockDialog.Object);
    }

    #region Initialization Tests

    [Fact]
    public void Constructor_ExtractsFileNameFromPath()
    {
        // Arrange & Act
        var vm = CreateViewModel(filePath: "/path/to/MyFile.cs");

        // Assert
        Assert.Equal("MyFile.cs", vm.FileName);
    }

    [Fact]
    public void Constructor_SetsFilePath()
    {
        // Arrange & Act
        var vm = CreateViewModel(filePath: "/path/to/MyFile.cs");

        // Assert
        Assert.Equal("/path/to/MyFile.cs", vm.FilePath);
    }

    [Fact]
    public void Constructor_SetsConflictMessage()
    {
        // Arrange
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            Message = "Custom conflict message"
        };

        // Act
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Equal("Custom conflict message", vm.ConflictMessage);
    }

    [Fact]
    public void Constructor_SetsDefaultMessageWhenNull()
    {
        // Arrange
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            Reason = ConflictReason.FileDeleted,
            Message = null
        };

        // Act
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Contains("deleted", vm.ConflictMessage, StringComparison.OrdinalIgnoreCase);
    }

    [Fact]
    public void Constructor_SetsLastModified()
    {
        // Arrange
        var lastModified = new DateTime(2026, 1, 10, 15, 30, 0);
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            LastModified = lastModified
        };

        // Act
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Equal(lastModified, vm.LastModified);
    }

    [Fact]
    public void Constructor_SetsSnapshotTime()
    {
        // Arrange
        var snapshotTime = new DateTime(2026, 1, 10, 15, 20, 0);
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            SnapshotTime = snapshotTime
        };

        // Act
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Equal(snapshotTime, vm.SnapshotTime);
    }

    [Fact]
    public void Constructor_NullConflict_ThrowsArgumentNullException()
    {
        // Act & Assert
        Assert.Throws<ArgumentNullException>(() =>
            new ConflictWarningDialogViewModel(null!, "/test/file.cs", _mockDialog.Object));
    }

    [Fact]
    public void Constructor_EmptyFilePath_ThrowsArgumentException()
    {
        // Act & Assert
        Assert.Throws<ArgumentException>(() =>
            new ConflictWarningDialogViewModel(
                new ConflictInfo { HasConflict = true },
                "",
                _mockDialog.Object));
    }

    [Fact]
    public void Constructor_NullDialog_ThrowsArgumentNullException()
    {
        // Act & Assert
        Assert.Throws<ArgumentNullException>(() =>
            new ConflictWarningDialogViewModel(
                new ConflictInfo { HasConflict = true },
                "/test/file.cs",
                null!));
    }

    #endregion

    #region Command Tests

    [Fact]
    public void RefreshDiffCommand_SetsResolutionAndClosesDialog()
    {
        // Arrange
        var vm = CreateViewModel();

        // Act
        vm.RefreshDiffCommand.Execute(null);

        // Assert
        Assert.Equal(ConflictResolution.RefreshDiff, vm.SelectedResolution);
        _mockDialog.Verify(d => d.Close(ConflictResolution.RefreshDiff), Times.Once);
    }

    [Fact]
    public void ForceApplyCommand_SetsResolutionAndClosesDialog()
    {
        // Arrange
        var vm = CreateViewModel();

        // Act
        vm.ForceApplyCommand.Execute(null);

        // Assert
        Assert.Equal(ConflictResolution.ForceApply, vm.SelectedResolution);
        _mockDialog.Verify(d => d.Close(ConflictResolution.ForceApply), Times.Once);
    }

    [Fact]
    public void CancelCommand_SetsResolutionAndClosesDialog()
    {
        // Arrange
        var vm = CreateViewModel();

        // Act
        vm.CancelCommand.Execute(null);

        // Assert
        Assert.Equal(ConflictResolution.Cancel, vm.SelectedResolution);
        _mockDialog.Verify(d => d.Close(ConflictResolution.Cancel), Times.Once);
    }

    [Fact]
    public void DefaultSelectedResolution_IsCancel()
    {
        // Arrange & Act
        var vm = CreateViewModel();

        // Assert
        Assert.Equal(ConflictResolution.Cancel, vm.SelectedResolution);
    }

    #endregion

    #region Computed Property Tests

    [Theory]
    [InlineData(ConflictReason.ContentModified, true)]
    [InlineData(ConflictReason.FileCreated, true)]
    [InlineData(ConflictReason.FileDeleted, false)]
    [InlineData(ConflictReason.PermissionChanged, false)]
    public void IsDestructiveConflict_CorrectForReason(ConflictReason reason, bool expected)
    {
        // Arrange
        var conflict = new ConflictInfo { HasConflict = true, Reason = reason };
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Equal(expected, vm.IsDestructiveConflict);
    }

    [Fact]
    public void TimeSinceSnapshot_CalculatesCorrectly()
    {
        // Arrange
        var snapshotTime = DateTime.UtcNow.AddMinutes(-15);
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            SnapshotTime = snapshotTime
        };
        var vm = CreateViewModel(conflict: conflict);

        // Act
        var timeSince = vm.TimeSinceSnapshot;

        // Assert
        Assert.InRange(timeSince.TotalMinutes, 14.9, 15.1);
    }

    [Fact]
    public void TimeSinceSnapshotText_FormatsMinutesCorrectly()
    {
        // Arrange
        var snapshotTime = DateTime.UtcNow.AddMinutes(-5);
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            SnapshotTime = snapshotTime
        };
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Contains("5 minutes ago", vm.TimeSinceSnapshotText);
    }

    [Fact]
    public void TimeSinceSnapshotText_FormatsHoursCorrectly()
    {
        // Arrange
        var snapshotTime = DateTime.UtcNow.AddHours(-2);
        var conflict = new ConflictInfo
        {
            HasConflict = true,
            SnapshotTime = snapshotTime
        };
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.Contains("2 hours ago", vm.TimeSinceSnapshotText);
    }

    [Theory]
    [InlineData(ConflictReason.FileCreated)]
    [InlineData(ConflictReason.FileDeleted)]
    [InlineData(ConflictReason.ContentModified)]
    [InlineData(ConflictReason.PermissionChanged)]
    public void ConflictExplanation_NotEmptyForAllReasons(ConflictReason reason)
    {
        // Arrange
        var conflict = new ConflictInfo { HasConflict = true, Reason = reason };
        var vm = CreateViewModel(conflict: conflict);

        // Assert
        Assert.False(string.IsNullOrWhiteSpace(vm.ConflictExplanation));
    }

    #endregion
}
```

### Integration Tests

```csharp
// tests/SeniorIntern.Desktop.Tests/Integration/ConflictDialogIntegrationTests.cs
namespace SeniorIntern.Desktop.Tests.Integration;

public class ConflictDialogIntegrationTests
{
    [Fact]
    public async Task ShowAsync_ReturnsCancel_WhenDialogClosedWithoutSelection()
    {
        // This would be an Avalonia headless test
        // Testing that closing the dialog defaults to Cancel
    }

    [Fact]
    public async Task ConflictWorkflow_RefreshDiff_RecomputesDiff()
    {
        // Integration test for the full conflict → refresh → apply workflow
    }

    [Fact]
    public async Task ConflictWorkflow_ForceApply_OverwritesFile()
    {
        // Integration test verifying force apply behavior
    }
}
```

### Visual/Manual Tests

```markdown
## Manual Test Cases

### TC-001: Dialog Appearance
1. Trigger a file conflict
2. Verify dialog appears with:
   - Warning icon (48x48, amber/yellow color)
   - "File Conflict Detected" title
   - Conflict message
   - File information card
   - Three action buttons

### TC-002: Refresh Diff Flow
1. Trigger file conflict
2. Click "Refresh Diff"
3. Verify dialog closes
4. Verify Apply Dialog appears with updated diff

### TC-003: Force Apply Flow
1. Trigger file conflict
2. Click "Force Apply"
3. Verify dialog closes
4. Verify file is overwritten with proposed content
5. Verify backup is created (if enabled)

### TC-004: Cancel Flow
1. Trigger file conflict
2. Click "Cancel" OR press Escape
3. Verify dialog closes
4. Verify no changes made to file

### TC-005: Keyboard Navigation
1. Open conflict dialog
2. Verify Tab moves focus between buttons
3. Verify Enter triggers "Refresh Diff" (default)
4. Verify Escape triggers "Cancel"

### TC-006: Theme Support
1. Open conflict dialog in dark theme
2. Verify warning colors are visible and appropriate
3. Switch to light theme
4. Verify warning colors adapt correctly
```

---

## Acceptance Criteria

### Functional Requirements

- [ ] **Warning icon displayed** - Large warning icon visible in header
- [ ] **Conflict message displayed** - Human-readable conflict description shown
- [ ] **File path displayed** - Full path to conflicting file shown with ellipsis truncation
- [ ] **Last modified timestamp shown** - File's modification time displayed
- [ ] **Snapshot timestamp shown** - When proposal was generated displayed
- [ ] **Time since snapshot shown** - Human-readable elapsed time ("5 minutes ago")
- [ ] **Refresh Diff option works** - Returns `RefreshDiff` resolution
- [ ] **Force Apply option works** - Returns `ForceApply` resolution
- [ ] **Cancel closes dialog** - Returns `Cancel` resolution
- [ ] **Escape key cancels** - Keyboard shortcut works
- [ ] **Enter key refreshes diff** - Default action is safe option

### Non-Functional Requirements

- [ ] **Dialog is modal** - Blocks interaction with parent window
- [ ] **Dialog centers on parent** - Appears centered over main window
- [ ] **Dialog is not resizable** - Fixed size for consistent appearance
- [ ] **Theme-aware** - Uses DynamicResource for all colors
- [ ] **Warning styling** - Force Apply button uses warning colors

### Integration Requirements

- [ ] **Static ShowAsync method** - Easy to call from any ViewModel
- [ ] **Returns ConflictResolution** - Clear contract for callers
- [ ] **Works with ConflictInfo** - Accepts conflict detection results
- [ ] **Integrates with Apply workflow** - Called when conflict detected

---

## Design Decisions

### 1. Refresh Diff as Default/Recommended Action

**Decision**: Make "Refresh Diff" the primary (accent-styled) button and Enter key trigger.

**Rationale**:
- Safest option - preserves user's external edits
- Allows user to see accurate diff before deciding
- Reduces risk of accidental data loss
- Follows principle of least surprise

**Alternative Considered**:
- Force Apply as default - too risky for accidental activation

### 2. Warning Styling for Force Apply

**Decision**: Use warning colors (amber/yellow) for the Force Apply button.

**Rationale**:
- Clearly indicates potential data loss
- Differentiates from safe options
- Follows established UI patterns for destructive actions
- Does not use error/red (reserved for actual errors)

### 3. Fixed Dialog Size (Non-Resizable)

**Decision**: Dialog has fixed dimensions and cannot be resized.

**Rationale**:
- Content is predictable and fits in fixed space
- Simpler layout without resize handling
- Consistent visual appearance
- File path uses ellipsis for long paths (with tooltip)

### 4. Conflict Explanation Text

**Decision**: Include detailed explanation based on conflict reason.

**Rationale**:
- Helps users understand consequences of each choice
- Reduces confusion about what happened
- Different conflict types have different implications
- Education improves user confidence

### 5. Timestamp Comparison Display

**Decision**: Show both file's last modified time and snapshot time.

**Rationale**:
- Gives context about how stale the snapshot is
- Helps user judge severity of conflict
- "5 minutes ago" vs "2 hours ago" changes decision
- Transparency builds trust

### 6. Three-Button Layout

**Decision**: Three buttons: Refresh Diff, Force Apply, Cancel.

**Rationale**:
- Covers all reasonable user responses
- Refresh Diff is recommended/safe path
- Force Apply for when user is confident
- Cancel for aborting operation entirely
- No merge option (too complex for v0.4.3)

---

## Accessibility Considerations

### Keyboard Navigation

| Key | Action |
|-----|--------|
| Tab | Move focus between buttons |
| Shift+Tab | Move focus backward |
| Enter | Execute Refresh Diff (recommended) |
| Escape | Execute Cancel |
| Space | Activate focused button |

### Screen Reader Support

- Dialog has descriptive title "File Conflict Detected"
- Warning icon has implicit "warning" semantic role
- Buttons have tooltips describing consequences
- File path has tooltip for full path access

### Visual Accessibility

- Warning colors have sufficient contrast
- Icon size (48x48) is clearly visible
- Text sizes follow hierarchy (20pt title, 14pt body, 12pt details)
- Focus indicators visible on all interactive elements

---

## Future Enhancements

1. **Merge option** - Allow manual conflict resolution
2. **Diff preview in dialog** - Show what changed since snapshot
3. **Remember preference** - "Always force apply" / "Always refresh"
4. **Batch conflict handling** - Handle multiple file conflicts at once
5. **External editor integration** - Open in diff tool for comparison
6. **Conflict history** - Show recent conflicts for a file
