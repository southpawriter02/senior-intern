# v0.8.5: Training UI & Polish - Detailed Design Specification

## Overview

This document provides a comprehensive design specification for v0.8.5 of The Senior Intern project. This version creates the complete training user interface including the training wizard, real-time progress monitoring with graphs, adapter management interface, and comprehensive user experience polish. This is the final version of the v0.8.x "Training Lab" series, integrating all previous components into a cohesive, user-friendly training experience.

### Objectives
- Create a multi-step training wizard for guided adapter creation
- Build real-time training progress monitoring with live charts
- Implement hardware utilization gauges with visual feedback
- Design adapter manager for viewing, loading, and managing trained adapters
- Create custom chart controls using LiveCharts for Avalonia
- Build hardware gauge controls for GPU/CPU/Memory visualization
- Implement training log viewer with filtering and search
- Add training presets and templates for common scenarios
- Create notification system for training events
- Polish the overall user experience with animations and feedback

### Prerequisites
- v0.8.1 (Training Infrastructure) completed
- v0.8.2 (Dataset Pipeline) completed
- v0.8.3 (LoRA Training Engine) completed
- v0.8.4 (Hardware Monitoring) completed
- Avalonia UI 11.x with MVVM toolkit
- LiveChartsCore.SkiaSharpView.Avalonia for charting

---

## Architecture Overview

### Training UI Component Stack

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                        MainWindow Navigation                                 │
│   ┌─────────────────────────────────────────────────────────────────────┐   │
│   │  [Chat] [Models] [RAG] [Training Lab] [Settings]                    │   │
│   └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                    v0.8.5: Training Lab UI                                   │
│                                                                              │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                     TrainingLabView                                  │    │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────────┐  │    │
│  │  │  Wizard     │  │  Progress   │  │  Adapter Manager            │  │    │
│  │  │  Panel      │  │  Panel      │  │  Panel                      │  │    │
│  │  └─────────────┘  └─────────────┘  └─────────────────────────────┘  │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                       │
│           ┌──────────────────────────┼──────────────────────────┐           │
│           ▼                          ▼                          ▼           │
│  ┌─────────────────┐    ┌─────────────────────┐    ┌─────────────────┐     │
│  │ TrainingWizard  │    │ TrainingProgress    │    │ AdapterManager  │     │
│  │ Dialog          │    │ View                │    │ View            │     │
│  │ ┌─────────────┐ │    │ ┌─────────────────┐ │    │ ┌─────────────┐ │     │
│  │ │ Step 1:     │ │    │ │ MetricsChart    │ │    │ │ AdapterList │ │     │
│  │ │ Dataset     │ │    │ │ (Loss, LR)      │ │    │ │             │ │     │
│  │ ├─────────────┤ │    │ ├─────────────────┤ │    │ ├─────────────┤ │     │
│  │ │ Step 2:     │ │    │ │ HardwareGauges  │ │    │ │ AdapterCard │ │     │
│  │ │ Config      │ │    │ │ (GPU/CPU/RAM)   │ │    │ │             │ │     │
│  │ ├─────────────┤ │    │ ├─────────────────┤ │    │ ├─────────────┤ │     │
│  │ │ Step 3:     │ │    │ │ LogViewer       │ │    │ │ Actions     │ │     │
│  │ │ Hardware    │ │    │ │                 │ │    │ │             │ │     │
│  │ ├─────────────┤ │    │ └─────────────────┘ │    │ └─────────────┘ │     │
│  │ │ Step 4:     │ │    └─────────────────────┘    └─────────────────┘     │
│  │ │ Review      │ │                                                        │
│  │ └─────────────┘ │                                                        │
│  └─────────────────┘                                                        │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        Custom Controls                                       │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐              │
│  │ MetricsChart    │  │ HardwareGauge   │  │ ProgressRing    │              │
│  │ (LiveCharts)    │  │ (Custom)        │  │ (Custom)        │              │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘              │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐              │
│  │ StepIndicator   │  │ LogViewer       │  │ AdapterCard     │              │
│  │ (Wizard)        │  │ (Virtualized)   │  │ (DataTemplate)  │              │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘              │
└─────────────────────────────────────────────────────────────────────────────┘
                                      │
                                      ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                        ViewModels (MVVM)                                     │
│  ┌─────────────────────────────────────────────────────────────────────┐    │
│  │                  TrainingLabViewModel                                │    │
│  │  • Wizard state management                                          │    │
│  │  • Training job orchestration                                       │    │
│  │  • Adapter collection management                                    │    │
│  │  • Hardware metrics binding                                         │    │
│  └─────────────────────────────────────────────────────────────────────┘    │
│                                      │                                       │
│           ┌──────────────────────────┼──────────────────────────┐           │
│           ▼                          ▼                          ▼           │
│  ┌─────────────────┐    ┌─────────────────────┐    ┌─────────────────┐     │
│  │ DatasetStep     │    │ TrainingProgress    │    │ AdapterManager  │     │
│  │ ViewModel       │    │ ViewModel           │    │ ViewModel       │     │
│  └─────────────────┘    └─────────────────────┘    └─────────────────┘     │
└─────────────────────────────────────────────────────────────────────────────┘
```

### Training Wizard Flow

```
┌──────────────────┐
│  Start Wizard    │
│  (New Adapter)   │
└────────┬─────────┘
         │
         ▼
┌──────────────────┐     ┌───────────────────────────────────────────────────┐
│  Step 1: Dataset │────▶│ • Browse for code folder                         │
│                  │     │ • Analyze code and generate statistics           │
│                  │     │ • Preview example generation                     │
│                  │     │ • Configure languages and file patterns          │
└────────┬─────────┘     └───────────────────────────────────────────────────┘
         │
         ▼
┌──────────────────┐     ┌───────────────────────────────────────────────────┐
│  Step 2: Config  │────▶│ • Set adapter name and description               │
│                  │     │ • Configure LoRA parameters (rank, alpha, dropout)│
│                  │     │ • Set training hyperparameters                   │
│                  │     │ • Select target modules                          │
└────────┬─────────┘     └───────────────────────────────────────────────────┘
         │
         ▼
┌──────────────────┐     ┌───────────────────────────────────────────────────┐
│  Step 3: Hardware│────▶│ • Detect available hardware                      │
│                  │     │ • Select compute device (GPU/CPU)                │
│                  │     │ • View memory estimates                          │
│                  │     │ • Get optimization recommendations               │
└────────┬─────────┘     └───────────────────────────────────────────────────┘
         │
         ▼
┌──────────────────┐     ┌───────────────────────────────────────────────────┐
│  Step 4: Review  │────▶│ • Summary of all configuration                   │
│                  │     │ • Estimated training time                        │
│                  │     │ • Warnings and recommendations                   │
│                  │     │ • Start training button                          │
└────────┬─────────┘     └───────────────────────────────────────────────────┘
         │
         ▼
┌──────────────────┐
│  Training View   │
│  (Progress)      │
└──────────────────┘
```

---

## Sub-version Breakdown

| Version | Focus | Files to Create | Files to Modify |
|---------|-------|-----------------|-----------------|
| v0.8.5a | Training Lab Main View & Navigation | 4 | 1 |
| v0.8.5b | Training Wizard - Steps 1 & 2 | 6 | 0 |
| v0.8.5c | Training Wizard - Steps 3 & 4 | 4 | 0 |
| v0.8.5d | Training Progress View | 4 | 0 |
| v0.8.5e | MetricsChart Control (LiveCharts) | 3 | 0 |
| v0.8.5f | HardwareGauge Control | 3 | 0 |
| v0.8.5g | Log Viewer Control | 3 | 0 |
| v0.8.5h | Adapter Manager View | 4 | 0 |
| v0.8.5i | Training Settings & Presets | 4 | 0 |
| v0.8.5j | Notifications & Polish | 4 | 0 |
| v0.8.5k | Unit Testing & Integration | 8 | 0 |

**Totals: 47 files to create, 1 file to modify**

---

## v0.8.5a: Training Lab Main View & Navigation

### Objective
Create the main Training Lab view with tabbed navigation between the wizard, progress monitoring, and adapter management panels.

### File: `src/SeniorIntern.Desktop/Views/TrainingLabView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:controls="using:SeniorIntern.Desktop.Controls"
             xmlns:views="using:SeniorIntern.Desktop.Views"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="SeniorIntern.Desktop.Views.TrainingLabView"
             x:DataType="vm:TrainingLabViewModel">

    <Design.DataContext>
        <vm:TrainingLabViewModel />
    </Design.DataContext>

    <UserControl.Styles>
        <Style Selector="TabItem">
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Padding" Value="16,8" />
        </Style>
        <Style Selector="TabItem:selected">
            <Setter Property="Foreground" Value="{DynamicResource AccentColor}" />
        </Style>
    </UserControl.Styles>

    <Grid RowDefinitions="Auto,*">
        <!-- Header -->
        <Border Grid.Row="0"
                Background="{DynamicResource CardBackgroundColor}"
                Padding="24,16"
                BorderThickness="0,0,0,1"
                BorderBrush="{DynamicResource BorderColor}">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel Orientation="Horizontal" Spacing="16">
                    <PathIcon Data="{StaticResource TrainingIcon}"
                              Width="32" Height="32"
                              Foreground="{DynamicResource AccentColor}" />
                    <StackPanel>
                        <TextBlock Text="Training Lab"
                                   FontSize="24"
                                   FontWeight="SemiBold" />
                        <TextBlock Text="Fine-tune models with your code style"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="13" />
                    </StackPanel>
                </StackPanel>

                <!-- Quick Actions -->
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            Spacing="8">
                    <Button Content="New Adapter"
                            Command="{Binding StartWizardCommand}"
                            Classes="accent"
                            IsVisible="{Binding !IsTraining}">
                        <Button.Content>
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <PathIcon Data="{StaticResource AddIcon}" Width="16" Height="16" />
                                <TextBlock Text="New Adapter" />
                            </StackPanel>
                        </Button.Content>
                    </Button>
                    <Button Content="Import"
                            Command="{Binding ImportAdapterCommand}"
                            IsVisible="{Binding !IsTraining}" />
                </StackPanel>
            </Grid>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <!-- Training Active Overlay -->
            <views:TrainingProgressView IsVisible="{Binding IsTraining}" />

            <!-- Normal View (Tabs) -->
            <TabControl IsVisible="{Binding !IsTraining}"
                        SelectedIndex="{Binding SelectedTabIndex}">

                <!-- Adapters Tab -->
                <TabItem Header="My Adapters">
                    <views:AdapterManagerView DataContext="{Binding}" />
                </TabItem>

                <!-- Training History Tab -->
                <TabItem Header="Training History">
                    <views:TrainingHistoryView DataContext="{Binding}" />
                </TabItem>

                <!-- Presets Tab -->
                <TabItem Header="Presets">
                    <views:TrainingPresetsView DataContext="{Binding}" />
                </TabItem>
            </TabControl>
        </Grid>

        <!-- Training Wizard Dialog (Modal) -->
        <controls:DialogOverlay IsOpen="{Binding IsWizardOpen}">
            <views:TrainingWizardDialog DataContext="{Binding WizardViewModel}" />
        </controls:DialogOverlay>
    </Grid>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/TrainingLabView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;

public partial class TrainingLabView : UserControl
{
    public TrainingLabView()
    {
        InitializeComponent();
    }
}
```

### File: `src/SeniorIntern.Desktop/ViewModels/TrainingLabViewModel.cs`

```csharp
namespace SeniorIntern.Desktop.ViewModels;

using System.Collections.ObjectModel;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using Microsoft.Extensions.Logging;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Training.Models;

/// <summary>
/// Main ViewModel for the Training Lab view.
/// </summary>
public partial class TrainingLabViewModel : ViewModelBase
{
    private readonly ILogger<TrainingLabViewModel> _logger;
    private readonly ITrainingService _trainingService;
    private readonly IDatasetService _datasetService;
    private readonly IHardwareDetectionService _hardwareService;
    private readonly IHardwareMonitorService _monitorService;

    #region Observable Properties

    // Tab Navigation
    [ObservableProperty]
    private int _selectedTabIndex;

    // Wizard State
    [ObservableProperty]
    private bool _isWizardOpen;

    [ObservableProperty]
    private TrainingWizardViewModel? _wizardViewModel;

    // Training State
    [ObservableProperty]
    private bool _isTraining;

    [ObservableProperty]
    private TrainingProgress? _currentProgress;

    [ObservableProperty]
    private TrainingJob? _currentJob;

    // Adapters
    [ObservableProperty]
    private ObservableCollection<LoraAdapterInfo> _adapters = new();

    [ObservableProperty]
    private LoraAdapterInfo? _selectedAdapter;

    [ObservableProperty]
    private LoraAdapterInfo? _activeAdapter;

    // Metrics History
    [ObservableProperty]
    private ObservableCollection<TrainingMetrics> _metricsHistory = new();

    [ObservableProperty]
    private ObservableCollection<TimestampedMetrics> _hardwareHistory = new();

    // Training History
    [ObservableProperty]
    private ObservableCollection<TrainingHistoryEntry> _trainingHistory = new();

    // Notifications
    [ObservableProperty]
    private ObservableCollection<TrainingNotification> _notifications = new();

    #endregion

    public TrainingLabViewModel(
        ILogger<TrainingLabViewModel> logger,
        ITrainingService trainingService,
        IDatasetService datasetService,
        IHardwareDetectionService hardwareService,
        IHardwareMonitorService monitorService)
    {
        _logger = logger;
        _trainingService = trainingService;
        _datasetService = datasetService;
        _hardwareService = hardwareService;
        _monitorService = monitorService;

        // Subscribe to events
        _trainingService.ProgressChanged += OnTrainingProgress;
        _trainingService.StateChanged += OnTrainingStateChanged;
        _monitorService.MetricsUpdated += OnHardwareMetrics;
        _monitorService.ThermalAlert += OnThermalAlert;
        _monitorService.MemoryAlert += OnMemoryAlert;
    }

    #region Commands

    [RelayCommand]
    private void StartWizard()
    {
        WizardViewModel = new TrainingWizardViewModel(
            _datasetService,
            _hardwareService,
            _trainingService);

        WizardViewModel.WizardCompleted += OnWizardCompleted;
        WizardViewModel.WizardCancelled += OnWizardCancelled;

        IsWizardOpen = true;
        _logger.LogInformation("Training wizard opened");
    }

    [RelayCommand]
    private async Task ImportAdapterAsync()
    {
        var dialog = new OpenFileDialog
        {
            Title = "Import LoRA Adapter",
            Filters = new List<FileDialogFilter>
            {
                new() { Name = "LoRA Adapters", Extensions = { "safetensors", "bin" } },
                new() { Name = "All Files", Extensions = { "*" } }
            }
        };

        var result = await dialog.ShowAsync(GetMainWindow());
        if (result?.Length > 0)
        {
            try
            {
                var adapter = await _trainingService.ImportAdapterAsync(result[0]);
                Adapters.Add(adapter);

                AddNotification(new TrainingNotification
                {
                    Title = "Adapter Imported",
                    Message = $"Successfully imported '{adapter.Name}'",
                    Type = NotificationType.Success
                });
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Failed to import adapter from {Path}", result[0]);
                AddNotification(new TrainingNotification
                {
                    Title = "Import Failed",
                    Message = ex.Message,
                    Type = NotificationType.Error
                });
            }
        }
    }

    [RelayCommand]
    private async Task LoadAdaptersAsync()
    {
        try
        {
            var adapters = await _trainingService.ListAdaptersAsync();
            Adapters = new ObservableCollection<LoraAdapterInfo>(adapters);
            _logger.LogInformation("Loaded {Count} adapters", adapters.Count);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to load adapters");
        }
    }

    [RelayCommand]
    private async Task LoadAdapterAsync(LoraAdapterInfo adapter)
    {
        try
        {
            await _trainingService.LoadAdapterAsync(adapter.Path);
            ActiveAdapter = adapter;

            AddNotification(new TrainingNotification
            {
                Title = "Adapter Loaded",
                Message = $"'{adapter.Name}' is now active",
                Type = NotificationType.Success
            });
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to load adapter {Name}", adapter.Name);
            AddNotification(new TrainingNotification
            {
                Title = "Load Failed",
                Message = ex.Message,
                Type = NotificationType.Error
            });
        }
    }

    [RelayCommand]
    private async Task UnloadAdapterAsync()
    {
        if (ActiveAdapter == null) return;

        try
        {
            await _trainingService.UnloadAdapterAsync();
            var name = ActiveAdapter.Name;
            ActiveAdapter = null;

            AddNotification(new TrainingNotification
            {
                Title = "Adapter Unloaded",
                Message = $"'{name}' has been unloaded",
                Type = NotificationType.Info
            });
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to unload adapter");
        }
    }

    [RelayCommand]
    private async Task DeleteAdapterAsync(LoraAdapterInfo adapter)
    {
        var confirmed = await ShowConfirmDialogAsync(
            "Delete Adapter",
            $"Are you sure you want to delete '{adapter.Name}'?\nThis action cannot be undone.");

        if (confirmed)
        {
            try
            {
                await _trainingService.DeleteAdapterAsync(adapter.Id);
                Adapters.Remove(adapter);

                if (ActiveAdapter?.Id == adapter.Id)
                    ActiveAdapter = null;

                AddNotification(new TrainingNotification
                {
                    Title = "Adapter Deleted",
                    Message = $"'{adapter.Name}' has been deleted",
                    Type = NotificationType.Info
                });
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Failed to delete adapter {Name}", adapter.Name);
            }
        }
    }

    [RelayCommand]
    private async Task ExportAdapterAsync(LoraAdapterInfo adapter)
    {
        var dialog = new SaveFileDialog
        {
            Title = "Export LoRA Adapter",
            InitialFileName = $"{adapter.Name}.safetensors",
            Filters = new List<FileDialogFilter>
            {
                new() { Name = "Safetensors", Extensions = { "safetensors" } }
            }
        };

        var result = await dialog.ShowAsync(GetMainWindow());
        if (!string.IsNullOrEmpty(result))
        {
            try
            {
                await _trainingService.ExportAdapterAsync(adapter.Id, result);

                AddNotification(new TrainingNotification
                {
                    Title = "Adapter Exported",
                    Message = $"'{adapter.Name}' exported to {Path.GetFileName(result)}",
                    Type = NotificationType.Success
                });
            }
            catch (Exception ex)
            {
                _logger.LogError(ex, "Failed to export adapter");
            }
        }
    }

    [RelayCommand]
    private void PauseTraining()
    {
        _trainingService.PauseTraining();
        _logger.LogInformation("Training paused by user");
    }

    [RelayCommand]
    private void ResumeTraining()
    {
        _trainingService.ResumeTraining();
        _logger.LogInformation("Training resumed by user");
    }

    [RelayCommand]
    private async Task StopTrainingAsync()
    {
        var confirmed = await ShowConfirmDialogAsync(
            "Stop Training",
            "Are you sure you want to stop training?\nCurrent progress will be saved as a checkpoint.");

        if (confirmed)
        {
            _trainingService.CancelTraining();
            _logger.LogInformation("Training cancelled by user");
        }
    }

    [RelayCommand]
    private void DismissNotification(TrainingNotification notification)
    {
        Notifications.Remove(notification);
    }

    #endregion

    #region Event Handlers

    private async void OnWizardCompleted(object? sender, TrainingWizardCompletedEventArgs e)
    {
        IsWizardOpen = false;

        if (e.StartTraining && e.Job != null)
        {
            await StartTrainingAsync(e.Job);
        }
    }

    private void OnWizardCancelled(object? sender, EventArgs e)
    {
        IsWizardOpen = false;
        _logger.LogInformation("Training wizard cancelled");
    }

    private async Task StartTrainingAsync(TrainingJob job)
    {
        IsTraining = true;
        CurrentJob = job;
        MetricsHistory.Clear();
        HardwareHistory.Clear();

        _monitorService.StartMonitoring(TimeSpan.FromSeconds(1));

        AddNotification(new TrainingNotification
        {
            Title = "Training Started",
            Message = $"Training adapter '{job.Name}'",
            Type = NotificationType.Info
        });

        try
        {
            var progress = new Progress<TrainingProgress>(p =>
            {
                Dispatcher.UIThread.InvokeAsync(() =>
                {
                    CurrentProgress = p;
                    if (p.CurrentMetrics != null)
                        MetricsHistory.Add(p.CurrentMetrics);
                });
            });

            var result = await _trainingService.TrainAsync(job, progress);

            if (result.Success)
            {
                AddNotification(new TrainingNotification
                {
                    Title = "Training Complete",
                    Message = $"'{job.Name}' trained successfully. Final loss: {result.FinalMetrics?.Loss:F4}",
                    Type = NotificationType.Success
                });

                await LoadAdaptersAsync();

                // Add to history
                TrainingHistory.Insert(0, new TrainingHistoryEntry
                {
                    JobName = job.Name,
                    CompletedAt = DateTime.UtcNow,
                    FinalLoss = result.FinalMetrics?.Loss ?? 0,
                    Duration = result.TotalDuration,
                    Success = true
                });
            }
            else
            {
                AddNotification(new TrainingNotification
                {
                    Title = "Training Failed",
                    Message = result.ErrorMessage ?? "Unknown error occurred",
                    Type = NotificationType.Error
                });
            }
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Training failed with exception");
            AddNotification(new TrainingNotification
            {
                Title = "Training Error",
                Message = ex.Message,
                Type = NotificationType.Error
            });
        }
        finally
        {
            IsTraining = false;
            CurrentJob = null;
            _monitorService.StopMonitoring();
        }
    }

    private void OnTrainingProgress(object? sender, TrainingProgressEventArgs e)
    {
        Dispatcher.UIThread.InvokeAsync(() =>
        {
            CurrentProgress = e.Progress;
        });
    }

    private void OnTrainingStateChanged(object? sender, TrainingStateChangedEventArgs e)
    {
        Dispatcher.UIThread.InvokeAsync(() =>
        {
            _logger.LogInformation("Training state changed to {State}", e.NewState);
        });
    }

    private void OnHardwareMetrics(object? sender, HardwareMetricsEventArgs e)
    {
        Dispatcher.UIThread.InvokeAsync(() =>
        {
            HardwareHistory.Add(new TimestampedMetrics
            {
                Timestamp = DateTime.UtcNow,
                Metrics = e.Metrics
            });

            // Keep last 5 minutes (300 samples at 1/sec)
            while (HardwareHistory.Count > 300)
                HardwareHistory.RemoveAt(0);
        });
    }

    private void OnThermalAlert(object? sender, ThermalAlertEventArgs e)
    {
        Dispatcher.UIThread.InvokeAsync(() =>
        {
            var severity = e.Severity switch
            {
                AlertSeverity.Warning => NotificationType.Warning,
                AlertSeverity.Critical => NotificationType.Error,
                AlertSeverity.Emergency => NotificationType.Error,
                _ => NotificationType.Warning
            };

            AddNotification(new TrainingNotification
            {
                Title = "Thermal Alert",
                Message = $"{e.Component} temperature: {e.CurrentTemperature:F1}°C",
                Type = severity
            });
        });
    }

    private void OnMemoryAlert(object? sender, MemoryAlertEventArgs e)
    {
        Dispatcher.UIThread.InvokeAsync(() =>
        {
            AddNotification(new TrainingNotification
            {
                Title = "Memory Alert",
                Message = $"{e.MemoryType} usage: {e.UsagePercentage:F1}%",
                Type = NotificationType.Warning
            });
        });
    }

    #endregion

    #region Helper Methods

    private void AddNotification(TrainingNotification notification)
    {
        Notifications.Add(notification);

        // Auto-dismiss after 10 seconds for non-errors
        if (notification.Type != NotificationType.Error)
        {
            Task.Delay(10000).ContinueWith(_ =>
            {
                Dispatcher.UIThread.InvokeAsync(() =>
                {
                    Notifications.Remove(notification);
                });
            });
        }
    }

    private async Task<bool> ShowConfirmDialogAsync(string title, string message)
    {
        // Implementation would show a confirmation dialog
        return await Task.FromResult(true);
    }

    private Window GetMainWindow()
    {
        // Get the main window reference
        return Application.Current?.ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop
            ? desktop.MainWindow!
            : throw new InvalidOperationException("No main window");
    }

    #endregion
}
```

### File: `src/SeniorIntern.Desktop/ViewModels/TrainingNotification.cs`

```csharp
namespace SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Represents a notification in the Training Lab.
/// </summary>
public sealed class TrainingNotification
{
    public string Id { get; init; } = Guid.NewGuid().ToString();
    public string Title { get; init; } = string.Empty;
    public string Message { get; init; } = string.Empty;
    public NotificationType Type { get; init; }
    public DateTime CreatedAt { get; init; } = DateTime.UtcNow;
}

/// <summary>
/// Notification severity type.
/// </summary>
public enum NotificationType
{
    Info,
    Success,
    Warning,
    Error
}

/// <summary>
/// Training history entry for completed training runs.
/// </summary>
public sealed class TrainingHistoryEntry
{
    public string Id { get; init; } = Guid.NewGuid().ToString();
    public string JobName { get; init; } = string.Empty;
    public DateTime CompletedAt { get; init; }
    public float FinalLoss { get; init; }
    public TimeSpan Duration { get; init; }
    public bool Success { get; init; }
    public string? ErrorMessage { get; init; }
}
```

---

## v0.8.5b: Training Wizard - Steps 1 & 2

### Objective
Create the first two steps of the training wizard: Dataset Selection and Configuration.

### File: `src/SeniorIntern.Desktop/Views/TrainingWizardDialog.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:controls="using:SeniorIntern.Desktop.Controls"
             mc:Ignorable="d" d:DesignWidth="700" d:DesignHeight="600"
             x:Class="SeniorIntern.Desktop.Views.TrainingWizardDialog"
             x:DataType="vm:TrainingWizardViewModel">

    <Border Background="{DynamicResource CardBackgroundColor}"
            CornerRadius="12"
            Width="700"
            MaxHeight="700"
            BoxShadow="0 8 32 0 #40000000">
        <Grid RowDefinitions="Auto,*,Auto">
            <!-- Header -->
            <Border Grid.Row="0"
                    Padding="24,20"
                    BorderThickness="0,0,0,1"
                    BorderBrush="{DynamicResource BorderColor}">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel>
                        <TextBlock Text="Create New Adapter"
                                   FontSize="20"
                                   FontWeight="SemiBold" />
                        <TextBlock Text="{Binding StepTitle}"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   Margin="0,4,0,0" />
                    </StackPanel>
                    <Button Grid.Column="1"
                            Command="{Binding CancelCommand}"
                            Classes="icon"
                            ToolTip.Tip="Close">
                        <PathIcon Data="{StaticResource CloseIcon}" Width="16" Height="16" />
                    </Button>
                </Grid>
            </Border>

            <!-- Step Indicator -->
            <controls:StepIndicator Grid.Row="0"
                                    Margin="24,0"
                                    VerticalAlignment="Bottom"
                                    Steps="4"
                                    CurrentStep="{Binding CurrentStep}" />

            <!-- Content Area -->
            <ScrollViewer Grid.Row="1"
                          Padding="24"
                          VerticalScrollBarVisibility="Auto">
                <TransitioningContentControl Content="{Binding CurrentStepContent}">
                    <TransitioningContentControl.PageTransition>
                        <CrossFade Duration="0:0:0.2" />
                    </TransitioningContentControl.PageTransition>
                </TransitioningContentControl>
            </ScrollViewer>

            <!-- Footer -->
            <Border Grid.Row="2"
                    Padding="24,16"
                    BorderThickness="0,1,0,0"
                    BorderBrush="{DynamicResource BorderColor}">
                <Grid ColumnDefinitions="Auto,*,Auto">
                    <!-- Back Button -->
                    <Button Content="Back"
                            Command="{Binding GoBackCommand}"
                            IsVisible="{Binding CanGoBack}" />

                    <!-- Progress Info -->
                    <TextBlock Grid.Column="1"
                               Text="{Binding ProgressInfo}"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center" />

                    <!-- Next/Finish Buttons -->
                    <StackPanel Grid.Column="2"
                                Orientation="Horizontal"
                                Spacing="8">
                        <Button Content="{Binding NextButtonText}"
                                Command="{Binding GoNextCommand}"
                                IsEnabled="{Binding CanGoNext}"
                                Classes="accent"
                                IsVisible="{Binding !IsLastStep}" />
                        <Button Content="Start Training"
                                Command="{Binding StartTrainingCommand}"
                                Classes="accent"
                                IsVisible="{Binding IsLastStep}">
                            <Button.Content>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <PathIcon Data="{StaticResource PlayIcon}" Width="16" Height="16" />
                                    <TextBlock Text="Start Training" />
                                </StackPanel>
                            </Button.Content>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Border>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/DatasetStepView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="650" d:DesignHeight="500"
             x:Class="SeniorIntern.Desktop.Views.WizardSteps.DatasetStepView"
             x:DataType="vm:TrainingWizardViewModel">

    <StackPanel Spacing="24">
        <!-- Dataset Source -->
        <StackPanel Spacing="8">
            <TextBlock Text="Code Source"
                       FontWeight="SemiBold"
                       FontSize="14" />
            <TextBlock Text="Select a folder containing code to train on"
                       Foreground="{DynamicResource SecondaryTextColor}"
                       FontSize="13" />

            <Grid ColumnDefinitions="*,Auto" Margin="0,8,0,0">
                <TextBox Text="{Binding DatasetPath}"
                         Watermark="~/Projects/MyApp"
                         IsReadOnly="True" />
                <Button Grid.Column="1"
                        Content="Browse..."
                        Command="{Binding BrowseDatasetCommand}"
                        Margin="8,0,0,0" />
            </Grid>
        </StackPanel>

        <!-- Analysis Progress -->
        <Border IsVisible="{Binding IsAnalyzingDataset}"
                Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="12">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <ProgressRing IsIndeterminate="True" Width="20" Height="20" />
                    <TextBlock Text="Analyzing code..." VerticalAlignment="Center" />
                </StackPanel>
                <TextBlock Text="{Binding AnalysisStatus}"
                           Foreground="{DynamicResource SecondaryTextColor}"
                           FontSize="13" />
            </StackPanel>
        </Border>

        <!-- Dataset Statistics -->
        <Border IsVisible="{Binding HasDatasetStats}"
                Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="16">
                <TextBlock Text="Dataset Statistics"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
                    <!-- Row 1 -->
                    <StackPanel Grid.Column="0" Spacing="4">
                        <TextBlock Text="{Binding DatasetStats.TotalFiles, StringFormat='{}{0:N0}'}"
                                   FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Source Files"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                    </StackPanel>
                    <StackPanel Grid.Column="1" Spacing="4">
                        <TextBlock Text="{Binding DatasetStats.TrainExamples, StringFormat='{}{0:N0}'}"
                                   FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Training Examples"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                    </StackPanel>
                    <StackPanel Grid.Column="2" Spacing="4">
                        <TextBlock Text="{Binding DatasetStats.TotalTokensFormatted}"
                                   FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Est. Tokens"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                    </StackPanel>

                    <!-- Row 2: Languages -->
                    <StackPanel Grid.Row="1" Grid.ColumnSpan="3" Margin="0,16,0,0">
                        <TextBlock Text="Languages Detected:"
                                   FontSize="12"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                        <ItemsControl Items="{Binding DatasetStats.Languages}" Margin="0,8,0,0">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Background="{DynamicResource AccentColorLight}"
                                            CornerRadius="4"
                                            Padding="8,4"
                                            Margin="0,0,8,8">
                                        <TextBlock Text="{Binding}"
                                                   FontSize="12" />
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Generation Options -->
        <StackPanel Spacing="8" IsVisible="{Binding HasDatasetStats}">
            <TextBlock Text="Example Generation"
                       FontWeight="SemiBold"
                       FontSize="14" />

            <StackPanel Spacing="8">
                <CheckBox Content="Code Completion (function/method bodies)"
                          IsChecked="{Binding GenerateCodeCompletion}" />
                <CheckBox Content="Documentation (docstrings, comments)"
                          IsChecked="{Binding GenerateDocumentation}" />
                <CheckBox Content="Refactoring (code improvements)"
                          IsChecked="{Binding GenerateRefactoring}" />
                <CheckBox Content="Bug Fixes (error patterns)"
                          IsChecked="{Binding GenerateBugFixes}" />
            </StackPanel>
        </StackPanel>

        <!-- File Patterns -->
        <Expander Header="Advanced: File Patterns" IsVisible="{Binding HasDatasetStats}">
            <StackPanel Spacing="8" Margin="0,8,0,0">
                <TextBlock Text="Include patterns (one per line):"
                           FontSize="12"
                           Foreground="{DynamicResource SecondaryTextColor}" />
                <TextBox Text="{Binding IncludePatterns}"
                         AcceptsReturn="True"
                         Height="60"
                         Watermark="**/*.cs&#x0a;**/*.ts" />

                <TextBlock Text="Exclude patterns (one per line):"
                           FontSize="12"
                           Foreground="{DynamicResource SecondaryTextColor}"
                           Margin="0,8,0,0" />
                <TextBox Text="{Binding ExcludePatterns}"
                         AcceptsReturn="True"
                         Height="60"
                         Watermark="**/bin/**&#x0a;**/node_modules/**" />
            </StackPanel>
        </Expander>
    </StackPanel>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/ConfigurationStepView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="650" d:DesignHeight="600"
             x:Class="SeniorIntern.Desktop.Views.WizardSteps.ConfigurationStepView"
             x:DataType="vm:TrainingWizardViewModel">

    <StackPanel Spacing="24">
        <!-- Adapter Name -->
        <StackPanel Spacing="8">
            <TextBlock Text="Adapter Name"
                       FontWeight="SemiBold"
                       FontSize="14" />
            <TextBox Text="{Binding AdapterName}"
                     Watermark="my-coding-style" />
            <TextBlock Text="A unique name to identify this adapter"
                       Foreground="{DynamicResource SecondaryTextColor}"
                       FontSize="12" />
        </StackPanel>

        <!-- Description -->
        <StackPanel Spacing="8">
            <TextBlock Text="Description (optional)"
                       FontWeight="SemiBold"
                       FontSize="14" />
            <TextBox Text="{Binding AdapterDescription}"
                     Watermark="Trained on my personal coding style..."
                     AcceptsReturn="True"
                     Height="60" />
        </StackPanel>

        <!-- LoRA Configuration -->
        <Border Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="16">
                <TextBlock Text="LoRA Configuration"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
                    <!-- Rank -->
                    <StackPanel Grid.Column="0" Spacing="8">
                        <TextBlock Text="Rank (r)" FontSize="13" />
                        <ComboBox SelectedItem="{Binding LoraRank}"
                                  Items="{Binding LoraRankOptions}"
                                  Width="100" />
                        <TextBlock Text="Higher = more capacity"
                                   FontSize="11"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                    </StackPanel>

                    <!-- Alpha -->
                    <StackPanel Grid.Column="1" Spacing="8">
                        <TextBlock Text="Alpha" FontSize="13" />
                        <ComboBox SelectedItem="{Binding LoraAlpha}"
                                  Items="{Binding LoraAlphaOptions}"
                                  Width="100" />
                        <TextBlock Text="Scaling factor"
                                   FontSize="11"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                    </StackPanel>

                    <!-- Dropout -->
                    <StackPanel Grid.Column="2" Spacing="8">
                        <TextBlock Text="Dropout" FontSize="13" />
                        <ComboBox SelectedItem="{Binding LoraDropout}"
                                  Items="{Binding LoraDropoutOptions}"
                                  Width="100" />
                        <TextBlock Text="Regularization"
                                   FontSize="11"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                    </StackPanel>

                    <!-- Target Modules -->
                    <StackPanel Grid.Row="1" Grid.ColumnSpan="3" Spacing="8" Margin="0,16,0,0">
                        <TextBlock Text="Target Modules" FontSize="13" />
                        <WrapPanel Orientation="Horizontal">
                            <CheckBox Content="q_proj" IsChecked="{Binding TargetQProj}" Margin="0,0,16,8" />
                            <CheckBox Content="k_proj" IsChecked="{Binding TargetKProj}" Margin="0,0,16,8" />
                            <CheckBox Content="v_proj" IsChecked="{Binding TargetVProj}" Margin="0,0,16,8" />
                            <CheckBox Content="o_proj" IsChecked="{Binding TargetOProj}" Margin="0,0,16,8" />
                            <CheckBox Content="gate_proj" IsChecked="{Binding TargetGateProj}" Margin="0,0,16,8" />
                            <CheckBox Content="up_proj" IsChecked="{Binding TargetUpProj}" Margin="0,0,16,8" />
                            <CheckBox Content="down_proj" IsChecked="{Binding TargetDownProj}" Margin="0,0,16,8" />
                        </WrapPanel>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Training Parameters -->
        <Border Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="16">
                <TextBlock Text="Training Parameters"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto,Auto">
                    <!-- Row 1 -->
                    <StackPanel Grid.Column="0" Spacing="8">
                        <TextBlock Text="Epochs" FontSize="13" />
                        <NumericUpDown Value="{Binding Epochs}"
                                       Minimum="1" Maximum="10"
                                       Width="100" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" Spacing="8">
                        <TextBlock Text="Learning Rate" FontSize="13" />
                        <ComboBox SelectedItem="{Binding LearningRate}"
                                  Items="{Binding LearningRateOptions}"
                                  Width="120" />
                    </StackPanel>

                    <StackPanel Grid.Column="2" Spacing="8">
                        <TextBlock Text="Batch Size" FontSize="13" />
                        <ComboBox SelectedItem="{Binding BatchSize}"
                                  Items="{Binding BatchSizeOptions}"
                                  Width="100" />
                    </StackPanel>

                    <!-- Row 2 -->
                    <StackPanel Grid.Row="1" Grid.Column="0" Spacing="8" Margin="0,16,0,0">
                        <TextBlock Text="Warmup Steps" FontSize="13" />
                        <NumericUpDown Value="{Binding WarmupSteps}"
                                       Minimum="0" Maximum="1000"
                                       Width="100" />
                    </StackPanel>

                    <StackPanel Grid.Row="1" Grid.Column="1" Spacing="8" Margin="0,16,0,0">
                        <TextBlock Text="Grad Accumulation" FontSize="13" />
                        <ComboBox SelectedItem="{Binding GradientAccumulationSteps}"
                                  Items="{Binding GradAccumOptions}"
                                  Width="100" />
                    </StackPanel>

                    <StackPanel Grid.Row="1" Grid.Column="2" Spacing="8" Margin="0,16,0,0">
                        <TextBlock Text="Max Seq Length" FontSize="13" />
                        <ComboBox SelectedItem="{Binding MaxSequenceLength}"
                                  Items="{Binding MaxSeqLengthOptions}"
                                  Width="100" />
                    </StackPanel>

                    <!-- Row 3: Checkboxes -->
                    <StackPanel Grid.Row="2" Grid.ColumnSpan="3" Margin="0,16,0,0" Spacing="8">
                        <CheckBox Content="Mixed Precision (FP16) - Faster training, lower memory"
                                  IsChecked="{Binding UseMixedPrecision}" />
                        <CheckBox Content="Gradient Checkpointing - Lower memory at cost of speed"
                                  IsChecked="{Binding UseGradientCheckpointing}" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Scheduler -->
        <StackPanel Spacing="8">
            <TextBlock Text="Learning Rate Scheduler"
                       FontWeight="SemiBold"
                       FontSize="14" />
            <ComboBox SelectedItem="{Binding Scheduler}"
                      Items="{Binding SchedulerOptions}"
                      Width="200" />
        </StackPanel>
    </StackPanel>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/ViewModels/TrainingWizardViewModel.cs`

```csharp
namespace SeniorIntern.Desktop.ViewModels;

using System.Collections.ObjectModel;
using CommunityToolkit.Mvvm.ComponentModel;
using CommunityToolkit.Mvvm.Input;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Training.Models;

/// <summary>
/// ViewModel for the training wizard dialog.
/// </summary>
public partial class TrainingWizardViewModel : ViewModelBase
{
    private readonly IDatasetService _datasetService;
    private readonly IHardwareDetectionService _hardwareService;
    private readonly ITrainingService _trainingService;

    #region Events

    public event EventHandler<TrainingWizardCompletedEventArgs>? WizardCompleted;
    public event EventHandler? WizardCancelled;

    #endregion

    #region Step Navigation

    [ObservableProperty]
    private int _currentStep = 1;

    [ObservableProperty]
    private object? _currentStepContent;

    public string StepTitle => CurrentStep switch
    {
        1 => "Step 1 of 4: Select Dataset",
        2 => "Step 2 of 4: Configure Training",
        3 => "Step 3 of 4: Hardware Selection",
        4 => "Step 4 of 4: Review & Start",
        _ => "Unknown Step"
    };

    public bool CanGoBack => CurrentStep > 1;
    public bool CanGoNext => ValidateCurrentStep();
    public bool IsLastStep => CurrentStep == 4;
    public string NextButtonText => CurrentStep == 3 ? "Review" : "Next";
    public string ProgressInfo => $"Step {CurrentStep} of 4";

    #endregion

    #region Step 1: Dataset

    [ObservableProperty]
    private string _datasetPath = string.Empty;

    [ObservableProperty]
    private bool _isAnalyzingDataset;

    [ObservableProperty]
    private string _analysisStatus = string.Empty;

    [ObservableProperty]
    private DatasetStatistics? _datasetStats;

    public bool HasDatasetStats => DatasetStats != null;

    [ObservableProperty]
    private bool _generateCodeCompletion = true;

    [ObservableProperty]
    private bool _generateDocumentation = true;

    [ObservableProperty]
    private bool _generateRefactoring = false;

    [ObservableProperty]
    private bool _generateBugFixes = false;

    [ObservableProperty]
    private string _includePatterns = string.Empty;

    [ObservableProperty]
    private string _excludePatterns = string.Empty;

    #endregion

    #region Step 2: Configuration

    [ObservableProperty]
    private string _adapterName = string.Empty;

    [ObservableProperty]
    private string _adapterDescription = string.Empty;

    // LoRA parameters
    [ObservableProperty]
    private int _loraRank = 16;

    [ObservableProperty]
    private float _loraAlpha = 32f;

    [ObservableProperty]
    private float _loraDropout = 0.05f;

    // Target modules
    [ObservableProperty]
    private bool _targetQProj = true;

    [ObservableProperty]
    private bool _targetKProj = true;

    [ObservableProperty]
    private bool _targetVProj = true;

    [ObservableProperty]
    private bool _targetOProj = true;

    [ObservableProperty]
    private bool _targetGateProj = true;

    [ObservableProperty]
    private bool _targetUpProj = true;

    [ObservableProperty]
    private bool _targetDownProj = true;

    // Training parameters
    [ObservableProperty]
    private int _epochs = 3;

    [ObservableProperty]
    private float _learningRate = 2e-4f;

    [ObservableProperty]
    private int _batchSize = 4;

    [ObservableProperty]
    private int _warmupSteps = 100;

    [ObservableProperty]
    private int _gradientAccumulationSteps = 4;

    [ObservableProperty]
    private int _maxSequenceLength = 2048;

    [ObservableProperty]
    private bool _useMixedPrecision = true;

    [ObservableProperty]
    private bool _useGradientCheckpointing = false;

    [ObservableProperty]
    private string _scheduler = "cosine";

    // Options for dropdowns
    public ObservableCollection<int> LoraRankOptions { get; } = new() { 4, 8, 16, 32, 64 };
    public ObservableCollection<float> LoraAlphaOptions { get; } = new() { 8, 16, 32, 64 };
    public ObservableCollection<float> LoraDropoutOptions { get; } = new() { 0, 0.05f, 0.1f, 0.15f };
    public ObservableCollection<float> LearningRateOptions { get; } = new() { 1e-5f, 5e-5f, 1e-4f, 2e-4f, 5e-4f };
    public ObservableCollection<int> BatchSizeOptions { get; } = new() { 1, 2, 4, 8, 16 };
    public ObservableCollection<int> GradAccumOptions { get; } = new() { 1, 2, 4, 8, 16 };
    public ObservableCollection<int> MaxSeqLengthOptions { get; } = new() { 512, 1024, 2048, 4096 };
    public ObservableCollection<string> SchedulerOptions { get; } = new() { "cosine", "linear", "constant", "polynomial" };

    #endregion

    #region Step 3: Hardware

    [ObservableProperty]
    private TrainingHardwareInfo? _hardwareInfo;

    [ObservableProperty]
    private string _selectedDevice = "auto";

    [ObservableProperty]
    private bool _isDetectingHardware;

    [ObservableProperty]
    private long _estimatedVramUsage;

    [ObservableProperty]
    private TimeSpan _estimatedTrainingTime;

    [ObservableProperty]
    private ObservableCollection<string> _hardwareWarnings = new();

    [ObservableProperty]
    private ObservableCollection<string> _hardwareRecommendations = new();

    public ObservableCollection<DeviceOption> DeviceOptions { get; } = new();

    #endregion

    #region Step 4: Review

    public string ReviewSummary => GenerateReviewSummary();

    #endregion

    public TrainingWizardViewModel(
        IDatasetService datasetService,
        IHardwareDetectionService hardwareService,
        ITrainingService trainingService)
    {
        _datasetService = datasetService;
        _hardwareService = hardwareService;
        _trainingService = trainingService;

        UpdateStepContent();
    }

    #region Commands

    [RelayCommand]
    private async Task BrowseDatasetAsync()
    {
        var dialog = new OpenFolderDialog
        {
            Title = "Select Code Folder for Training"
        };

        var result = await dialog.ShowAsync(GetMainWindow());
        if (!string.IsNullOrEmpty(result))
        {
            DatasetPath = result;
            await AnalyzeDatasetAsync();
        }
    }

    [RelayCommand]
    private async Task AnalyzeDatasetAsync()
    {
        if (string.IsNullOrEmpty(DatasetPath)) return;

        IsAnalyzingDataset = true;
        AnalysisStatus = "Scanning files...";

        try
        {
            var options = new DatasetCreationOptions
            {
                GenerationType = GetGenerationType(),
                IncludePatterns = ParsePatterns(IncludePatterns),
                ExcludePatterns = ParsePatterns(ExcludePatterns)
            };

            AnalysisStatus = "Analyzing code structure...";
            var dataset = await _datasetService.CreateDatasetFromCodeAsync(DatasetPath, options);

            AnalysisStatus = "Calculating statistics...";
            DatasetStats = _datasetService.GetStatistics(dataset);

            OnPropertyChanged(nameof(HasDatasetStats));
        }
        catch (Exception ex)
        {
            AnalysisStatus = $"Error: {ex.Message}";
        }
        finally
        {
            IsAnalyzingDataset = false;
        }
    }

    [RelayCommand]
    private async Task DetectHardwareAsync()
    {
        IsDetectingHardware = true;
        HardwareWarnings.Clear();
        HardwareRecommendations.Clear();

        try
        {
            HardwareInfo = await _hardwareService.DetectHardwareAsync();

            // Populate device options
            DeviceOptions.Clear();
            DeviceOptions.Add(new DeviceOption { Id = "auto", Name = "Auto (Recommended)" });

            if (HardwareInfo.HasCuda)
            {
                for (int i = 0; i < HardwareInfo.CudaDeviceCount; i++)
                {
                    DeviceOptions.Add(new DeviceOption
                    {
                        Id = $"cuda:{i}",
                        Name = $"CUDA: {HardwareInfo.CudaDevices[i].Name}"
                    });
                }
            }

            if (HardwareInfo.HasMetal)
            {
                DeviceOptions.Add(new DeviceOption
                {
                    Id = "mps",
                    Name = $"Metal: {HardwareInfo.MetalDevice?.Name ?? "Apple Silicon"}"
                });
            }

            DeviceOptions.Add(new DeviceOption { Id = "cpu", Name = "CPU Only" });

            // Update estimates and recommendations
            UpdateEstimates();
            GenerateRecommendations();
        }
        finally
        {
            IsDetectingHardware = false;
        }
    }

    [RelayCommand]
    private void GoBack()
    {
        if (CurrentStep > 1)
        {
            CurrentStep--;
            UpdateStepContent();
        }
    }

    [RelayCommand]
    private async Task GoNextAsync()
    {
        if (!ValidateCurrentStep()) return;

        if (CurrentStep == 2)
        {
            // Auto-detect hardware when moving to step 3
            await DetectHardwareAsync();
        }

        if (CurrentStep < 4)
        {
            CurrentStep++;
            UpdateStepContent();
        }
    }

    [RelayCommand]
    private void StartTraining()
    {
        var job = CreateTrainingJob();

        WizardCompleted?.Invoke(this, new TrainingWizardCompletedEventArgs
        {
            StartTraining = true,
            Job = job
        });
    }

    [RelayCommand]
    private void Cancel()
    {
        WizardCancelled?.Invoke(this, EventArgs.Empty);
    }

    #endregion

    #region Helper Methods

    private void UpdateStepContent()
    {
        CurrentStepContent = CurrentStep switch
        {
            1 => new DatasetStepView { DataContext = this },
            2 => new ConfigurationStepView { DataContext = this },
            3 => new HardwareStepView { DataContext = this },
            4 => new ReviewStepView { DataContext = this },
            _ => null
        };

        OnPropertyChanged(nameof(StepTitle));
        OnPropertyChanged(nameof(CanGoBack));
        OnPropertyChanged(nameof(CanGoNext));
        OnPropertyChanged(nameof(IsLastStep));
        OnPropertyChanged(nameof(NextButtonText));
        OnPropertyChanged(nameof(ProgressInfo));
    }

    private bool ValidateCurrentStep()
    {
        return CurrentStep switch
        {
            1 => !string.IsNullOrEmpty(DatasetPath) && DatasetStats != null,
            2 => !string.IsNullOrEmpty(AdapterName) && GetTargetModules().Count > 0,
            3 => HardwareInfo != null,
            4 => true,
            _ => false
        };
    }

    private ExampleGenerationType GetGenerationType()
    {
        var type = ExampleGenerationType.None;

        if (GenerateCodeCompletion) type |= ExampleGenerationType.CodeCompletion;
        if (GenerateDocumentation) type |= ExampleGenerationType.Documentation;
        if (GenerateRefactoring) type |= ExampleGenerationType.Refactoring;
        if (GenerateBugFixes) type |= ExampleGenerationType.BugFix;

        return type == ExampleGenerationType.None ? ExampleGenerationType.All : type;
    }

    private List<string> GetTargetModules()
    {
        var modules = new List<string>();

        if (TargetQProj) modules.Add("q_proj");
        if (TargetKProj) modules.Add("k_proj");
        if (TargetVProj) modules.Add("v_proj");
        if (TargetOProj) modules.Add("o_proj");
        if (TargetGateProj) modules.Add("gate_proj");
        if (TargetUpProj) modules.Add("up_proj");
        if (TargetDownProj) modules.Add("down_proj");

        return modules;
    }

    private static List<string> ParsePatterns(string patterns)
    {
        if (string.IsNullOrWhiteSpace(patterns))
            return new List<string>();

        return patterns.Split('\n', StringSplitOptions.RemoveEmptyEntries)
            .Select(p => p.Trim())
            .Where(p => !string.IsNullOrEmpty(p))
            .ToList();
    }

    private void UpdateEstimates()
    {
        if (HardwareInfo == null || DatasetStats == null) return;

        // Estimate VRAM usage
        var modelParams = 7_000_000_000L; // Assume 7B model
        var bytesPerParam = UseMixedPrecision ? 2 : 4;
        var baseVram = modelParams * bytesPerParam;

        var loraParams = LoraRank * GetTargetModules().Count * 4096 * 2; // Simplified
        var loraVram = loraParams * bytesPerParam;

        var batchVram = BatchSize * MaxSequenceLength * 4096 * bytesPerParam;

        EstimatedVramUsage = baseVram + loraVram + batchVram;

        // Estimate training time
        var stepsPerEpoch = DatasetStats.TrainExamples / (BatchSize * GradientAccumulationSteps);
        var totalSteps = stepsPerEpoch * Epochs;
        var secondsPerStep = HardwareInfo.HasCuda ? 1.5 : (HardwareInfo.HasMetal ? 2.0 : 10.0);

        EstimatedTrainingTime = TimeSpan.FromSeconds(totalSteps * secondsPerStep);
    }

    private void GenerateRecommendations()
    {
        if (HardwareInfo == null) return;

        // Memory warnings
        var availableVram = HardwareInfo.AvailableVram;
        if (EstimatedVramUsage > availableVram * 0.9)
        {
            HardwareWarnings.Add("Estimated VRAM usage is close to or exceeds available memory.");

            if (!UseGradientCheckpointing)
            {
                HardwareRecommendations.Add("Enable gradient checkpointing to reduce memory usage.");
            }

            if (BatchSize > 2)
            {
                HardwareRecommendations.Add($"Consider reducing batch size from {BatchSize} to {BatchSize / 2}.");
            }
        }

        // CPU-only warning
        if (!HardwareInfo.HasCuda && !HardwareInfo.HasMetal)
        {
            HardwareWarnings.Add("No GPU detected. Training on CPU will be significantly slower.");
        }

        // Good practices
        if (LoraRank > 32)
        {
            HardwareRecommendations.Add("High LoRA rank may lead to overfitting. Consider starting with 16 or 32.");
        }

        if (Epochs > 5)
        {
            HardwareRecommendations.Add("Many epochs may lead to overfitting. Monitor validation loss carefully.");
        }
    }

    private string GenerateReviewSummary()
    {
        var sb = new System.Text.StringBuilder();

        sb.AppendLine($"**Adapter Name:** {AdapterName}");
        sb.AppendLine();
        sb.AppendLine($"**Dataset:** {Path.GetFileName(DatasetPath)}");
        sb.AppendLine($"- {DatasetStats?.TrainExamples:N0} training examples");
        sb.AppendLine($"- ~{DatasetStats?.TotalTokensFormatted} tokens");
        sb.AppendLine();
        sb.AppendLine("**LoRA Configuration:**");
        sb.AppendLine($"- Rank: {LoraRank}, Alpha: {LoraAlpha}, Dropout: {LoraDropout}");
        sb.AppendLine($"- Target modules: {string.Join(", ", GetTargetModules())}");
        sb.AppendLine();
        sb.AppendLine("**Training:**");
        sb.AppendLine($"- Epochs: {Epochs}, LR: {LearningRate}, Batch: {BatchSize}");
        sb.AppendLine($"- Scheduler: {Scheduler}");
        sb.AppendLine();
        sb.AppendLine("**Hardware:**");
        sb.AppendLine($"- Device: {SelectedDevice}");
        sb.AppendLine($"- Est. VRAM: {EstimatedVramUsage / (1024 * 1024 * 1024):F1} GB");
        sb.AppendLine($"- Est. Time: {EstimatedTrainingTime:hh\\:mm}");

        return sb.ToString();
    }

    private TrainingJob CreateTrainingJob()
    {
        return new TrainingJob
        {
            Id = Guid.NewGuid().ToString(),
            Name = AdapterName,
            Description = AdapterDescription,
            DatasetPath = DatasetPath,
            OutputDir = GetAdaptersDirectory(),
            Configuration = new TrainingConfiguration
            {
                Device = SelectedDevice == "auto"
                    ? HardwareInfo?.RecommendedDevice ?? "cpu"
                    : SelectedDevice,
                LoraRank = LoraRank,
                LoraAlpha = LoraAlpha,
                LoraDropout = LoraDropout,
                TargetModules = GetTargetModules(),
                Epochs = Epochs,
                LearningRate = LearningRate,
                BatchSize = BatchSize,
                WarmupSteps = WarmupSteps,
                GradientAccumulationSteps = GradientAccumulationSteps,
                MaxSequenceLength = MaxSequenceLength,
                UseMixedPrecision = UseMixedPrecision,
                UseGradientCheckpointing = UseGradientCheckpointing,
                Scheduler = Scheduler
            }
        };
    }

    private static string GetAdaptersDirectory()
    {
        return Path.Combine(
            Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
            "SeniorIntern", "adapters");
    }

    private static Window GetMainWindow()
    {
        return Application.Current?.ApplicationLifetime is IClassicDesktopStyleApplicationLifetime desktop
            ? desktop.MainWindow!
            : throw new InvalidOperationException("No main window");
    }

    #endregion
}

/// <summary>
/// Event args for wizard completion.
/// </summary>
public sealed class TrainingWizardCompletedEventArgs : EventArgs
{
    public bool StartTraining { get; init; }
    public TrainingJob? Job { get; init; }
}

/// <summary>
/// Device option for selection.
/// </summary>
public sealed class DeviceOption
{
    public string Id { get; init; } = string.Empty;
    public string Name { get; init; } = string.Empty;
}
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/DatasetStepView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views.WizardSteps;

using Avalonia.Controls;

public partial class DatasetStepView : UserControl
{
    public DatasetStepView()
    {
        InitializeComponent();
    }
}
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/ConfigurationStepView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views.WizardSteps;

using Avalonia.Controls;

public partial class ConfigurationStepView : UserControl
{
    public ConfigurationStepView()
    {
        InitializeComponent();
    }
}
```

---

## v0.8.5c: Training Wizard - Steps 3 & 4

### Objective
Create the hardware selection (Step 3) and review (Step 4) steps of the training wizard.

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/HardwareStepView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="650" d:DesignHeight="500"
             x:Class="SeniorIntern.Desktop.Views.WizardSteps.HardwareStepView"
             x:DataType="vm:TrainingWizardViewModel">

    <StackPanel Spacing="24">
        <!-- Detection Progress -->
        <Border IsVisible="{Binding IsDetectingHardware}"
                Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <ProgressRing IsIndeterminate="True" Width="20" Height="20" />
                <TextBlock Text="Detecting hardware..." VerticalAlignment="Center" />
            </StackPanel>
        </Border>

        <!-- Hardware Info -->
        <Border IsVisible="{Binding HardwareInfo, Converter={x:Static ObjectConverters.IsNotNull}}"
                Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="16">
                <TextBlock Text="Detected Hardware"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <!-- GPU Info -->
                <Grid ColumnDefinitions="Auto,*" RowDefinitions="Auto,Auto,Auto" IsVisible="{Binding HardwareInfo.HasGpu}">
                    <PathIcon Grid.Column="0" Grid.Row="0"
                              Data="{StaticResource GpuIcon}"
                              Width="24" Height="24"
                              Margin="0,0,12,0"
                              Foreground="{DynamicResource AccentColor}" />
                    <StackPanel Grid.Column="1" Grid.Row="0">
                        <TextBlock Text="{Binding HardwareInfo.GpuName}"
                                   FontWeight="SemiBold" />
                        <TextBlock Text="{Binding HardwareInfo.VramFormatted, StringFormat='VRAM: {0}'}"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="13" />
                    </StackPanel>
                </Grid>

                <!-- CPU Info -->
                <Grid ColumnDefinitions="Auto,*" Margin="0,8,0,0">
                    <PathIcon Grid.Column="0"
                              Data="{StaticResource CpuIcon}"
                              Width="24" Height="24"
                              Margin="0,0,12,0"
                              Foreground="{DynamicResource SecondaryTextColor}" />
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="{Binding HardwareInfo.CpuName}" />
                        <TextBlock Text="{Binding HardwareInfo.CpuCores, StringFormat='{}{0} cores'}"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="13" />
                    </StackPanel>
                </Grid>

                <!-- RAM Info -->
                <Grid ColumnDefinitions="Auto,*" Margin="0,8,0,0">
                    <PathIcon Grid.Column="0"
                              Data="{StaticResource MemoryIcon}"
                              Width="24" Height="24"
                              Margin="0,0,12,0"
                              Foreground="{DynamicResource SecondaryTextColor}" />
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="{Binding HardwareInfo.RamFormatted, StringFormat='System RAM: {0}'}" />
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

        <!-- Device Selection -->
        <StackPanel Spacing="8" IsVisible="{Binding HardwareInfo, Converter={x:Static ObjectConverters.IsNotNull}}">
            <TextBlock Text="Compute Device"
                       FontWeight="SemiBold"
                       FontSize="14" />
            <ComboBox SelectedItem="{Binding SelectedDevice}"
                      Items="{Binding DeviceOptions}"
                      DisplayMemberBinding="{Binding Name}"
                      SelectedValueBinding="{Binding Id}"
                      Width="300" />
        </StackPanel>

        <!-- Estimates -->
        <Border IsVisible="{Binding HardwareInfo, Converter={x:Static ObjectConverters.IsNotNull}}"
                Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="16">
                <TextBlock Text="Training Estimates"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <Grid ColumnDefinitions="*,*">
                    <StackPanel Grid.Column="0" Spacing="4">
                        <TextBlock Text="{Binding EstimatedVramUsage, Converter={StaticResource BytesToGbConverter}, StringFormat='{}{0:F1} GB'}"
                                   FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Est. VRAM Usage"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                    </StackPanel>

                    <StackPanel Grid.Column="1" Spacing="4">
                        <TextBlock Text="{Binding EstimatedTrainingTime, StringFormat='{}{0:hh\\:mm}'}"
                                   FontSize="24" FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Est. Training Time"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   FontSize="12" />
                    </StackPanel>
                </Grid>

                <!-- VRAM Progress Bar -->
                <StackPanel Spacing="4">
                    <Grid ColumnDefinitions="*,Auto">
                        <TextBlock Text="VRAM Usage"
                                   FontSize="12"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                        <TextBlock Grid.Column="1"
                                   Text="{Binding VramUsagePercent, StringFormat='{}{0:F0}%'}"
                                   FontSize="12"
                                   Foreground="{DynamicResource SecondaryTextColor}" />
                    </Grid>
                    <ProgressBar Value="{Binding VramUsagePercent}"
                                 Maximum="100"
                                 Height="8"
                                 CornerRadius="4" />
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Warnings -->
        <Border IsVisible="{Binding HardwareWarnings.Count}"
                Background="{DynamicResource WarningBackgroundColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <PathIcon Data="{StaticResource WarningIcon}"
                              Width="20" Height="20"
                              Foreground="{DynamicResource WarningColor}" />
                    <TextBlock Text="Warnings"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource WarningColor}" />
                </StackPanel>
                <ItemsControl Items="{Binding HardwareWarnings}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}"
                                       Margin="28,4,0,0"
                                       TextWrapping="Wrap" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>

        <!-- Recommendations -->
        <Border IsVisible="{Binding HardwareRecommendations.Count}"
                Background="{DynamicResource InfoBackgroundColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="8">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <PathIcon Data="{StaticResource InfoIcon}"
                              Width="20" Height="20"
                              Foreground="{DynamicResource InfoColor}" />
                    <TextBlock Text="Recommendations"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource InfoColor}" />
                </StackPanel>
                <ItemsControl Items="{Binding HardwareRecommendations}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding}"
                                       Margin="28,4,0,0"
                                       TextWrapping="Wrap" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/ReviewStepView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:md="using:Markdown.Avalonia"
             mc:Ignorable="d" d:DesignWidth="650" d:DesignHeight="500"
             x:Class="SeniorIntern.Desktop.Views.WizardSteps.ReviewStepView"
             x:DataType="vm:TrainingWizardViewModel">

    <StackPanel Spacing="24">
        <!-- Summary Header -->
        <StackPanel Spacing="8">
            <TextBlock Text="Review Configuration"
                       FontWeight="SemiBold"
                       FontSize="18" />
            <TextBlock Text="Please review your training configuration before starting."
                       Foreground="{DynamicResource SecondaryTextColor}" />
        </StackPanel>

        <!-- Configuration Summary Cards -->
        <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto">
            <!-- Dataset Card -->
            <Border Grid.Column="0" Grid.Row="0"
                    Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,0,8,8">
                <StackPanel Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource FolderIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Dataset" FontWeight="SemiBold" />
                    </StackPanel>
                    <TextBlock Text="{Binding DatasetPath, Converter={StaticResource PathToFileNameConverter}}"
                               FontSize="13" />
                    <TextBlock Text="{Binding DatasetStats.TrainExamples, StringFormat='{}{0:N0} examples'}"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12" />
                </StackPanel>
            </Border>

            <!-- LoRA Card -->
            <Border Grid.Column="1" Grid.Row="0"
                    Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="8,0,0,8">
                <StackPanel Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource TuneIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="LoRA Config" FontWeight="SemiBold" />
                    </StackPanel>
                    <TextBlock Text="{Binding LoraRank, StringFormat='Rank: {0}'}"
                               FontSize="13" />
                    <TextBlock Text="{Binding TargetModulesCount, StringFormat='{}{0} target modules'}"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12" />
                </StackPanel>
            </Border>

            <!-- Training Card -->
            <Border Grid.Column="0" Grid.Row="1"
                    Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,8,8,0">
                <StackPanel Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource TrainingIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Training" FontWeight="SemiBold" />
                    </StackPanel>
                    <TextBlock Text="{Binding Epochs, StringFormat='{}{0} epochs'}"
                               FontSize="13" />
                    <TextBlock Text="{Binding LearningRate, StringFormat='LR: {0}'}"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12" />
                </StackPanel>
            </Border>

            <!-- Hardware Card -->
            <Border Grid.Column="1" Grid.Row="1"
                    Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="8,8,0,0">
                <StackPanel Spacing="8">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource GpuIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource AccentColor}" />
                        <TextBlock Text="Hardware" FontWeight="SemiBold" />
                    </StackPanel>
                    <TextBlock Text="{Binding SelectedDeviceName}"
                               FontSize="13" />
                    <TextBlock Text="{Binding EstimatedTrainingTime, StringFormat='~{0:hh\\:mm}'}"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12" />
                </StackPanel>
            </Border>
        </Grid>

        <!-- Detailed Summary -->
        <Expander Header="Full Configuration Details">
            <Border Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    Margin="0,8,0,0">
                <md:MarkdownScrollViewer Markdown="{Binding ReviewSummary}" />
            </Border>
        </Expander>

        <!-- Pre-flight Checks -->
        <Border Background="{DynamicResource SurfaceColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Spacing="12">
                <TextBlock Text="Pre-flight Checks"
                           FontWeight="SemiBold"
                           FontSize="14" />

                <StackPanel Spacing="8">
                    <!-- Check 1: Dataset -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource CheckCircleIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource SuccessColor}" />
                        <TextBlock Text="Dataset analyzed and ready" />
                    </StackPanel>

                    <!-- Check 2: Hardware -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{Binding HardwareCheckIcon}"
                                  Width="16" Height="16"
                                  Foreground="{Binding HardwareCheckColor}" />
                        <TextBlock Text="{Binding HardwareCheckMessage}" />
                    </StackPanel>

                    <!-- Check 3: Memory -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{Binding MemoryCheckIcon}"
                                  Width="16" Height="16"
                                  Foreground="{Binding MemoryCheckColor}" />
                        <TextBlock Text="{Binding MemoryCheckMessage}" />
                    </StackPanel>

                    <!-- Check 4: Disk Space -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource CheckCircleIcon}"
                                  Width="16" Height="16"
                                  Foreground="{DynamicResource SuccessColor}" />
                        <TextBlock Text="Sufficient disk space available" />
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Final Info -->
        <Border Background="{DynamicResource InfoBackgroundColor}"
                CornerRadius="8"
                Padding="16">
            <StackPanel Orientation="Horizontal" Spacing="12">
                <PathIcon Data="{StaticResource InfoIcon}"
                          Width="20" Height="20"
                          Foreground="{DynamicResource InfoColor}" />
                <TextBlock TextWrapping="Wrap">
                    <Run Text="Training will create checkpoints periodically. You can pause or stop training at any time." />
                    <LineBreak />
                    <Run Text="The adapter will be saved to your adapters folder when complete."
                         Foreground="{DynamicResource SecondaryTextColor}" />
                </TextBlock>
            </StackPanel>
        </Border>
    </StackPanel>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/HardwareStepView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views.WizardSteps;

using Avalonia.Controls;

public partial class HardwareStepView : UserControl
{
    public HardwareStepView()
    {
        InitializeComponent();
    }
}
```

### File: `src/SeniorIntern.Desktop/Views/WizardSteps/ReviewStepView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views.WizardSteps;

using Avalonia.Controls;

public partial class ReviewStepView : UserControl
{
    public ReviewStepView()
    {
        InitializeComponent();
    }
}
```

---

## v0.8.5d: Training Progress View

### Objective
Create the training progress view with real-time metrics display, progress bar, and controls.

### File: `src/SeniorIntern.Desktop/Views/TrainingProgressView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             xmlns:controls="using:SeniorIntern.Desktop.Controls"
             mc:Ignorable="d" d:DesignWidth="1000" d:DesignHeight="700"
             x:Class="SeniorIntern.Desktop.Views.TrainingProgressView"
             x:DataType="vm:TrainingLabViewModel">

    <Grid RowDefinitions="Auto,Auto,*,Auto">
        <!-- Header -->
        <Border Grid.Row="0"
                Background="{DynamicResource SurfaceColor}"
                Padding="24,16">
            <Grid ColumnDefinitions="*,Auto">
                <StackPanel>
                    <TextBlock Text="{Binding CurrentJob.Name, StringFormat='Training: {0}'}"
                               FontSize="18"
                               FontWeight="SemiBold" />
                    <TextBlock Foreground="{DynamicResource SecondaryTextColor}">
                        <Run Text="Epoch" />
                        <Run Text="{Binding CurrentProgress.CurrentEpoch}" />
                        <Run Text="/" />
                        <Run Text="{Binding CurrentProgress.TotalEpochs}" />
                        <Run Text="  |  Step" />
                        <Run Text="{Binding CurrentProgress.CurrentStep, StringFormat='{}{0:N0}'}" />
                        <Run Text="/" />
                        <Run Text="{Binding CurrentProgress.TotalSteps, StringFormat='{}{0:N0}'}" />
                    </TextBlock>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Command="{Binding PauseTrainingCommand}"
                            IsVisible="{Binding !CurrentProgress.IsPaused}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource PauseIcon}" Width="16" Height="16" />
                            <TextBlock Text="Pause" />
                        </StackPanel>
                    </Button>
                    <Button Command="{Binding ResumeTrainingCommand}"
                            IsVisible="{Binding CurrentProgress.IsPaused}"
                            Classes="accent">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource PlayIcon}" Width="16" Height="16" />
                            <TextBlock Text="Resume" />
                        </StackPanel>
                    </Button>
                    <Button Command="{Binding StopTrainingCommand}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <PathIcon Data="{StaticResource StopIcon}" Width="16" Height="16" />
                            <TextBlock Text="Stop" />
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Progress Bar -->
        <Border Grid.Row="1" Padding="24,16">
            <StackPanel Spacing="8">
                <Grid ColumnDefinitions="*,Auto">
                    <StackPanel Orientation="Horizontal" Spacing="16">
                        <TextBlock Text="{Binding CurrentProgress.ProgressPercent, StringFormat='{}{0:F1}%'}"
                                   FontSize="24"
                                   FontWeight="SemiBold"
                                   Foreground="{DynamicResource AccentColor}" />
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="{Binding CurrentProgress.ElapsedTime, StringFormat='Elapsed: {0:hh\\:mm\\:ss}'}"
                                       FontSize="13" />
                            <TextBlock Text="{Binding CurrentProgress.EstimatedRemaining, StringFormat='Remaining: ~{0:hh\\:mm}'}"
                                       Foreground="{DynamicResource SecondaryTextColor}"
                                       FontSize="13" />
                        </StackPanel>
                    </StackPanel>
                    <TextBlock Grid.Column="1"
                               Text="{Binding CurrentProgress.SamplesPerSecond, StringFormat='{}{0:F1} samples/sec'}"
                               VerticalAlignment="Center"
                               Foreground="{DynamicResource SecondaryTextColor}" />
                </Grid>

                <ProgressBar Value="{Binding CurrentProgress.ProgressPercent}"
                             Maximum="100"
                             Height="12"
                             CornerRadius="6" />
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <Grid Grid.Row="2" ColumnDefinitions="*,350" Margin="24,0">
            <!-- Charts -->
            <Grid Grid.Column="0" RowDefinitions="*,*" Margin="0,0,16,0">
                <!-- Loss Chart -->
                <Border Grid.Row="0"
                        Background="{DynamicResource SurfaceColor}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,0,0,8">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Text="Training Loss"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,8" />
                        <controls:MetricsChart Grid.Row="1"
                                               Data="{Binding MetricsHistory}"
                                               ValuePath="Loss"
                                               LineColor="{DynamicResource AccentColor}"
                                               YAxisLabel="Loss" />
                    </Grid>
                </Border>

                <!-- Learning Rate Chart -->
                <Border Grid.Row="1"
                        Background="{DynamicResource SurfaceColor}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,8,0,0">
                    <Grid RowDefinitions="Auto,*">
                        <TextBlock Text="Learning Rate"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,8" />
                        <controls:MetricsChart Grid.Row="1"
                                               Data="{Binding MetricsHistory}"
                                               ValuePath="LearningRate"
                                               LineColor="{DynamicResource SecondaryColor}"
                                               YAxisLabel="LR" />
                    </Grid>
                </Border>
            </Grid>

            <!-- Hardware & Logs Panel -->
            <Grid Grid.Column="1" RowDefinitions="Auto,*">
                <!-- Hardware Gauges -->
                <Border Grid.Row="0"
                        Background="{DynamicResource SurfaceColor}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,0,0,8">
                    <StackPanel Spacing="16">
                        <TextBlock Text="Hardware Utilization"
                                   FontWeight="SemiBold" />

                        <!-- GPU Memory -->
                        <controls:HardwareGauge Title="GPU Memory"
                                                Current="{Binding CurrentHardwareMetrics.GpuMemoryUsed}"
                                                Total="{Binding CurrentHardwareMetrics.GpuMemoryTotal}"
                                                Unit="GB"
                                                GaugeColor="{DynamicResource AccentColor}" />

                        <!-- GPU Utilization -->
                        <controls:HardwareGauge Title="GPU Utilization"
                                                Percent="{Binding CurrentHardwareMetrics.GpuUtilization}"
                                                GaugeColor="{DynamicResource AccentColor}" />

                        <!-- GPU Temperature -->
                        <controls:HardwareGauge Title="GPU Temperature"
                                                Value="{Binding CurrentHardwareMetrics.GpuTemperature}"
                                                MaxValue="100"
                                                Unit="°C"
                                                GaugeColor="{Binding GpuTempColor}" />

                        <!-- CPU Usage -->
                        <controls:HardwareGauge Title="CPU Usage"
                                                Percent="{Binding CurrentHardwareMetrics.CpuUtilization}"
                                                GaugeColor="{DynamicResource SecondaryColor}" />

                        <!-- System RAM -->
                        <controls:HardwareGauge Title="System RAM"
                                                Current="{Binding CurrentHardwareMetrics.RamUsed}"
                                                Total="{Binding CurrentHardwareMetrics.RamTotal}"
                                                Unit="GB"
                                                GaugeColor="{DynamicResource SecondaryColor}" />
                    </StackPanel>
                </Border>

                <!-- Training Log -->
                <Border Grid.Row="1"
                        Background="{DynamicResource SurfaceColor}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,8,0,0">
                    <Grid RowDefinitions="Auto,*">
                        <Grid ColumnDefinitions="*,Auto" Margin="0,0,0,8">
                            <TextBlock Text="Training Log"
                                       FontWeight="SemiBold" />
                            <Button Grid.Column="1"
                                    Content="Clear"
                                    Command="{Binding ClearLogCommand}"
                                    Classes="small" />
                        </Grid>
                        <controls:LogViewer Grid.Row="1"
                                            LogEntries="{Binding TrainingLog}"
                                            AutoScroll="True" />
                    </Grid>
                </Border>
            </Grid>
        </Grid>

        <!-- Current Metrics Footer -->
        <Border Grid.Row="3"
                Background="{DynamicResource SurfaceColor}"
                Padding="24,12"
                BorderThickness="0,1,0,0"
                BorderBrush="{DynamicResource BorderColor}">
            <Grid ColumnDefinitions="*,*,*,*,*">
                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding CurrentProgress.CurrentMetrics.Loss, StringFormat='{}{0:F4}'}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Loss"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding CurrentProgress.CurrentMetrics.LearningRate, StringFormat='{}{0:E2}'}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Learning Rate"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding CurrentProgress.CurrentMetrics.GradientNorm, StringFormat='{}{0:F2}'}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Grad Norm"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding CurrentProgress.TokensProcessed, StringFormat='{}{0:N0}'}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Tokens"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12"
                               HorizontalAlignment="Center" />
                </StackPanel>

                <StackPanel HorizontalAlignment="Center">
                    <TextBlock Text="{Binding LastCheckpointTime, StringFormat='{}{0:HH:mm}'}"
                               FontSize="18"
                               FontWeight="SemiBold"
                               HorizontalAlignment="Center" />
                    <TextBlock Text="Last Checkpoint"
                               Foreground="{DynamicResource SecondaryTextColor}"
                               FontSize="12"
                               HorizontalAlignment="Center" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/TrainingProgressView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;

public partial class TrainingProgressView : UserControl
{
    public TrainingProgressView()
    {
        InitializeComponent();
    }
}
```

### File: `src/SeniorIntern.Desktop/ViewModels/TrainingProgressViewModel.cs`

```csharp
namespace SeniorIntern.Desktop.ViewModels;

using System.Collections.ObjectModel;
using CommunityToolkit.Mvvm.ComponentModel;
using SeniorIntern.Core.Training.Models;

/// <summary>
/// ViewModel for training progress display.
/// </summary>
public partial class TrainingProgressViewModel : ViewModelBase
{
    [ObservableProperty]
    private TrainingProgress? _currentProgress;

    [ObservableProperty]
    private HardwareMetrics? _currentHardwareMetrics;

    [ObservableProperty]
    private ObservableCollection<TrainingMetrics> _metricsHistory = new();

    [ObservableProperty]
    private ObservableCollection<LogEntry> _trainingLog = new();

    [ObservableProperty]
    private DateTime? _lastCheckpointTime;

    public IBrush GpuTempColor
    {
        get
        {
            var temp = CurrentHardwareMetrics?.GpuTemperature ?? 0;
            return temp switch
            {
                > 90 => Brushes.Red,
                > 80 => Brushes.Orange,
                > 70 => Brushes.Yellow,
                _ => Application.Current!.FindResource("AccentColor") as IBrush ?? Brushes.Green
            };
        }
    }

    public void AddLogEntry(string message, LogLevel level = LogLevel.Info)
    {
        var entry = new LogEntry
        {
            Timestamp = DateTime.Now,
            Message = message,
            Level = level
        };

        Dispatcher.UIThread.InvokeAsync(() =>
        {
            TrainingLog.Add(entry);

            // Keep last 1000 entries
            while (TrainingLog.Count > 1000)
                TrainingLog.RemoveAt(0);
        });
    }
}

/// <summary>
/// Log entry for training log viewer.
/// </summary>
public sealed class LogEntry
{
    public DateTime Timestamp { get; init; }
    public string Message { get; init; } = string.Empty;
    public LogLevel Level { get; init; }

    public string FormattedTime => Timestamp.ToString("HH:mm:ss");
}

/// <summary>
/// Log entry severity level.
/// </summary>
public enum LogLevel
{
    Debug,
    Info,
    Warning,
    Error
}
```

### File: `src/SeniorIntern.Core/Training/Models/TrainingProgress.cs` (Update)

```csharp
namespace SeniorIntern.Core.Training.Models;

/// <summary>
/// Real-time training progress information.
/// </summary>
public sealed class TrainingProgress
{
    /// <summary>
    /// Current epoch (1-based).
    /// </summary>
    public int CurrentEpoch { get; init; }

    /// <summary>
    /// Total number of epochs.
    /// </summary>
    public int TotalEpochs { get; init; }

    /// <summary>
    /// Current step within all epochs.
    /// </summary>
    public int CurrentStep { get; init; }

    /// <summary>
    /// Total steps across all epochs.
    /// </summary>
    public int TotalSteps { get; init; }

    /// <summary>
    /// Progress percentage (0-100).
    /// </summary>
    public float ProgressPercent => TotalSteps > 0
        ? (float)CurrentStep / TotalSteps * 100f
        : 0f;

    /// <summary>
    /// Elapsed training time.
    /// </summary>
    public TimeSpan ElapsedTime { get; init; }

    /// <summary>
    /// Estimated remaining time.
    /// </summary>
    public TimeSpan EstimatedRemaining { get; init; }

    /// <summary>
    /// Training samples processed per second.
    /// </summary>
    public float SamplesPerSecond { get; init; }

    /// <summary>
    /// Total tokens processed.
    /// </summary>
    public long TokensProcessed { get; init; }

    /// <summary>
    /// Whether training is currently paused.
    /// </summary>
    public bool IsPaused { get; init; }

    /// <summary>
    /// Current training metrics.
    /// </summary>
    public TrainingMetrics? CurrentMetrics { get; init; }

    /// <summary>
    /// Current training state.
    /// </summary>
    public TrainingState State { get; init; }

    /// <summary>
    /// Status message.
    /// </summary>
    public string StatusMessage { get; init; } = string.Empty;
}

/// <summary>
/// Training state enumeration.
/// </summary>
public enum TrainingState
{
    Idle,
    Initializing,
    Training,
    Paused,
    Checkpointing,
    Evaluating,
    Completed,
    Failed,
    Cancelled
}
```

---

## v0.8.5e: MetricsChart Control (LiveCharts)

### Objective
Create a custom chart control using LiveCharts for real-time training metrics visualization.

### File: `src/SeniorIntern.Desktop/Controls/MetricsChart.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:lvc="using:LiveChartsCore.SkiaSharpView.Avalonia"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="200"
             x:Class="SeniorIntern.Desktop.Controls.MetricsChart">

    <lvc:CartesianChart Series="{Binding Series, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        XAxes="{Binding XAxes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        YAxes="{Binding YAxes, RelativeSource={RelativeSource AncestorType=UserControl}}"
                        TooltipPosition="Top"
                        AnimationsSpeed="00:00:00.150"
                        EasingFunction="{x:Null}">
        <lvc:CartesianChart.DrawMarginFrame>
            <lvc:DrawMarginFrame Stroke="{DynamicResource BorderBrush}" StrokeThickness="1" />
        </lvc:CartesianChart.DrawMarginFrame>
    </lvc:CartesianChart>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Controls/MetricsChart.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using System.Collections.ObjectModel;
using System.Collections.Specialized;
using Avalonia;
using Avalonia.Controls;
using Avalonia.Media;
using LiveChartsCore;
using LiveChartsCore.Defaults;
using LiveChartsCore.SkiaSharpView;
using LiveChartsCore.SkiaSharpView.Painting;
using SeniorIntern.Core.Training.Models;
using SkiaSharp;

/// <summary>
/// Real-time metrics chart control using LiveCharts.
/// </summary>
public partial class MetricsChart : UserControl
{
    private readonly ObservableCollection<ObservablePoint> _values = new();
    private int _pointIndex;

    #region Dependency Properties

    public static readonly StyledProperty<ObservableCollection<TrainingMetrics>?> DataProperty =
        AvaloniaProperty.Register<MetricsChart, ObservableCollection<TrainingMetrics>?>(nameof(Data));

    public static readonly StyledProperty<string> ValuePathProperty =
        AvaloniaProperty.Register<MetricsChart, string>(nameof(ValuePath), "Loss");

    public static readonly StyledProperty<Color> LineColorProperty =
        AvaloniaProperty.Register<MetricsChart, Color>(nameof(LineColor), Colors.DodgerBlue);

    public static readonly StyledProperty<string> YAxisLabelProperty =
        AvaloniaProperty.Register<MetricsChart, string>(nameof(YAxisLabel), string.Empty);

    public static readonly StyledProperty<int> MaxPointsProperty =
        AvaloniaProperty.Register<MetricsChart, int>(nameof(MaxPoints), 500);

    public ObservableCollection<TrainingMetrics>? Data
    {
        get => GetValue(DataProperty);
        set => SetValue(DataProperty, value);
    }

    public string ValuePath
    {
        get => GetValue(ValuePathProperty);
        set => SetValue(ValuePathProperty, value);
    }

    public Color LineColor
    {
        get => GetValue(LineColorProperty);
        set => SetValue(LineColorProperty, value);
    }

    public string YAxisLabel
    {
        get => GetValue(YAxisLabelProperty);
        set => SetValue(YAxisLabelProperty, value);
    }

    public int MaxPoints
    {
        get => GetValue(MaxPointsProperty);
        set => SetValue(MaxPointsProperty, value);
    }

    #endregion

    #region Chart Properties

    public ISeries[] Series { get; private set; }
    public Axis[] XAxes { get; private set; }
    public Axis[] YAxes { get; private set; }

    #endregion

    public MetricsChart()
    {
        InitializeComponent();
        InitializeChart();
    }

    protected override void OnPropertyChanged(AvaloniaPropertyChangedEventArgs change)
    {
        base.OnPropertyChanged(change);

        if (change.Property == DataProperty)
        {
            OnDataChanged(change.OldValue as ObservableCollection<TrainingMetrics>,
                          change.NewValue as ObservableCollection<TrainingMetrics>);
        }
        else if (change.Property == LineColorProperty)
        {
            UpdateLineColor();
        }
        else if (change.Property == YAxisLabelProperty)
        {
            UpdateYAxisLabel();
        }
    }

    private void InitializeChart()
    {
        var lineColor = new SKColor(LineColor.R, LineColor.G, LineColor.B, LineColor.A);

        Series = new ISeries[]
        {
            new LineSeries<ObservablePoint>
            {
                Values = _values,
                Fill = new SolidColorPaint(lineColor.WithAlpha(30)),
                Stroke = new SolidColorPaint(lineColor, 2),
                GeometrySize = 0,
                LineSmoothness = 0.5,
                EnableNullSplitting = false
            }
        };

        XAxes = new Axis[]
        {
            new Axis
            {
                Name = "Step",
                NamePaint = new SolidColorPaint(SKColors.Gray),
                LabelsPaint = new SolidColorPaint(SKColors.Gray),
                SeparatorsPaint = new SolidColorPaint(SKColors.Gray.WithAlpha(50)),
                MinStep = 1,
                Labeler = value => value.ToString("N0")
            }
        };

        YAxes = new Axis[]
        {
            new Axis
            {
                Name = YAxisLabel,
                NamePaint = new SolidColorPaint(SKColors.Gray),
                LabelsPaint = new SolidColorPaint(SKColors.Gray),
                SeparatorsPaint = new SolidColorPaint(SKColors.Gray.WithAlpha(50)),
                MinLimit = 0
            }
        };
    }

    private void OnDataChanged(
        ObservableCollection<TrainingMetrics>? oldData,
        ObservableCollection<TrainingMetrics>? newData)
    {
        if (oldData != null)
        {
            oldData.CollectionChanged -= OnDataCollectionChanged;
        }

        _values.Clear();
        _pointIndex = 0;

        if (newData != null)
        {
            newData.CollectionChanged += OnDataCollectionChanged;

            // Add existing points
            foreach (var metrics in newData)
            {
                AddPoint(metrics);
            }
        }
    }

    private void OnDataCollectionChanged(object? sender, NotifyCollectionChangedEventArgs e)
    {
        if (e.Action == NotifyCollectionChangedAction.Add && e.NewItems != null)
        {
            foreach (TrainingMetrics metrics in e.NewItems)
            {
                AddPoint(metrics);
            }
        }
        else if (e.Action == NotifyCollectionChangedAction.Reset)
        {
            _values.Clear();
            _pointIndex = 0;
        }
    }

    private void AddPoint(TrainingMetrics metrics)
    {
        var value = GetValue(metrics);
        _values.Add(new ObservablePoint(_pointIndex++, value));

        // Trim to max points
        while (_values.Count > MaxPoints)
        {
            _values.RemoveAt(0);
        }
    }

    private double GetValue(TrainingMetrics metrics)
    {
        return ValuePath switch
        {
            "Loss" => metrics.Loss,
            "LearningRate" => metrics.LearningRate,
            "GradientNorm" => metrics.GradientNorm,
            "ValidationLoss" => metrics.ValidationLoss ?? 0,
            _ => 0
        };
    }

    private void UpdateLineColor()
    {
        if (Series?.Length > 0 && Series[0] is LineSeries<ObservablePoint> lineSeries)
        {
            var lineColor = new SKColor(LineColor.R, LineColor.G, LineColor.B, LineColor.A);
            lineSeries.Stroke = new SolidColorPaint(lineColor, 2);
            lineSeries.Fill = new SolidColorPaint(lineColor.WithAlpha(30));
        }
    }

    private void UpdateYAxisLabel()
    {
        if (YAxes?.Length > 0)
        {
            YAxes[0].Name = YAxisLabel;
        }
    }
}
```

### File: `src/SeniorIntern.Desktop/Controls/DualMetricsChart.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using System.Collections.ObjectModel;
using Avalonia;
using Avalonia.Controls;
using Avalonia.Media;
using LiveChartsCore;
using LiveChartsCore.Defaults;
using LiveChartsCore.SkiaSharpView;
using LiveChartsCore.SkiaSharpView.Painting;
using SeniorIntern.Core.Training.Models;
using SkiaSharp;

/// <summary>
/// Dual-axis metrics chart for displaying two metrics simultaneously.
/// </summary>
public partial class DualMetricsChart : UserControl
{
    private readonly ObservableCollection<ObservablePoint> _primaryValues = new();
    private readonly ObservableCollection<ObservablePoint> _secondaryValues = new();

    public static readonly StyledProperty<ObservableCollection<TrainingMetrics>?> DataProperty =
        AvaloniaProperty.Register<DualMetricsChart, ObservableCollection<TrainingMetrics>?>(nameof(Data));

    public static readonly StyledProperty<string> PrimaryValuePathProperty =
        AvaloniaProperty.Register<DualMetricsChart, string>(nameof(PrimaryValuePath), "Loss");

    public static readonly StyledProperty<string> SecondaryValuePathProperty =
        AvaloniaProperty.Register<DualMetricsChart, string>(nameof(SecondaryValuePath), "LearningRate");

    public static readonly StyledProperty<string> PrimaryLabelProperty =
        AvaloniaProperty.Register<DualMetricsChart, string>(nameof(PrimaryLabel), "Loss");

    public static readonly StyledProperty<string> SecondaryLabelProperty =
        AvaloniaProperty.Register<DualMetricsChart, string>(nameof(SecondaryLabel), "Learning Rate");

    public ObservableCollection<TrainingMetrics>? Data
    {
        get => GetValue(DataProperty);
        set => SetValue(DataProperty, value);
    }

    public string PrimaryValuePath
    {
        get => GetValue(PrimaryValuePathProperty);
        set => SetValue(PrimaryValuePathProperty, value);
    }

    public string SecondaryValuePath
    {
        get => GetValue(SecondaryValuePathProperty);
        set => SetValue(SecondaryValuePathProperty, value);
    }

    public string PrimaryLabel
    {
        get => GetValue(PrimaryLabelProperty);
        set => SetValue(PrimaryLabelProperty, value);
    }

    public string SecondaryLabel
    {
        get => GetValue(SecondaryLabelProperty);
        set => SetValue(SecondaryLabelProperty, value);
    }

    public ISeries[] Series { get; private set; }
    public Axis[] XAxes { get; private set; }
    public Axis[] YAxes { get; private set; }

    public DualMetricsChart()
    {
        InitializeChart();
    }

    private void InitializeChart()
    {
        Series = new ISeries[]
        {
            new LineSeries<ObservablePoint>
            {
                Values = _primaryValues,
                Name = PrimaryLabel,
                Stroke = new SolidColorPaint(SKColors.DodgerBlue, 2),
                Fill = null,
                GeometrySize = 0,
                ScalesYAt = 0
            },
            new LineSeries<ObservablePoint>
            {
                Values = _secondaryValues,
                Name = SecondaryLabel,
                Stroke = new SolidColorPaint(SKColors.Orange, 2),
                Fill = null,
                GeometrySize = 0,
                ScalesYAt = 1
            }
        };

        XAxes = new Axis[]
        {
            new Axis
            {
                Name = "Step",
                LabelsPaint = new SolidColorPaint(SKColors.Gray)
            }
        };

        YAxes = new Axis[]
        {
            new Axis
            {
                Name = PrimaryLabel,
                NamePaint = new SolidColorPaint(SKColors.DodgerBlue),
                LabelsPaint = new SolidColorPaint(SKColors.DodgerBlue),
                Position = LiveChartsCore.Measure.AxisPosition.Start
            },
            new Axis
            {
                Name = SecondaryLabel,
                NamePaint = new SolidColorPaint(SKColors.Orange),
                LabelsPaint = new SolidColorPaint(SKColors.Orange),
                Position = LiveChartsCore.Measure.AxisPosition.End
            }
        };
    }
}
```

---

## v0.8.5f: HardwareGauge Control

### Objective
Create a custom gauge control for displaying hardware utilization metrics.

### File: `src/SeniorIntern.Desktop/Controls/HardwareGauge.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="300" d:DesignHeight="50"
             x:Class="SeniorIntern.Desktop.Controls.HardwareGauge"
             x:Name="Root">

    <Grid RowDefinitions="Auto,Auto" ColumnDefinitions="*,Auto">
        <!-- Label Row -->
        <TextBlock Grid.Column="0"
                   Text="{Binding Title, ElementName=Root}"
                   FontSize="12"
                   Foreground="{DynamicResource SecondaryTextColor}" />

        <!-- Value Display -->
        <StackPanel Grid.Column="1" Orientation="Horizontal">
            <TextBlock Text="{Binding DisplayValue, ElementName=Root}"
                       FontSize="12"
                       FontWeight="SemiBold" />
            <TextBlock Text="{Binding Unit, ElementName=Root}"
                       FontSize="12"
                       Foreground="{DynamicResource SecondaryTextColor}"
                       Margin="2,0,0,0" />
        </StackPanel>

        <!-- Progress Bar -->
        <Border Grid.Row="1" Grid.ColumnSpan="2"
                Margin="0,4,0,0"
                Height="8"
                CornerRadius="4"
                Background="{DynamicResource SurfaceColor}">
            <Border HorizontalAlignment="Left"
                    CornerRadius="4"
                    Width="{Binding BarWidth, ElementName=Root}"
                    Background="{Binding GaugeColor, ElementName=Root}">
                <Border.Transitions>
                    <Transitions>
                        <DoubleTransition Property="Width" Duration="0:0:0.2" Easing="CubicEaseOut" />
                    </Transitions>
                </Border.Transitions>
            </Border>
        </Border>
    </Grid>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Controls/HardwareGauge.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using Avalonia;
using Avalonia.Controls;
using Avalonia.Media;

/// <summary>
/// Hardware utilization gauge control.
/// </summary>
public partial class HardwareGauge : UserControl
{
    #region Dependency Properties

    public static readonly StyledProperty<string> TitleProperty =
        AvaloniaProperty.Register<HardwareGauge, string>(nameof(Title), "Metric");

    public static readonly StyledProperty<double> PercentProperty =
        AvaloniaProperty.Register<HardwareGauge, double>(nameof(Percent), 0);

    public static readonly StyledProperty<double> CurrentProperty =
        AvaloniaProperty.Register<HardwareGauge, double>(nameof(Current), 0);

    public static readonly StyledProperty<double> TotalProperty =
        AvaloniaProperty.Register<HardwareGauge, double>(nameof(Total), 100);

    public static readonly StyledProperty<double> ValueProperty =
        AvaloniaProperty.Register<HardwareGauge, double>(nameof(Value), 0);

    public static readonly StyledProperty<double> MaxValueProperty =
        AvaloniaProperty.Register<HardwareGauge, double>(nameof(MaxValue), 100);

    public static readonly StyledProperty<string> UnitProperty =
        AvaloniaProperty.Register<HardwareGauge, string>(nameof(Unit), "%");

    public static readonly StyledProperty<IBrush> GaugeColorProperty =
        AvaloniaProperty.Register<HardwareGauge, IBrush>(nameof(GaugeColor), Brushes.DodgerBlue);

    public static readonly StyledProperty<bool> ShowPercentProperty =
        AvaloniaProperty.Register<HardwareGauge, bool>(nameof(ShowPercent), true);

    public string Title
    {
        get => GetValue(TitleProperty);
        set => SetValue(TitleProperty, value);
    }

    public double Percent
    {
        get => GetValue(PercentProperty);
        set => SetValue(PercentProperty, value);
    }

    public double Current
    {
        get => GetValue(CurrentProperty);
        set => SetValue(CurrentProperty, value);
    }

    public double Total
    {
        get => GetValue(TotalProperty);
        set => SetValue(TotalProperty, value);
    }

    public double Value
    {
        get => GetValue(ValueProperty);
        set => SetValue(ValueProperty, value);
    }

    public double MaxValue
    {
        get => GetValue(MaxValueProperty);
        set => SetValue(MaxValueProperty, value);
    }

    public string Unit
    {
        get => GetValue(UnitProperty);
        set => SetValue(UnitProperty, value);
    }

    public IBrush GaugeColor
    {
        get => GetValue(GaugeColorProperty);
        set => SetValue(GaugeColorProperty, value);
    }

    public bool ShowPercent
    {
        get => GetValue(ShowPercentProperty);
        set => SetValue(ShowPercentProperty, value);
    }

    #endregion

    #region Computed Properties

    public string DisplayValue
    {
        get
        {
            if (Unit == "%" || ShowPercent)
            {
                return $"{EffectivePercent:F0}%";
            }
            else if (Unit == "GB")
            {
                var currentGb = Current / (1024.0 * 1024.0 * 1024.0);
                var totalGb = Total / (1024.0 * 1024.0 * 1024.0);
                return $"{currentGb:F1}/{totalGb:F0}";
            }
            else if (Unit == "°C")
            {
                return $"{Value:F0}";
            }
            else
            {
                return $"{Value:F1}";
            }
        }
    }

    public double EffectivePercent
    {
        get
        {
            if (Percent > 0)
                return Math.Clamp(Percent, 0, 100);

            if (Total > 0)
                return Math.Clamp(Current / Total * 100, 0, 100);

            if (MaxValue > 0)
                return Math.Clamp(Value / MaxValue * 100, 0, 100);

            return 0;
        }
    }

    public double BarWidth
    {
        get
        {
            var parentWidth = Bounds.Width;
            if (parentWidth <= 0) parentWidth = 200;

            return parentWidth * (EffectivePercent / 100.0);
        }
    }

    #endregion

    public HardwareGauge()
    {
        InitializeComponent();
    }

    protected override void OnPropertyChanged(AvaloniaPropertyChangedEventArgs change)
    {
        base.OnPropertyChanged(change);

        if (change.Property == PercentProperty ||
            change.Property == CurrentProperty ||
            change.Property == TotalProperty ||
            change.Property == ValueProperty ||
            change.Property == MaxValueProperty)
        {
            // Trigger UI update
            RaisePropertyChanged(nameof(DisplayValue));
            RaisePropertyChanged(nameof(EffectivePercent));
            RaisePropertyChanged(nameof(BarWidth));
        }
    }

    protected override void OnSizeChanged(SizeChangedEventArgs e)
    {
        base.OnSizeChanged(e);
        RaisePropertyChanged(nameof(BarWidth));
    }

    private void RaisePropertyChanged(string propertyName)
    {
        // Manually trigger binding updates
        this.GetObservable(BoundsProperty).Subscribe(_ => { });
    }
}
```

### File: `src/SeniorIntern.Desktop/Controls/CircularGauge.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using Avalonia;
using Avalonia.Controls;
using Avalonia.Media;

/// <summary>
/// Circular progress gauge for hardware metrics.
/// </summary>
public partial class CircularGauge : UserControl
{
    public static readonly StyledProperty<double> PercentProperty =
        AvaloniaProperty.Register<CircularGauge, double>(nameof(Percent), 0);

    public static readonly StyledProperty<string> LabelProperty =
        AvaloniaProperty.Register<CircularGauge, string>(nameof(Label), string.Empty);

    public static readonly StyledProperty<IBrush> GaugeColorProperty =
        AvaloniaProperty.Register<CircularGauge, IBrush>(nameof(GaugeColor), Brushes.DodgerBlue);

    public static readonly StyledProperty<double> SizeProperty =
        AvaloniaProperty.Register<CircularGauge, double>(nameof(Size), 80);

    public static readonly StyledProperty<double> StrokeWidthProperty =
        AvaloniaProperty.Register<CircularGauge, double>(nameof(StrokeWidth), 8);

    public double Percent
    {
        get => GetValue(PercentProperty);
        set => SetValue(PercentProperty, value);
    }

    public string Label
    {
        get => GetValue(LabelProperty);
        set => SetValue(LabelProperty, value);
    }

    public IBrush GaugeColor
    {
        get => GetValue(GaugeColorProperty);
        set => SetValue(GaugeColorProperty, value);
    }

    public double Size
    {
        get => GetValue(SizeProperty);
        set => SetValue(SizeProperty, value);
    }

    public double StrokeWidth
    {
        get => GetValue(StrokeWidthProperty);
        set => SetValue(StrokeWidthProperty, value);
    }

    // Computed properties for arc geometry
    public double ArcEndAngle => -90 + (Percent / 100.0 * 360);

    public CircularGauge()
    {
        InitializeComponent();
    }

    public override void Render(DrawingContext context)
    {
        base.Render(context);

        var center = new Point(Size / 2, Size / 2);
        var radius = (Size - StrokeWidth) / 2;

        // Background circle
        var backgroundPen = new Pen(new SolidColorBrush(Color.FromArgb(50, 128, 128, 128)), StrokeWidth);
        context.DrawEllipse(null, backgroundPen, center, radius, radius);

        // Progress arc
        if (Percent > 0)
        {
            var gaugePen = new Pen(GaugeColor, StrokeWidth)
            {
                LineCap = PenLineCap.Round
            };

            var startAngle = -90;
            var sweepAngle = Percent / 100.0 * 360;

            var geometry = new StreamGeometry();
            using (var ctx = geometry.Open())
            {
                var startRad = startAngle * Math.PI / 180;
                var endRad = (startAngle + sweepAngle) * Math.PI / 180;

                var startPoint = new Point(
                    center.X + radius * Math.Cos(startRad),
                    center.Y + radius * Math.Sin(startRad));

                var endPoint = new Point(
                    center.X + radius * Math.Cos(endRad),
                    center.Y + radius * Math.Sin(endRad));

                ctx.BeginFigure(startPoint, false);
                ctx.ArcTo(endPoint, new Size(radius, radius), 0,
                    sweepAngle > 180, SweepDirection.Clockwise);
            }

            context.DrawGeometry(null, gaugePen, geometry);
        }

        // Center text
        var formattedText = new FormattedText(
            $"{Percent:F0}%",
            Typeface.Default,
            Size / 4,
            TextAlignment.Center,
            TextWrapping.NoWrap,
            new Size(Size, Size));

        context.DrawText(formattedText, new Point(center.X - formattedText.Width / 2, center.Y - formattedText.Height / 2));
    }
}
```

---

## v0.8.5g: Log Viewer Control

### Objective
Create a virtualized log viewer control for displaying training logs efficiently.

### File: `src/SeniorIntern.Desktop/Controls/LogViewer.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="350" d:DesignHeight="300"
             x:Class="SeniorIntern.Desktop.Controls.LogViewer"
             x:Name="Root">

    <Grid RowDefinitions="Auto,*">
        <!-- Filter Bar (Optional) -->
        <Grid Grid.Row="0"
              ColumnDefinitions="*,Auto"
              IsVisible="{Binding ShowFilter, ElementName=Root}"
              Margin="0,0,0,8">
            <TextBox Watermark="Filter logs..."
                     Text="{Binding FilterText, ElementName=Root}" />
            <ComboBox Grid.Column="1"
                      SelectedItem="{Binding FilterLevel, ElementName=Root}"
                      Margin="8,0,0,0"
                      Width="80">
                <ComboBoxItem Content="All" Tag="" />
                <ComboBoxItem Content="Info" Tag="Info" />
                <ComboBoxItem Content="Warning" Tag="Warning" />
                <ComboBoxItem Content="Error" Tag="Error" />
            </ComboBox>
        </Grid>

        <!-- Log List -->
        <ListBox Grid.Row="1"
                 Items="{Binding FilteredLogEntries, ElementName=Root}"
                 Background="Transparent"
                 BorderThickness="0"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 x:Name="LogListBox">
            <ListBox.ItemTemplate>
                <DataTemplate DataType="vm:LogEntry">
                    <Grid ColumnDefinitions="Auto,Auto,*" Margin="0,2">
                        <!-- Timestamp -->
                        <TextBlock Grid.Column="0"
                                   Text="{Binding FormattedTime}"
                                   FontFamily="Consolas, Menlo, monospace"
                                   FontSize="11"
                                   Foreground="{DynamicResource SecondaryTextColor}"
                                   Margin="0,0,8,0" />

                        <!-- Level Indicator -->
                        <Border Grid.Column="1"
                                CornerRadius="2"
                                Padding="4,1"
                                Margin="0,0,8,0"
                                Background="{Binding Level, Converter={StaticResource LogLevelToBrushConverter}}">
                            <TextBlock Text="{Binding Level}"
                                       FontSize="10"
                                       Foreground="White" />
                        </Border>

                        <!-- Message -->
                        <TextBlock Grid.Column="2"
                                   Text="{Binding Message}"
                                   FontFamily="Consolas, Menlo, monospace"
                                   FontSize="11"
                                   TextWrapping="Wrap" />
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>

            <ListBox.Styles>
                <Style Selector="ListBoxItem">
                    <Setter Property="Padding" Value="4,2" />
                    <Setter Property="MinHeight" Value="20" />
                </Style>
                <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
                    <Setter Property="Background" Value="{DynamicResource SurfaceColor}" />
                </Style>
            </ListBox.Styles>
        </ListBox>
    </Grid>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Controls/LogViewer.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using System.Collections.ObjectModel;
using System.Collections.Specialized;
using Avalonia;
using Avalonia.Controls;
using Avalonia.Threading;
using SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Virtualized log viewer control with filtering support.
/// </summary>
public partial class LogViewer : UserControl
{
    private bool _autoScrollPending;

    #region Dependency Properties

    public static readonly StyledProperty<ObservableCollection<LogEntry>?> LogEntriesProperty =
        AvaloniaProperty.Register<LogViewer, ObservableCollection<LogEntry>?>(nameof(LogEntries));

    public static readonly StyledProperty<bool> AutoScrollProperty =
        AvaloniaProperty.Register<LogViewer, bool>(nameof(AutoScroll), true);

    public static readonly StyledProperty<bool> ShowFilterProperty =
        AvaloniaProperty.Register<LogViewer, bool>(nameof(ShowFilter), false);

    public static readonly StyledProperty<string> FilterTextProperty =
        AvaloniaProperty.Register<LogViewer, string>(nameof(FilterText), string.Empty);

    public static readonly StyledProperty<LogLevel?> FilterLevelProperty =
        AvaloniaProperty.Register<LogViewer, LogLevel?>(nameof(FilterLevel), null);

    public static readonly StyledProperty<int> MaxEntriesProperty =
        AvaloniaProperty.Register<LogViewer, int>(nameof(MaxEntries), 1000);

    public ObservableCollection<LogEntry>? LogEntries
    {
        get => GetValue(LogEntriesProperty);
        set => SetValue(LogEntriesProperty, value);
    }

    public bool AutoScroll
    {
        get => GetValue(AutoScrollProperty);
        set => SetValue(AutoScrollProperty, value);
    }

    public bool ShowFilter
    {
        get => GetValue(ShowFilterProperty);
        set => SetValue(ShowFilterProperty, value);
    }

    public string FilterText
    {
        get => GetValue(FilterTextProperty);
        set => SetValue(FilterTextProperty, value);
    }

    public LogLevel? FilterLevel
    {
        get => GetValue(FilterLevelProperty);
        set => SetValue(FilterLevelProperty, value);
    }

    public int MaxEntries
    {
        get => GetValue(MaxEntriesProperty);
        set => SetValue(MaxEntriesProperty, value);
    }

    #endregion

    #region Computed Properties

    public IEnumerable<LogEntry> FilteredLogEntries
    {
        get
        {
            if (LogEntries == null)
                return Enumerable.Empty<LogEntry>();

            var entries = LogEntries.AsEnumerable();

            // Apply level filter
            if (FilterLevel.HasValue)
            {
                entries = entries.Where(e => e.Level >= FilterLevel.Value);
            }

            // Apply text filter
            if (!string.IsNullOrWhiteSpace(FilterText))
            {
                var filter = FilterText.ToLowerInvariant();
                entries = entries.Where(e =>
                    e.Message.ToLowerInvariant().Contains(filter));
            }

            return entries;
        }
    }

    #endregion

    public LogViewer()
    {
        InitializeComponent();
    }

    protected override void OnPropertyChanged(AvaloniaPropertyChangedEventArgs change)
    {
        base.OnPropertyChanged(change);

        if (change.Property == LogEntriesProperty)
        {
            OnLogEntriesChanged(
                change.OldValue as ObservableCollection<LogEntry>,
                change.NewValue as ObservableCollection<LogEntry>);
        }
        else if (change.Property == FilterTextProperty ||
                 change.Property == FilterLevelProperty)
        {
            // Refresh filtered entries
            this.RaisePropertyChanged(nameof(FilteredLogEntries));
        }
    }

    private void OnLogEntriesChanged(
        ObservableCollection<LogEntry>? oldEntries,
        ObservableCollection<LogEntry>? newEntries)
    {
        if (oldEntries != null)
        {
            oldEntries.CollectionChanged -= OnLogEntriesCollectionChanged;
        }

        if (newEntries != null)
        {
            newEntries.CollectionChanged += OnLogEntriesCollectionChanged;
        }

        this.RaisePropertyChanged(nameof(FilteredLogEntries));
    }

    private void OnLogEntriesCollectionChanged(object? sender, NotifyCollectionChangedEventArgs e)
    {
        this.RaisePropertyChanged(nameof(FilteredLogEntries));

        if (AutoScroll && e.Action == NotifyCollectionChangedAction.Add && !_autoScrollPending)
        {
            _autoScrollPending = true;

            Dispatcher.UIThread.InvokeAsync(() =>
            {
                ScrollToEnd();
                _autoScrollPending = false;
            }, DispatcherPriority.Background);
        }
    }

    private void ScrollToEnd()
    {
        if (LogListBox?.ItemCount > 0)
        {
            LogListBox.ScrollIntoView(LogListBox.ItemCount - 1);
        }
    }

    /// <summary>
    /// Clear all log entries.
    /// </summary>
    public void Clear()
    {
        LogEntries?.Clear();
    }

    /// <summary>
    /// Export log entries to a file.
    /// </summary>
    public async Task ExportToFileAsync(string path)
    {
        if (LogEntries == null) return;

        var lines = LogEntries.Select(e =>
            $"[{e.Timestamp:yyyy-MM-dd HH:mm:ss.fff}] [{e.Level}] {e.Message}");

        await File.WriteAllLinesAsync(path, lines);
    }

    private void RaisePropertyChanged(string propertyName)
    {
        // Manually raise property changed for computed properties
    }
}
```

### File: `src/SeniorIntern.Desktop/Converters/LogLevelToBrushConverter.cs`

```csharp
namespace SeniorIntern.Desktop.Converters;

using System.Globalization;
using Avalonia.Data.Converters;
using Avalonia.Media;
using SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Converts LogLevel to a brush for visual indication.
/// </summary>
public class LogLevelToBrushConverter : IValueConverter
{
    public static readonly LogLevelToBrushConverter Instance = new();

    public object? Convert(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        if (value is LogLevel level)
        {
            return level switch
            {
                LogLevel.Debug => new SolidColorBrush(Color.FromRgb(100, 100, 100)),
                LogLevel.Info => new SolidColorBrush(Color.FromRgb(30, 144, 255)),
                LogLevel.Warning => new SolidColorBrush(Color.FromRgb(255, 165, 0)),
                LogLevel.Error => new SolidColorBrush(Color.FromRgb(220, 53, 69)),
                _ => Brushes.Gray
            };
        }

        return Brushes.Gray;
    }

    public object? ConvertBack(object? value, Type targetType, object? parameter, CultureInfo culture)
    {
        throw new NotImplementedException();
    }
}
```

---

## v0.8.5h: Adapter Manager View

### Objective
Create the adapter management interface for viewing, loading, exporting, and deleting trained adapters.

### File: `src/SeniorIntern.Desktop/Views/AdapterManagerView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
             x:Class="SeniorIntern.Desktop.Views.AdapterManagerView"
             x:DataType="vm:TrainingLabViewModel">

    <Grid RowDefinitions="Auto,*" Margin="24">
        <!-- Toolbar -->
        <Grid Grid.Row="0" ColumnDefinitions="Auto,*,Auto" Margin="0,0,0,16">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <Button Command="{Binding StartWizardCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource AddIcon}" Width="16" Height="16" />
                        <TextBlock Text="New Adapter" />
                    </StackPanel>
                </Button>
                <Button Command="{Binding ImportAdapterCommand}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <PathIcon Data="{StaticResource ImportIcon}" Width="16" Height="16" />
                        <TextBlock Text="Import" />
                    </StackPanel>
                </Button>
            </StackPanel>

            <!-- Search -->
            <TextBox Grid.Column="2"
                     Width="250"
                     Watermark="Search adapters..."
                     Text="{Binding AdapterSearchText}">
                <TextBox.InnerLeftContent>
                    <PathIcon Data="{StaticResource SearchIcon}"
                              Width="16" Height="16"
                              Margin="8,0,0,0"
                              Foreground="{DynamicResource SecondaryTextColor}" />
                </TextBox.InnerLeftContent>
            </TextBox>
        </Grid>

        <!-- Adapter List -->
        <ScrollViewer Grid.Row="1" HorizontalScrollBarVisibility="Disabled">
            <ItemsControl Items="{Binding FilteredAdapters}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Spacing="8" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="vm:LoraAdapterInfo">
                        <Border Background="{DynamicResource SurfaceColor}"
                                CornerRadius="8"
                                Padding="16"
                                PointerPressed="OnAdapterCardPressed">
                            <Grid ColumnDefinitions="Auto,*,Auto">
                                <!-- Status Indicator -->
                                <Ellipse Grid.Column="0"
                                         Width="12" Height="12"
                                         Margin="0,0,12,0"
                                         VerticalAlignment="Top">
                                    <Ellipse.Fill>
                                        <MultiBinding Converter="{StaticResource AdapterStatusConverter}">
                                            <Binding Path="." />
                                            <Binding Path="DataContext.ActiveAdapter"
                                                     RelativeSource="{RelativeSource AncestorType=UserControl}" />
                                        </MultiBinding>
                                    </Ellipse.Fill>
                                </Ellipse>

                                <!-- Info -->
                                <StackPanel Grid.Column="1" Spacing="4">
                                    <StackPanel Orientation="Horizontal" Spacing="8">
                                        <TextBlock Text="{Binding Name}"
                                                   FontSize="16"
                                                   FontWeight="SemiBold" />
                                        <Border Background="{DynamicResource AccentColorLight}"
                                                CornerRadius="4"
                                                Padding="6,2"
                                                IsVisible="{Binding IsActive}">
                                            <TextBlock Text="Active"
                                                       FontSize="11"
                                                       Foreground="{DynamicResource AccentColor}" />
                                        </Border>
                                    </StackPanel>

                                    <TextBlock Text="{Binding Description}"
                                               Foreground="{DynamicResource SecondaryTextColor}"
                                               FontSize="13"
                                               IsVisible="{Binding Description, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />

                                    <StackPanel Orientation="Horizontal" Spacing="16" Margin="0,8,0,0">
                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <PathIcon Data="{StaticResource ModelIcon}"
                                                      Width="14" Height="14"
                                                      Foreground="{DynamicResource SecondaryTextColor}" />
                                            <TextBlock Text="{Binding BaseModelName}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SecondaryTextColor}" />
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <PathIcon Data="{StaticResource TuneIcon}"
                                                      Width="14" Height="14"
                                                      Foreground="{DynamicResource SecondaryTextColor}" />
                                            <TextBlock Text="{Binding Rank, StringFormat='Rank: {0}'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SecondaryTextColor}" />
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <PathIcon Data="{StaticResource ChartIcon}"
                                                      Width="14" Height="14"
                                                      Foreground="{DynamicResource SecondaryTextColor}" />
                                            <TextBlock Text="{Binding FinalLoss, StringFormat='Loss: {0:F3}'}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SecondaryTextColor}" />
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <PathIcon Data="{StaticResource StorageIcon}"
                                                      Width="14" Height="14"
                                                      Foreground="{DynamicResource SecondaryTextColor}" />
                                            <TextBlock Text="{Binding SizeFormatted}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SecondaryTextColor}" />
                                        </StackPanel>

                                        <StackPanel Orientation="Horizontal" Spacing="4">
                                            <PathIcon Data="{StaticResource CalendarIcon}"
                                                      Width="14" Height="14"
                                                      Foreground="{DynamicResource SecondaryTextColor}" />
                                            <TextBlock Text="{Binding CreatedAtFormatted}"
                                                       FontSize="12"
                                                       Foreground="{DynamicResource SecondaryTextColor}" />
                                        </StackPanel>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Actions -->
                                <StackPanel Grid.Column="2"
                                            Orientation="Horizontal"
                                            Spacing="4"
                                            VerticalAlignment="Center">
                                    <Button Command="{Binding DataContext.LoadAdapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            ToolTip.Tip="Load Adapter"
                                            Classes="icon"
                                            IsVisible="{Binding !IsActive}">
                                        <PathIcon Data="{StaticResource PlayIcon}" Width="16" Height="16" />
                                    </Button>

                                    <Button Command="{Binding DataContext.UnloadAdapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            ToolTip.Tip="Unload Adapter"
                                            Classes="icon"
                                            IsVisible="{Binding IsActive}">
                                        <PathIcon Data="{StaticResource StopIcon}" Width="16" Height="16" />
                                    </Button>

                                    <Button Command="{Binding DataContext.ExportAdapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            ToolTip.Tip="Export"
                                            Classes="icon">
                                        <PathIcon Data="{StaticResource ExportIcon}" Width="16" Height="16" />
                                    </Button>

                                    <Button Command="{Binding DataContext.DeleteAdapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                            CommandParameter="{Binding}"
                                            ToolTip.Tip="Delete"
                                            Classes="icon danger">
                                        <PathIcon Data="{StaticResource DeleteIcon}" Width="16" Height="16" />
                                    </Button>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>

        <!-- Empty State -->
        <StackPanel Grid.Row="1"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Center"
                    IsVisible="{Binding !Adapters.Count}">
            <PathIcon Data="{StaticResource TrainingIcon}"
                      Width="64" Height="64"
                      Foreground="{DynamicResource SecondaryTextColor}"
                      Opacity="0.5" />
            <TextBlock Text="No adapters yet"
                       FontSize="18"
                       Foreground="{DynamicResource SecondaryTextColor}"
                       HorizontalAlignment="Center"
                       Margin="0,16,0,8" />
            <TextBlock Text="Create a new adapter to fine-tune a model on your code"
                       Foreground="{DynamicResource SecondaryTextColor}"
                       HorizontalAlignment="Center"
                       FontSize="13" />
            <Button Content="Create New Adapter"
                    Command="{Binding StartWizardCommand}"
                    Classes="accent"
                    HorizontalAlignment="Center"
                    Margin="0,16,0,0" />
        </StackPanel>
    </Grid>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/AdapterManagerView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;
using Avalonia.Input;

public partial class AdapterManagerView : UserControl
{
    public AdapterManagerView()
    {
        InitializeComponent();
    }

    private void OnAdapterCardPressed(object? sender, PointerPressedEventArgs e)
    {
        // Handle double-click to load adapter
        if (e.ClickCount == 2 && sender is Border { DataContext: LoraAdapterInfo adapter })
        {
            if (DataContext is TrainingLabViewModel vm && vm.ActiveAdapter?.Id != adapter.Id)
            {
                vm.LoadAdapterCommand.Execute(adapter);
            }
        }
    }
}
```

### File: `src/SeniorIntern.Desktop/Views/AdapterDetailView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="600"
             x:Class="SeniorIntern.Desktop.Views.AdapterDetailView"
             x:DataType="vm:LoraAdapterInfo">

    <ScrollViewer Padding="24">
        <StackPanel Spacing="24">
            <!-- Header -->
            <StackPanel Spacing="8">
                <TextBlock Text="{Binding Name}"
                           FontSize="24"
                           FontWeight="SemiBold" />
                <TextBlock Text="{Binding Description}"
                           Foreground="{DynamicResource SecondaryTextColor}"
                           TextWrapping="Wrap"
                           IsVisible="{Binding Description, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
            </StackPanel>

            <!-- Training Info -->
            <Border Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16">
                <StackPanel Spacing="12">
                    <TextBlock Text="Training Information"
                               FontWeight="SemiBold" />

                    <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto,Auto,Auto">
                        <StackPanel Grid.Row="0" Grid.Column="0" Spacing="2">
                            <TextBlock Text="Base Model"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding BaseModelName}" />
                        </StackPanel>

                        <StackPanel Grid.Row="0" Grid.Column="1" Spacing="2">
                            <TextBlock Text="Final Loss"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding FinalLoss, StringFormat='{}{0:F4}'}" />
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="0" Spacing="2" Margin="0,12,0,0">
                            <TextBlock Text="LoRA Rank"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding Rank}" />
                        </StackPanel>

                        <StackPanel Grid.Row="1" Grid.Column="1" Spacing="2" Margin="0,12,0,0">
                            <TextBlock Text="LoRA Alpha"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding Alpha}" />
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="0" Spacing="2" Margin="0,12,0,0">
                            <TextBlock Text="Created"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding CreatedAt, StringFormat='{}{0:g}'}" />
                        </StackPanel>

                        <StackPanel Grid.Row="2" Grid.Column="1" Spacing="2" Margin="0,12,0,0">
                            <TextBlock Text="Size"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding SizeFormatted}" />
                        </StackPanel>

                        <StackPanel Grid.Row="3" Grid.ColumnSpan="2" Spacing="2" Margin="0,12,0,0">
                            <TextBlock Text="Target Modules"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                            <TextBlock Text="{Binding TargetModulesFormatted}" TextWrapping="Wrap" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Training Metrics -->
            <Border Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16"
                    IsVisible="{Binding HasTrainingMetrics}">
                <StackPanel Spacing="12">
                    <TextBlock Text="Training Metrics"
                               FontWeight="SemiBold" />

                    <Grid ColumnDefinitions="*,*,*">
                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TrainingMetrics.Epochs}"
                                       FontSize="24"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentColor}" />
                            <TextBlock Text="Epochs"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                        </StackPanel>

                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TrainingMetrics.TotalSteps, StringFormat='{}{0:N0}'}"
                                       FontSize="24"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentColor}" />
                            <TextBlock Text="Steps"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                        </StackPanel>

                        <StackPanel Spacing="2">
                            <TextBlock Text="{Binding TrainingMetrics.Duration, StringFormat='{}{0:hh\\:mm}'}"
                                       FontSize="24"
                                       FontWeight="SemiBold"
                                       Foreground="{DynamicResource AccentColor}" />
                            <TextBlock Text="Duration"
                                       FontSize="11"
                                       Foreground="{DynamicResource SecondaryTextColor}" />
                        </StackPanel>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- File Path -->
            <Border Background="{DynamicResource SurfaceColor}"
                    CornerRadius="8"
                    Padding="16">
                <StackPanel Spacing="8">
                    <TextBlock Text="File Location"
                               FontWeight="SemiBold" />
                    <TextBox Text="{Binding Path}"
                             IsReadOnly="True"
                             FontFamily="Consolas, Menlo, monospace"
                             FontSize="12" />
                    <Button Content="Open Folder"
                            Command="{Binding OpenFolderCommand}"
                            HorizontalAlignment="Left" />
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Views/AdapterDetailView.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Views;

using Avalonia.Controls;

public partial class AdapterDetailView : UserControl
{
    public AdapterDetailView()
    {
        InitializeComponent();
    }
}
```

---

## v0.8.5i: Training Settings & Presets

### Objective
Create training settings management and preset templates for common training scenarios.

### File: `src/SeniorIntern.Core/Models/TrainingSettings.cs`

```csharp
namespace SeniorIntern.Core.Models;

/// <summary>
/// User-configurable training settings.
/// </summary>
public sealed class TrainingSettings
{
    /// <summary>
    /// Directory for storing trained adapters.
    /// </summary>
    public string AdaptersDirectory { get; set; } = Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
        "SeniorIntern", "adapters");

    /// <summary>
    /// Directory for storing training checkpoints.
    /// </summary>
    public string CheckpointsDirectory { get; set; } = Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
        "SeniorIntern", "checkpoints");

    /// <summary>
    /// Directory for storing datasets.
    /// </summary>
    public string DatasetsDirectory { get; set; } = Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
        "SeniorIntern", "datasets");

    /// <summary>
    /// Default LoRA rank for new training jobs.
    /// </summary>
    public int DefaultLoraRank { get; set; } = 16;

    /// <summary>
    /// Default LoRA alpha for new training jobs.
    /// </summary>
    public float DefaultLoraAlpha { get; set; } = 32f;

    /// <summary>
    /// Default LoRA dropout for new training jobs.
    /// </summary>
    public float DefaultLoraDropout { get; set; } = 0.05f;

    /// <summary>
    /// Default learning rate.
    /// </summary>
    public float DefaultLearningRate { get; set; } = 2e-4f;

    /// <summary>
    /// Default number of epochs.
    /// </summary>
    public int DefaultEpochs { get; set; } = 3;

    /// <summary>
    /// Default batch size.
    /// </summary>
    public int DefaultBatchSize { get; set; } = 4;

    /// <summary>
    /// Default gradient accumulation steps.
    /// </summary>
    public int DefaultGradientAccumulationSteps { get; set; } = 4;

    /// <summary>
    /// Default max sequence length.
    /// </summary>
    public int DefaultMaxSequenceLength { get; set; } = 2048;

    /// <summary>
    /// Enable mixed precision (FP16) by default.
    /// </summary>
    public bool DefaultUseMixedPrecision { get; set; } = true;

    /// <summary>
    /// Enable gradient checkpointing by default.
    /// </summary>
    public bool DefaultUseGradientCheckpointing { get; set; } = false;

    /// <summary>
    /// Default learning rate scheduler.
    /// </summary>
    public string DefaultScheduler { get; set; } = "cosine";

    /// <summary>
    /// Auto-load the last used adapter on startup.
    /// </summary>
    public bool AutoLoadLastAdapter { get; set; } = true;

    /// <summary>
    /// ID of the last used adapter.
    /// </summary>
    public string? LastAdapterId { get; set; }

    /// <summary>
    /// Maximum number of checkpoints to keep per training run.
    /// </summary>
    public int MaxCheckpointsPerRun { get; set; } = 3;

    /// <summary>
    /// Checkpoint save frequency (in steps).
    /// </summary>
    public int CheckpointSaveSteps { get; set; } = 500;

    /// <summary>
    /// Enable automatic checkpointing.
    /// </summary>
    public bool EnableAutoCheckpoint { get; set; } = true;

    /// <summary>
    /// Enable TensorBoard logging.
    /// </summary>
    public bool EnableTensorBoardLogging { get; set; } = false;

    /// <summary>
    /// TensorBoard log directory.
    /// </summary>
    public string TensorBoardLogDir { get; set; } = Path.Combine(
        Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
        "SeniorIntern", "tensorboard");

    /// <summary>
    /// Show training notifications.
    /// </summary>
    public bool ShowTrainingNotifications { get; set; } = true;

    /// <summary>
    /// Play sound on training completion.
    /// </summary>
    public bool PlaySoundOnCompletion { get; set; } = true;

    /// <summary>
    /// Hardware monitoring interval in seconds.
    /// </summary>
    public int MonitoringIntervalSeconds { get; set; } = 1;

    /// <summary>
    /// GPU temperature warning threshold (Celsius).
    /// </summary>
    public float GpuTempWarningThreshold { get; set; } = 80f;

    /// <summary>
    /// GPU temperature critical threshold (Celsius).
    /// </summary>
    public float GpuTempCriticalThreshold { get; set; } = 90f;

    /// <summary>
    /// Enable automatic thermal throttling.
    /// </summary>
    public bool EnableThermalThrottling { get; set; } = true;

    /// <summary>
    /// Preferred training device (auto, cuda, mps, cpu).
    /// </summary>
    public string PreferredDevice { get; set; } = "auto";
}
```

### File: `src/SeniorIntern.Core/Models/TrainingPreset.cs`

```csharp
namespace SeniorIntern.Core.Models;

/// <summary>
/// Predefined training preset for common scenarios.
/// </summary>
public sealed class TrainingPreset
{
    /// <summary>
    /// Unique identifier for the preset.
    /// </summary>
    public string Id { get; init; } = Guid.NewGuid().ToString();

    /// <summary>
    /// Display name for the preset.
    /// </summary>
    public string Name { get; init; } = string.Empty;

    /// <summary>
    /// Description of the preset's purpose.
    /// </summary>
    public string Description { get; init; } = string.Empty;

    /// <summary>
    /// Icon identifier for the preset.
    /// </summary>
    public string Icon { get; init; } = "preset";

    /// <summary>
    /// Whether this is a built-in preset.
    /// </summary>
    public bool IsBuiltIn { get; init; }

    /// <summary>
    /// Training configuration for this preset.
    /// </summary>
    public PresetConfiguration Configuration { get; init; } = new();

    /// <summary>
    /// Recommended use cases.
    /// </summary>
    public IReadOnlyList<string> RecommendedFor { get; init; } = Array.Empty<string>();

    /// <summary>
    /// Estimated training time description.
    /// </summary>
    public string EstimatedTime { get; init; } = string.Empty;

    /// <summary>
    /// Estimated VRAM usage description.
    /// </summary>
    public string EstimatedVram { get; init; } = string.Empty;
}

/// <summary>
/// Configuration values for a preset.
/// </summary>
public sealed class PresetConfiguration
{
    public int LoraRank { get; init; } = 16;
    public float LoraAlpha { get; init; } = 32f;
    public float LoraDropout { get; init; } = 0.05f;
    public IReadOnlyList<string> TargetModules { get; init; } = Array.Empty<string>();
    public int Epochs { get; init; } = 3;
    public float LearningRate { get; init; } = 2e-4f;
    public int BatchSize { get; init; } = 4;
    public int WarmupSteps { get; init; } = 100;
    public int GradientAccumulationSteps { get; init; } = 4;
    public int MaxSequenceLength { get; init; } = 2048;
    public bool UseMixedPrecision { get; init; } = true;
    public bool UseGradientCheckpointing { get; init; } = false;
    public string Scheduler { get; init; } = "cosine";
}
```

### File: `src/SeniorIntern.Services/Training/TrainingPresetService.cs`

```csharp
namespace SeniorIntern.Services.Training;

using System.Text.Json;
using SeniorIntern.Core.Models;

/// <summary>
/// Service for managing training presets.
/// </summary>
public sealed class TrainingPresetService
{
    private readonly string _customPresetsPath;
    private readonly List<TrainingPreset> _presets;

    public TrainingPresetService()
    {
        _customPresetsPath = Path.Combine(
            Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
            "SeniorIntern", "presets.json");

        _presets = new List<TrainingPreset>(GetBuiltInPresets());
        LoadCustomPresets();
    }

    /// <summary>
    /// Get all available presets.
    /// </summary>
    public IReadOnlyList<TrainingPreset> GetAllPresets() => _presets;

    /// <summary>
    /// Get built-in presets only.
    /// </summary>
    public IReadOnlyList<TrainingPreset> GetBuiltInPresets() => new List<TrainingPreset>
    {
        new TrainingPreset
        {
            Id = "quick-test",
            Name = "Quick Test",
            Description = "Fast training run for testing configuration. Low quality results.",
            Icon = "rocket",
            IsBuiltIn = true,
            Configuration = new PresetConfiguration
            {
                LoraRank = 8,
                LoraAlpha = 16,
                Epochs = 1,
                LearningRate = 5e-4f,
                BatchSize = 8,
                GradientAccumulationSteps = 1,
                MaxSequenceLength = 512,
                UseMixedPrecision = true
            },
            RecommendedFor = new[] { "Testing", "Quick iteration" },
            EstimatedTime = "~5-10 minutes",
            EstimatedVram = "~4-6 GB"
        },

        new TrainingPreset
        {
            Id = "balanced",
            Name = "Balanced",
            Description = "Good balance between training time and quality. Recommended for most users.",
            Icon = "balance",
            IsBuiltIn = true,
            Configuration = new PresetConfiguration
            {
                LoraRank = 16,
                LoraAlpha = 32,
                LoraDropout = 0.05f,
                TargetModules = new[] { "q_proj", "k_proj", "v_proj", "o_proj" },
                Epochs = 3,
                LearningRate = 2e-4f,
                BatchSize = 4,
                WarmupSteps = 100,
                GradientAccumulationSteps = 4,
                MaxSequenceLength = 2048,
                UseMixedPrecision = true,
                Scheduler = "cosine"
            },
            RecommendedFor = new[] { "General use", "Most code styles" },
            EstimatedTime = "~1-2 hours",
            EstimatedVram = "~8-12 GB"
        },

        new TrainingPreset
        {
            Id = "high-quality",
            Name = "High Quality",
            Description = "Higher rank and more epochs for better quality. Longer training time.",
            Icon = "star",
            IsBuiltIn = true,
            Configuration = new PresetConfiguration
            {
                LoraRank = 32,
                LoraAlpha = 64,
                LoraDropout = 0.1f,
                TargetModules = new[] { "q_proj", "k_proj", "v_proj", "o_proj", "gate_proj", "up_proj", "down_proj" },
                Epochs = 5,
                LearningRate = 1e-4f,
                BatchSize = 2,
                WarmupSteps = 200,
                GradientAccumulationSteps = 8,
                MaxSequenceLength = 2048,
                UseMixedPrecision = true,
                UseGradientCheckpointing = true,
                Scheduler = "cosine"
            },
            RecommendedFor = new[] { "Large codebases", "Complex patterns" },
            EstimatedTime = "~3-5 hours",
            EstimatedVram = "~12-16 GB"
        },

        new TrainingPreset
        {
            Id = "low-memory",
            Name = "Low Memory",
            Description = "Optimized for systems with limited VRAM. Uses gradient checkpointing.",
            Icon = "memory",
            IsBuiltIn = true,
            Configuration = new PresetConfiguration
            {
                LoraRank = 8,
                LoraAlpha = 16,
                TargetModules = new[] { "q_proj", "v_proj" },
                Epochs = 3,
                LearningRate = 2e-4f,
                BatchSize = 1,
                GradientAccumulationSteps = 16,
                MaxSequenceLength = 1024,
                UseMixedPrecision = true,
                UseGradientCheckpointing = true,
                Scheduler = "linear"
            },
            RecommendedFor = new[] { "8GB VRAM GPUs", "Apple Silicon" },
            EstimatedTime = "~2-3 hours",
            EstimatedVram = "~4-6 GB"
        },

        new TrainingPreset
        {
            Id = "cpu-only",
            Name = "CPU Only",
            Description = "For systems without GPU. Very slow but functional.",
            Icon = "cpu",
            IsBuiltIn = true,
            Configuration = new PresetConfiguration
            {
                LoraRank = 4,
                LoraAlpha = 8,
                TargetModules = new[] { "q_proj", "v_proj" },
                Epochs = 2,
                LearningRate = 1e-4f,
                BatchSize = 1,
                GradientAccumulationSteps = 8,
                MaxSequenceLength = 512,
                UseMixedPrecision = false,
                UseGradientCheckpointing = true,
                Scheduler = "constant"
            },
            RecommendedFor = new[] { "No GPU available", "Testing" },
            EstimatedTime = "~8-24 hours",
            EstimatedVram = "N/A (System RAM)"
        }
    };

    /// <summary>
    /// Get a preset by ID.
    /// </summary>
    public TrainingPreset? GetPreset(string id)
    {
        return _presets.FirstOrDefault(p => p.Id == id);
    }

    /// <summary>
    /// Save a custom preset.
    /// </summary>
    public async Task SaveCustomPresetAsync(TrainingPreset preset)
    {
        if (preset.IsBuiltIn)
            throw new InvalidOperationException("Cannot modify built-in presets");

        var existing = _presets.FindIndex(p => p.Id == preset.Id);
        if (existing >= 0)
            _presets[existing] = preset;
        else
            _presets.Add(preset);

        await SaveCustomPresetsAsync();
    }

    /// <summary>
    /// Delete a custom preset.
    /// </summary>
    public async Task DeleteCustomPresetAsync(string id)
    {
        var preset = _presets.FirstOrDefault(p => p.Id == id);
        if (preset == null) return;

        if (preset.IsBuiltIn)
            throw new InvalidOperationException("Cannot delete built-in presets");

        _presets.Remove(preset);
        await SaveCustomPresetsAsync();
    }

    private void LoadCustomPresets()
    {
        if (!File.Exists(_customPresetsPath))
            return;

        try
        {
            var json = File.ReadAllText(_customPresetsPath);
            var customPresets = JsonSerializer.Deserialize<List<TrainingPreset>>(json);

            if (customPresets != null)
            {
                _presets.AddRange(customPresets);
            }
        }
        catch
        {
            // Ignore load errors
        }
    }

    private async Task SaveCustomPresetsAsync()
    {
        var customPresets = _presets.Where(p => !p.IsBuiltIn).ToList();

        var directory = Path.GetDirectoryName(_customPresetsPath)!;
        Directory.CreateDirectory(directory);

        var json = JsonSerializer.Serialize(customPresets, new JsonSerializerOptions
        {
            WriteIndented = true
        });

        await File.WriteAllTextAsync(_customPresetsPath, json);
    }
}
```

### File: `src/SeniorIntern.Desktop/Views/TrainingPresetsView.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
             x:Class="SeniorIntern.Desktop.Views.TrainingPresetsView"
             x:DataType="vm:TrainingLabViewModel">

    <ScrollViewer Padding="24">
        <StackPanel Spacing="24">
            <!-- Header -->
            <StackPanel Spacing="8">
                <TextBlock Text="Training Presets"
                           FontSize="18"
                           FontWeight="SemiBold" />
                <TextBlock Text="Choose a preset to quickly configure training parameters for common scenarios."
                           Foreground="{DynamicResource SecondaryTextColor}" />
            </StackPanel>

            <!-- Preset Cards -->
            <ItemsControl Items="{Binding Presets}">
                <ItemsControl.ItemsPanel>
                    <ItemsPanelTemplate>
                        <WrapPanel Orientation="Horizontal" />
                    </ItemsPanelTemplate>
                </ItemsControl.ItemsPanel>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="vm:TrainingPreset">
                        <Border Background="{DynamicResource SurfaceColor}"
                                CornerRadius="8"
                                Padding="20"
                                Width="280"
                                Margin="0,0,16,16"
                                Cursor="Hand"
                                PointerPressed="OnPresetCardPressed">
                            <StackPanel Spacing="12">
                                <!-- Header -->
                                <Grid ColumnDefinitions="Auto,*,Auto">
                                    <Border Background="{DynamicResource AccentColorLight}"
                                            CornerRadius="8"
                                            Padding="8">
                                        <PathIcon Data="{Binding Icon, Converter={StaticResource PresetIconConverter}}"
                                                  Width="24" Height="24"
                                                  Foreground="{DynamicResource AccentColor}" />
                                    </Border>

                                    <StackPanel Grid.Column="1" Margin="12,0,0,0">
                                        <TextBlock Text="{Binding Name}"
                                                   FontWeight="SemiBold"
                                                   FontSize="15" />
                                        <Border Background="{DynamicResource AccentColorLight}"
                                                CornerRadius="4"
                                                Padding="4,1"
                                                HorizontalAlignment="Left"
                                                IsVisible="{Binding IsBuiltIn}">
                                            <TextBlock Text="Built-in"
                                                       FontSize="10"
                                                       Foreground="{DynamicResource AccentColor}" />
                                        </Border>
                                    </StackPanel>
                                </Grid>

                                <!-- Description -->
                                <TextBlock Text="{Binding Description}"
                                           Foreground="{DynamicResource SecondaryTextColor}"
                                           FontSize="13"
                                           TextWrapping="Wrap"
                                           MaxLines="3" />

                                <!-- Stats -->
                                <Grid ColumnDefinitions="*,*">
                                    <StackPanel Spacing="2">
                                        <TextBlock Text="Est. Time"
                                                   FontSize="11"
                                                   Foreground="{DynamicResource SecondaryTextColor}" />
                                        <TextBlock Text="{Binding EstimatedTime}"
                                                   FontSize="12" />
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Spacing="2">
                                        <TextBlock Text="Est. VRAM"
                                                   FontSize="11"
                                                   Foreground="{DynamicResource SecondaryTextColor}" />
                                        <TextBlock Text="{Binding EstimatedVram}"
                                                   FontSize="12" />
                                    </StackPanel>
                                </Grid>

                                <!-- Key Config -->
                                <Border Background="{DynamicResource CardBackgroundColor}"
                                        CornerRadius="4"
                                        Padding="8">
                                    <StackPanel Orientation="Horizontal" Spacing="16">
                                        <TextBlock FontSize="11">
                                            <Run Text="Rank: " Foreground="{DynamicResource SecondaryTextColor}" />
                                            <Run Text="{Binding Configuration.LoraRank}" />
                                        </TextBlock>
                                        <TextBlock FontSize="11">
                                            <Run Text="Epochs: " Foreground="{DynamicResource SecondaryTextColor}" />
                                            <Run Text="{Binding Configuration.Epochs}" />
                                        </TextBlock>
                                        <TextBlock FontSize="11">
                                            <Run Text="LR: " Foreground="{DynamicResource SecondaryTextColor}" />
                                            <Run Text="{Binding Configuration.LearningRate}" />
                                        </TextBlock>
                                    </StackPanel>
                                </Border>

                                <!-- Use Button -->
                                <Button Content="Use This Preset"
                                        Command="{Binding DataContext.UsePresetCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                        CommandParameter="{Binding}"
                                        HorizontalAlignment="Stretch"
                                        Classes="accent" />
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </StackPanel>
    </ScrollViewer>
</UserControl>
```

---

## v0.8.5j: Notifications & Polish

### Objective
Add notification system and UI polish including animations, transitions, and accessibility improvements.

### File: `src/SeniorIntern.Desktop/Controls/NotificationPanel.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="300"
             x:Class="SeniorIntern.Desktop.Controls.NotificationPanel"
             x:Name="Root">

    <ItemsControl Items="{Binding Notifications, ElementName=Root}"
                  HorizontalAlignment="Right"
                  VerticalAlignment="Top"
                  Margin="0,16,16,0">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Spacing="8" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate DataType="vm:TrainingNotification">
                <Border Background="{Binding Type, Converter={StaticResource NotificationTypeToBackgroundConverter}}"
                        CornerRadius="8"
                        Padding="16"
                        Width="350"
                        BoxShadow="0 4 16 0 #30000000">
                    <Border.Transitions>
                        <Transitions>
                            <DoubleTransition Property="Opacity" Duration="0:0:0.3" />
                            <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.3" />
                        </Transitions>
                    </Border.Transitions>

                    <Grid ColumnDefinitions="Auto,*,Auto">
                        <!-- Icon -->
                        <PathIcon Grid.Column="0"
                                  Data="{Binding Type, Converter={StaticResource NotificationTypeToIconConverter}}"
                                  Width="20" Height="20"
                                  Foreground="{Binding Type, Converter={StaticResource NotificationTypeToForegroundConverter}}"
                                  Margin="0,0,12,0"
                                  VerticalAlignment="Top" />

                        <!-- Content -->
                        <StackPanel Grid.Column="1" Spacing="4">
                            <TextBlock Text="{Binding Title}"
                                       FontWeight="SemiBold"
                                       Foreground="{Binding Type, Converter={StaticResource NotificationTypeToForegroundConverter}}" />
                            <TextBlock Text="{Binding Message}"
                                       TextWrapping="Wrap"
                                       FontSize="13"
                                       Opacity="0.9" />
                        </StackPanel>

                        <!-- Close Button -->
                        <Button Grid.Column="2"
                                Command="{Binding DataContext.DismissNotificationCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                CommandParameter="{Binding}"
                                Classes="icon"
                                Margin="8,0,0,0"
                                VerticalAlignment="Top">
                            <PathIcon Data="{StaticResource CloseIcon}" Width="12" Height="12" />
                        </Button>
                    </Grid>
                </Border>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Controls/NotificationPanel.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using System.Collections.ObjectModel;
using Avalonia;
using Avalonia.Controls;
using SeniorIntern.Desktop.ViewModels;

/// <summary>
/// Panel for displaying toast notifications.
/// </summary>
public partial class NotificationPanel : UserControl
{
    public static readonly StyledProperty<ObservableCollection<TrainingNotification>?> NotificationsProperty =
        AvaloniaProperty.Register<NotificationPanel, ObservableCollection<TrainingNotification>?>(nameof(Notifications));

    public ObservableCollection<TrainingNotification>? Notifications
    {
        get => GetValue(NotificationsProperty);
        set => SetValue(NotificationsProperty, value);
    }

    public NotificationPanel()
    {
        InitializeComponent();
    }
}
```

### File: `src/SeniorIntern.Desktop/Controls/StepIndicator.axaml`

```xml
<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d" d:DesignWidth="400" d:DesignHeight="40"
             x:Class="SeniorIntern.Desktop.Controls.StepIndicator"
             x:Name="Root">

    <ItemsControl Items="{Binding StepItems, ElementName=Root}">
        <ItemsControl.ItemsPanel>
            <ItemsPanelTemplate>
                <StackPanel Orientation="Horizontal" Spacing="0" />
            </ItemsPanelTemplate>
        </ItemsControl.ItemsPanel>
        <ItemsControl.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <!-- Step Circle -->
                    <Border Width="32" Height="32"
                            CornerRadius="16"
                            Background="{Binding Background}"
                            BorderBrush="{Binding BorderBrush}"
                            BorderThickness="2">
                        <TextBlock Text="{Binding Number}"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   FontWeight="SemiBold"
                                   Foreground="{Binding Foreground}" />
                    </Border>

                    <!-- Connector Line -->
                    <Border Width="40"
                            Height="2"
                            Background="{Binding ConnectorColor}"
                            VerticalAlignment="Center"
                            IsVisible="{Binding ShowConnector}" />
                </StackPanel>
            </DataTemplate>
        </ItemsControl.ItemTemplate>
    </ItemsControl>
</UserControl>
```

### File: `src/SeniorIntern.Desktop/Controls/StepIndicator.axaml.cs`

```csharp
namespace SeniorIntern.Desktop.Controls;

using System.Collections.ObjectModel;
using Avalonia;
using Avalonia.Controls;
using Avalonia.Media;

/// <summary>
/// Step indicator for wizard dialogs.
/// </summary>
public partial class StepIndicator : UserControl
{
    public static readonly StyledProperty<int> StepsProperty =
        AvaloniaProperty.Register<StepIndicator, int>(nameof(Steps), 4);

    public static readonly StyledProperty<int> CurrentStepProperty =
        AvaloniaProperty.Register<StepIndicator, int>(nameof(CurrentStep), 1);

    public int Steps
    {
        get => GetValue(StepsProperty);
        set => SetValue(StepsProperty, value);
    }

    public int CurrentStep
    {
        get => GetValue(CurrentStepProperty);
        set => SetValue(CurrentStepProperty, value);
    }

    public ObservableCollection<StepItem> StepItems { get; } = new();

    public StepIndicator()
    {
        InitializeComponent();
        UpdateSteps();
    }

    protected override void OnPropertyChanged(AvaloniaPropertyChangedEventArgs change)
    {
        base.OnPropertyChanged(change);

        if (change.Property == StepsProperty || change.Property == CurrentStepProperty)
        {
            UpdateSteps();
        }
    }

    private void UpdateSteps()
    {
        StepItems.Clear();

        var accentBrush = Application.Current!.FindResource("AccentColor") as IBrush ?? Brushes.DodgerBlue;
        var grayBrush = new SolidColorBrush(Color.FromRgb(128, 128, 128));
        var whiteBrush = Brushes.White;
        var transparentBrush = Brushes.Transparent;

        for (int i = 1; i <= Steps; i++)
        {
            var isCompleted = i < CurrentStep;
            var isCurrent = i == CurrentStep;
            var isPending = i > CurrentStep;

            StepItems.Add(new StepItem
            {
                Number = i.ToString(),
                Background = isCompleted || isCurrent ? accentBrush : transparentBrush,
                BorderBrush = isCompleted || isCurrent ? accentBrush : grayBrush,
                Foreground = isCompleted || isCurrent ? whiteBrush : grayBrush,
                ConnectorColor = isCompleted ? accentBrush : grayBrush,
                ShowConnector = i < Steps
            });
        }
    }
}

/// <summary>
/// Step item for the indicator.
/// </summary>
public sealed class StepItem
{
    public string Number { get; init; } = string.Empty;
    public IBrush Background { get; init; } = Brushes.Transparent;
    public IBrush BorderBrush { get; init; } = Brushes.Gray;
    public IBrush Foreground { get; init; } = Brushes.Gray;
    public IBrush ConnectorColor { get; init; } = Brushes.Gray;
    public bool ShowConnector { get; init; }
}
```

### File: `src/SeniorIntern.Desktop/Themes/TrainingLabStyles.axaml`

```xml
<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">

    <!-- Button Styles -->
    <Style Selector="Button.icon">
        <Setter Property="Background" Value="Transparent" />
        <Setter Property="Padding" Value="8" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>
    <Style Selector="Button.icon:pointerover">
        <Setter Property="Background" Value="{DynamicResource SurfaceColor}" />
    </Style>

    <Style Selector="Button.icon.danger:pointerover">
        <Setter Property="Background" Value="{DynamicResource ErrorBackgroundColor}" />
    </Style>
    <Style Selector="Button.icon.danger:pointerover PathIcon">
        <Setter Property="Foreground" Value="{DynamicResource ErrorColor}" />
    </Style>

    <Style Selector="Button.accent">
        <Setter Property="Background" Value="{DynamicResource AccentColor}" />
        <Setter Property="Foreground" Value="White" />
    </Style>
    <Style Selector="Button.accent:pointerover">
        <Setter Property="Background" Value="{DynamicResource AccentColorDark}" />
    </Style>

    <Style Selector="Button.small">
        <Setter Property="Padding" Value="8,4" />
        <Setter Property="FontSize" Value="12" />
    </Style>

    <!-- Card Hover Effect -->
    <Style Selector="Border.card">
        <Setter Property="Transitions">
            <Transitions>
                <BoxShadowsTransition Property="BoxShadow" Duration="0:0:0.2" />
                <TransformOperationsTransition Property="RenderTransform" Duration="0:0:0.2" />
            </Transitions>
        </Setter>
    </Style>
    <Style Selector="Border.card:pointerover">
        <Setter Property="BoxShadow" Value="0 4 16 0 #20000000" />
        <Setter Property="RenderTransform" Value="translateY(-2px)" />
    </Style>

    <!-- Progress Bar -->
    <Style Selector="ProgressBar">
        <Setter Property="Background" Value="{DynamicResource SurfaceColor}" />
        <Setter Property="Foreground" Value="{DynamicResource AccentColor}" />
    </Style>

    <!-- Tooltip -->
    <Style Selector="ToolTip">
        <Setter Property="Background" Value="{DynamicResource CardBackgroundColor}" />
        <Setter Property="BorderBrush" Value="{DynamicResource BorderColor}" />
        <Setter Property="Padding" Value="8" />
        <Setter Property="CornerRadius" Value="4" />
    </Style>

    <!-- Animations -->
    <Style Selector="Border.fadeIn">
        <Style.Animations>
            <Animation Duration="0:0:0.3" FillMode="Forward">
                <KeyFrame Cue="0%">
                    <Setter Property="Opacity" Value="0" />
                    <Setter Property="TranslateTransform.Y" Value="10" />
                </KeyFrame>
                <KeyFrame Cue="100%">
                    <Setter Property="Opacity" Value="1" />
                    <Setter Property="TranslateTransform.Y" Value="0" />
                </KeyFrame>
            </Animation>
        </Style.Animations>
    </Style>
</Styles>
```

---

## v0.8.5k: Unit Testing & Integration

### Objective
Create comprehensive unit tests for all Training UI components.

### File: `tests/SeniorIntern.Tests/ViewModels/TrainingWizardViewModelTests.cs`

```csharp
namespace SeniorIntern.Tests.ViewModels;

using Moq;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Training.Models;
using SeniorIntern.Desktop.ViewModels;
using Xunit;

public class TrainingWizardViewModelTests
{
    private readonly Mock<IDatasetService> _datasetService;
    private readonly Mock<IHardwareDetectionService> _hardwareService;
    private readonly Mock<ITrainingService> _trainingService;

    public TrainingWizardViewModelTests()
    {
        _datasetService = new Mock<IDatasetService>();
        _hardwareService = new Mock<IHardwareDetectionService>();
        _trainingService = new Mock<ITrainingService>();
    }

    [Fact]
    public void InitialState_IsStep1()
    {
        var vm = CreateViewModel();

        Assert.Equal(1, vm.CurrentStep);
        Assert.False(vm.CanGoBack);
        Assert.True(vm.IsLastStep == false);
    }

    [Fact]
    public void GoNext_WithValidData_AdvancesStep()
    {
        var vm = CreateViewModel();
        vm.DatasetPath = "/test/path";
        vm.DatasetStats = new DatasetStatistics { TrainExamples = 100 };

        vm.GoNextCommand.Execute(null);

        Assert.Equal(2, vm.CurrentStep);
        Assert.True(vm.CanGoBack);
    }

    [Fact]
    public void GoBack_FromStep2_ReturnsToStep1()
    {
        var vm = CreateViewModel();
        vm.DatasetPath = "/test/path";
        vm.DatasetStats = new DatasetStatistics { TrainExamples = 100 };
        vm.GoNextCommand.Execute(null);

        vm.GoBackCommand.Execute(null);

        Assert.Equal(1, vm.CurrentStep);
        Assert.False(vm.CanGoBack);
    }

    [Fact]
    public void ValidateCurrentStep_Step1_RequiresDataset()
    {
        var vm = CreateViewModel();

        Assert.False(vm.CanGoNext);

        vm.DatasetPath = "/test/path";
        vm.DatasetStats = new DatasetStatistics { TrainExamples = 100 };

        Assert.True(vm.CanGoNext);
    }

    [Fact]
    public void ValidateCurrentStep_Step2_RequiresAdapterName()
    {
        var vm = CreateViewModel();
        SetupForStep2(vm);

        Assert.False(vm.CanGoNext);

        vm.AdapterName = "test-adapter";

        Assert.True(vm.CanGoNext);
    }

    [Fact]
    public void GetTargetModules_ReturnsSelectedModules()
    {
        var vm = CreateViewModel();
        vm.TargetQProj = true;
        vm.TargetKProj = true;
        vm.TargetVProj = false;

        var modules = vm.GetTargetModulesPublic();

        Assert.Contains("q_proj", modules);
        Assert.Contains("k_proj", modules);
        Assert.DoesNotContain("v_proj", modules);
    }

    [Fact]
    public void CreateTrainingJob_IncludesAllConfiguration()
    {
        var vm = CreateViewModel();
        SetupForStep4(vm);

        var job = vm.CreateTrainingJobPublic();

        Assert.Equal("test-adapter", job.Name);
        Assert.Equal("/test/path", job.DatasetPath);
        Assert.Equal(16, job.Configuration.LoraRank);
        Assert.Equal(3, job.Configuration.Epochs);
    }

    [Fact]
    public void Cancel_RaisesCancelledEvent()
    {
        var vm = CreateViewModel();
        var eventRaised = false;
        vm.WizardCancelled += (_, _) => eventRaised = true;

        vm.CancelCommand.Execute(null);

        Assert.True(eventRaised);
    }

    [Fact]
    public void StartTraining_RaisesCompletedEvent()
    {
        var vm = CreateViewModel();
        SetupForStep4(vm);
        TrainingWizardCompletedEventArgs? args = null;
        vm.WizardCompleted += (_, e) => args = e;

        vm.StartTrainingCommand.Execute(null);

        Assert.NotNull(args);
        Assert.True(args.StartTraining);
        Assert.NotNull(args.Job);
    }

    private TrainingWizardViewModel CreateViewModel()
    {
        return new TrainingWizardViewModel(
            _datasetService.Object,
            _hardwareService.Object,
            _trainingService.Object);
    }

    private void SetupForStep2(TrainingWizardViewModel vm)
    {
        vm.DatasetPath = "/test/path";
        vm.DatasetStats = new DatasetStatistics { TrainExamples = 100 };
        vm.GoNextCommand.Execute(null);
    }

    private void SetupForStep4(TrainingWizardViewModel vm)
    {
        vm.DatasetPath = "/test/path";
        vm.DatasetStats = new DatasetStatistics { TrainExamples = 100 };
        vm.AdapterName = "test-adapter";
        vm.LoraRank = 16;
        vm.Epochs = 3;
        vm.TargetQProj = true;
        vm.TargetVProj = true;

        _hardwareService.Setup(h => h.DetectHardwareAsync())
            .ReturnsAsync(new TrainingHardwareInfo { HasCuda = true });

        // Navigate to step 4
        vm.GoNextCommand.Execute(null); // Step 2
        vm.GoNextCommand.Execute(null); // Step 3
        vm.GoNextCommand.Execute(null); // Step 4
    }
}
```

### File: `tests/SeniorIntern.Tests/ViewModels/TrainingLabViewModelTests.cs`

```csharp
namespace SeniorIntern.Tests.ViewModels;

using Microsoft.Extensions.Logging.Abstractions;
using Moq;
using SeniorIntern.Core.Interfaces;
using SeniorIntern.Core.Training.Models;
using SeniorIntern.Desktop.ViewModels;
using Xunit;

public class TrainingLabViewModelTests
{
    private readonly Mock<ITrainingService> _trainingService;
    private readonly Mock<IDatasetService> _datasetService;
    private readonly Mock<IHardwareDetectionService> _hardwareService;
    private readonly Mock<IHardwareMonitorService> _monitorService;

    public TrainingLabViewModelTests()
    {
        _trainingService = new Mock<ITrainingService>();
        _datasetService = new Mock<IDatasetService>();
        _hardwareService = new Mock<IHardwareDetectionService>();
        _monitorService = new Mock<IHardwareMonitorService>();
    }

    [Fact]
    public void InitialState_NotTraining()
    {
        var vm = CreateViewModel();

        Assert.False(vm.IsTraining);
        Assert.False(vm.IsWizardOpen);
        Assert.Empty(vm.Adapters);
    }

    [Fact]
    public void StartWizard_OpensWizard()
    {
        var vm = CreateViewModel();

        vm.StartWizardCommand.Execute(null);

        Assert.True(vm.IsWizardOpen);
        Assert.NotNull(vm.WizardViewModel);
    }

    [Fact]
    public async Task LoadAdapters_PopulatesCollection()
    {
        var adapters = new List<LoraAdapterInfo>
        {
            new() { Id = "1", Name = "Adapter 1" },
            new() { Id = "2", Name = "Adapter 2" }
        };

        _trainingService.Setup(s => s.ListAdaptersAsync())
            .ReturnsAsync(adapters);

        var vm = CreateViewModel();
        await vm.LoadAdaptersCommand.ExecuteAsync(null);

        Assert.Equal(2, vm.Adapters.Count);
    }

    [Fact]
    public async Task LoadAdapter_SetsActiveAdapter()
    {
        var adapter = new LoraAdapterInfo { Id = "1", Name = "Test Adapter" };
        _trainingService.Setup(s => s.LoadAdapterAsync(It.IsAny<string>()))
            .Returns(Task.CompletedTask);

        var vm = CreateViewModel();
        await vm.LoadAdapterCommand.ExecuteAsync(adapter);

        Assert.Equal(adapter, vm.ActiveAdapter);
    }

    [Fact]
    public async Task DeleteAdapter_RemovesFromCollection()
    {
        var adapter = new LoraAdapterInfo { Id = "1", Name = "Test Adapter" };
        var vm = CreateViewModel();
        vm.Adapters.Add(adapter);

        _trainingService.Setup(s => s.DeleteAdapterAsync(It.IsAny<string>()))
            .Returns(Task.CompletedTask);

        // Note: In real tests, we'd mock the confirmation dialog
        await vm.DeleteAdapterCommand.ExecuteAsync(adapter);

        // Assert would depend on dialog mock
    }

    [Fact]
    public void AddNotification_AddsToCollection()
    {
        var vm = CreateViewModel();

        vm.AddNotificationPublic(new TrainingNotification
        {
            Title = "Test",
            Message = "Test message",
            Type = NotificationType.Info
        });

        Assert.Single(vm.Notifications);
    }

    [Fact]
    public void DismissNotification_RemovesFromCollection()
    {
        var vm = CreateViewModel();
        var notification = new TrainingNotification
        {
            Title = "Test",
            Message = "Test message"
        };
        vm.Notifications.Add(notification);

        vm.DismissNotificationCommand.Execute(notification);

        Assert.Empty(vm.Notifications);
    }

    private TrainingLabViewModel CreateViewModel()
    {
        return new TrainingLabViewModel(
            NullLogger<TrainingLabViewModel>.Instance,
            _trainingService.Object,
            _datasetService.Object,
            _hardwareService.Object,
            _monitorService.Object);
    }
}
```

### File: `tests/SeniorIntern.Tests/Services/TrainingPresetServiceTests.cs`

```csharp
namespace SeniorIntern.Tests.Services;

using SeniorIntern.Core.Models;
using SeniorIntern.Services.Training;
using Xunit;

public class TrainingPresetServiceTests
{
    [Fact]
    public void GetBuiltInPresets_ReturnsPresets()
    {
        var service = new TrainingPresetService();

        var presets = service.GetBuiltInPresets();

        Assert.NotEmpty(presets);
        Assert.All(presets, p => Assert.True(p.IsBuiltIn));
    }

    [Fact]
    public void GetPreset_ByValidId_ReturnsPreset()
    {
        var service = new TrainingPresetService();

        var preset = service.GetPreset("balanced");

        Assert.NotNull(preset);
        Assert.Equal("Balanced", preset.Name);
    }

    [Fact]
    public void GetPreset_ByInvalidId_ReturnsNull()
    {
        var service = new TrainingPresetService();

        var preset = service.GetPreset("nonexistent");

        Assert.Null(preset);
    }

    [Fact]
    public async Task SaveCustomPreset_AddsToCollection()
    {
        var service = new TrainingPresetService();
        var customPreset = new TrainingPreset
        {
            Id = "custom-test",
            Name = "Custom Test",
            IsBuiltIn = false
        };

        await service.SaveCustomPresetAsync(customPreset);
        var retrieved = service.GetPreset("custom-test");

        Assert.NotNull(retrieved);
        Assert.Equal("Custom Test", retrieved.Name);

        // Cleanup
        await service.DeleteCustomPresetAsync("custom-test");
    }

    [Fact]
    public async Task SaveBuiltInPreset_ThrowsException()
    {
        var service = new TrainingPresetService();
        var builtIn = service.GetPreset("balanced")!;

        await Assert.ThrowsAsync<InvalidOperationException>(
            () => service.SaveCustomPresetAsync(builtIn));
    }

    [Fact]
    public async Task DeleteBuiltInPreset_ThrowsException()
    {
        var service = new TrainingPresetService();

        await Assert.ThrowsAsync<InvalidOperationException>(
            () => service.DeleteCustomPresetAsync("balanced"));
    }

    [Fact]
    public void BalancedPreset_HasReasonableDefaults()
    {
        var service = new TrainingPresetService();
        var preset = service.GetPreset("balanced")!;

        Assert.Equal(16, preset.Configuration.LoraRank);
        Assert.Equal(32f, preset.Configuration.LoraAlpha);
        Assert.Equal(3, preset.Configuration.Epochs);
        Assert.True(preset.Configuration.UseMixedPrecision);
    }

    [Fact]
    public void LowMemoryPreset_UsesGradientCheckpointing()
    {
        var service = new TrainingPresetService();
        var preset = service.GetPreset("low-memory")!;

        Assert.True(preset.Configuration.UseGradientCheckpointing);
        Assert.Equal(1, preset.Configuration.BatchSize);
    }
}
```

---

## Dependency Injection Registration

### File: `src/SeniorIntern.Desktop/ServiceCollectionExtensions.cs` (Addition)

```csharp
/// <summary>
/// Register Training UI services.
/// </summary>
public static IServiceCollection AddTrainingUI(this IServiceCollection services)
{
    // ViewModels
    services.AddTransient<TrainingLabViewModel>();
    services.AddTransient<TrainingWizardViewModel>();
    services.AddTransient<TrainingProgressViewModel>();

    // Services
    services.AddSingleton<TrainingPresetService>();

    // Settings
    services.AddSingleton<TrainingSettings>(sp =>
    {
        var settingsPath = Path.Combine(
            Environment.GetFolderPath(Environment.SpecialFolder.ApplicationData),
            "SeniorIntern", "training-settings.json");

        if (File.Exists(settingsPath))
        {
            try
            {
                var json = File.ReadAllText(settingsPath);
                return JsonSerializer.Deserialize<TrainingSettings>(json) ?? new TrainingSettings();
            }
            catch
            {
                return new TrainingSettings();
            }
        }

        return new TrainingSettings();
    });

    return services;
}
```

---

## Integration Points

### MainWindow Navigation Update

```xml
<!-- Add to MainWindow TabControl -->
<TabItem Header="Training Lab">
    <views:TrainingLabView />
</TabItem>
```

### Icon Resources

```xml
<!-- Add to App.axaml Resources -->
<StreamGeometry x:Key="TrainingIcon">M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5</StreamGeometry>
<StreamGeometry x:Key="AddIcon">M12 5v14M5 12h14</StreamGeometry>
<StreamGeometry x:Key="PlayIcon">M8 5v14l11-7z</StreamGeometry>
<StreamGeometry x:Key="PauseIcon">M6 4h4v16H6zM14 4h4v16h-4z</StreamGeometry>
<StreamGeometry x:Key="StopIcon">M6 6h12v12H6z</StreamGeometry>
<StreamGeometry x:Key="GpuIcon">M4 4h16v16H4z</StreamGeometry>
<StreamGeometry x:Key="CpuIcon">M9 3H15V5H9zM9 19H15V21H9z</StreamGeometry>
<StreamGeometry x:Key="MemoryIcon">M2 4h20v16H2zM6 8h12v8H6z</StreamGeometry>
<StreamGeometry x:Key="ChartIcon">M3 3v18h18M7 16l4-4 4 4 5-5</StreamGeometry>
<StreamGeometry x:Key="FolderIcon">M3 4h5l2 2h10v12H3z</StreamGeometry>
<StreamGeometry x:Key="TuneIcon">M3 17v2h6v-2H3zM3 5v2h10V5H3z</StreamGeometry>
```

---

## Summary

v0.8.5 Training UI & Polish provides:

1. **Training Wizard**
   - 4-step guided process
   - Dataset analysis and preview
   - LoRA and training configuration
   - Hardware detection and recommendations
   - Pre-flight checks and review

2. **Training Progress View**
   - Real-time loss and learning rate charts
   - Hardware utilization gauges
   - Training log viewer
   - Pause/Resume/Stop controls

3. **Custom Controls**
   - MetricsChart (LiveCharts integration)
   - HardwareGauge (linear and circular)
   - LogViewer (virtualized, filterable)
   - StepIndicator (wizard navigation)
   - NotificationPanel (toast notifications)

4. **Adapter Manager**
   - List view with search
   - Load/Unload/Export/Delete actions
   - Adapter detail view
   - Import from file

5. **Training Presets**
   - Built-in presets (Quick Test, Balanced, High Quality, Low Memory, CPU Only)
   - Custom preset support
   - Preset configuration preview

6. **Polish & UX**
   - Animations and transitions
   - Notification system
   - Consistent styling
   - Keyboard accessibility

**Total: 47 files to create, 1 file to modify**
