<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:SeniorIntern.Desktop.ViewModels"
             x:Class="SeniorIntern.Desktop.Views.ChatMessageControl"
             x:DataType="vm:ChatMessageViewModel">

    <UserControl.Styles>
        <Style Selector="Border.user-message">
            <Setter Property="Background" Value="{DynamicResource UserMessageBackground}" />
            <Setter Property="HorizontalAlignment" Value="Right" />
        </Style>
        <Style Selector="Border.assistant-message">
            <Setter Property="Background" Value="{DynamicResource AssistantMessageBackground}" />
            <Setter Property="HorizontalAlignment" Value="Left" />
        </Style>
    </UserControl.Styles>

    <Border x:Name="MessageBorder"
            Classes.user-message="{Binding IsUser}"
            Classes.assistant-message="{Binding IsAssistant}"
            CornerRadius="12"
            Padding="16"
            MaxWidth="800">

        <StackPanel Spacing="8">
            <!-- Role Label -->
            <TextBlock Text="{Binding RoleLabel}"
                       FontWeight="SemiBold"
                       FontSize="12"
                       Foreground="{DynamicResource TextMuted}" />

            <!-- Content -->
            <SelectableTextBlock Text="{Binding Content}"
                                 TextWrapping="Wrap"
                                 Foreground="{DynamicResource TextPrimary}" />

            <!-- Loading Indicator -->
            <StackPanel Orientation="Horizontal"
                        IsVisible="{Binding IsStreaming}"
                        Spacing="8">
                <ProgressBar IsIndeterminate="True"
                             Width="50"
                             Height="4" />
                <TextBlock Text="Generating..."
                           FontStyle="Italic"
                           Foreground="{DynamicResource TextMuted}"
                           FontSize="12" />
            </StackPanel>
        </StackPanel>
    </Border>

</UserControl>
