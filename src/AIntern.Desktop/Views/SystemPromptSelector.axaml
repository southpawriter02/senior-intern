<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AIntern.Desktop.ViewModels"
             x:Class="AIntern.Desktop.Views.SystemPromptSelector"
             x:DataType="vm:SystemPromptSelectorViewModel">

    <Border Background="{DynamicResource SidebarBackground}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="0,0,0,1"
            Padding="16,8">
        <Grid ColumnDefinitions="Auto, *, Auto">
            <!-- Label -->
            <TextBlock Text="Using:"
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource TextMuted}"
                       Margin="0,0,8,0" />

            <!-- Prompt Selector ComboBox -->
            <ComboBox Grid.Column="1"
                      ItemsSource="{Binding AvailablePrompts}"
                      SelectedItem="{Binding SelectedPrompt}"
                      HorizontalAlignment="Stretch"
                      Background="{DynamicResource InputBackground}">
                <ComboBox.ItemTemplate>
                    <DataTemplate DataType="vm:SystemPromptViewModel">
                        <Grid ColumnDefinitions="Auto, *, Auto">
                            <!-- Default Star -->
                            <TextBlock Text="*"
                                       IsVisible="{Binding IsDefault}"
                                       Foreground="{DynamicResource AccentBrush}"
                                       FontWeight="Bold"
                                       VerticalAlignment="Center"
                                       Margin="0,0,6,0" />

                            <!-- Name -->
                            <TextBlock Grid.Column="1"
                                       Text="{Binding Name}"
                                       TextTrimming="CharacterEllipsis"
                                       VerticalAlignment="Center"
                                       Foreground="{DynamicResource TextPrimary}" />

                            <!-- Category Badge -->
                            <Border Grid.Column="2"
                                    Background="{DynamicResource ControlBackground}"
                                    CornerRadius="2"
                                    Padding="4,1"
                                    Margin="8,0,0,0"
                                    IsVisible="{Binding Category, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                                <TextBlock Text="{Binding Category}"
                                           FontSize="10"
                                           Foreground="{DynamicResource TextMuted}" />
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <!-- Edit Button -->
            <Button Grid.Column="2"
                    Command="{Binding OpenEditorCommand}"
                    ToolTip.Tip="Edit System Prompts"
                    Theme="{StaticResource SubtleButton}"
                    Margin="8,0,0,0">
                <PathIcon Data="M3,17.25V21h3.75L17.81,9.94l-3.75-3.75L3,17.25zM20.71,7.04c0.39-0.39,0.39-1.02,0-1.41l-2.34-2.34c-0.39-0.39-1.02-0.39-1.41,0l-1.83,1.83l3.75,3.75L20.71,7.04z"
                          Width="14" Height="14"
                          Foreground="{DynamicResource TextPrimary}" />
            </Button>
        </Grid>
    </Border>

</UserControl>
